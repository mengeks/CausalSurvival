Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 45
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 45: 618
Loaded dataset 45 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_45_n_500.rds 
Time to load dataset: 0.100876331329346 seconds
Loaded dataset 145 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_145_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.31740185
X.2   .         
X.3  -0.17579320
X.4   0.06546043
X.5   0.14067099
X.6   0.01892337
X.7   .         
X.8   .         
X.9   .         
X.10  0.35156660
[1] "head(CATE_est)"
               1
[1,]  0.85594310
[2,]  0.59648272
[3,]  0.03854726
[4,]  0.38744401
[5,] -0.68283064
[6,]  0.91877722
[1] "head(CATE_true)"
[1]  1.737377  1.959255  0.495900  1.138660 -1.616620  2.208897
[1] "config_name: T_lasso_linear-only. MSE: 0.968815071182825. time_taken: 18.1086852550507"
[1] "CATE_spec: correctly-specified"
[1] 0.8353868
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   .          
X.2   .          
X.3  -0.114633988
X.4   .          
X.5   0.082628613
X.6   0.006443758
X.7   .          
X.8   .          
X.9   .          
X.10  .          
      0.391341222
      0.406801169
[1] "beta_CATE: "
[1] 0.3913412 0.4068012
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.835386835848917; time_taken: 12.8899416923523"
[1] "CATE_spec: linear"
[1] 0.9468821
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.25171209
X.2          .         
X.3          .         
X.4          .         
X.5          0.10094053
X.6          0.02428572
X.7          .         
X.8          .         
X.9          .         
X.10         0.35281419
[1] "beta_CATE: "
 [1] 0.00000000 0.25171209 0.00000000 0.00000000 0.00000000 0.10094053
 [7] 0.02428572 0.00000000 0.00000000 0.00000000 0.35281419
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.946882059670403; time_taken: 15.5863516330719"
[1] "CATE_spec: flexible"
[1] 0.9616253
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     .        
X.1  0.2468743
X.2  .        
X.3  .        
X.4  .        
X.5  0.1006079
X.6  0.0225777
X.7  .        
X.8  .        
X.9  .        
X.10 0.3496756
[1] "beta_CATE: "
 [1] 0.0000000 0.2468743 0.0000000 0.0000000 0.0000000 0.1006079 0.0225777
 [8] 0.0000000 0.0000000 0.0000000 0.3496756
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.961625268780743; time_taken: 15.117639541626"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.37701597
X.2           .         
X.3           .         
X.4           .         
X.5           0.07830665
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.52313463
X.1_spline1   .         
X.1_spline2   0.01050848
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   0.21561763
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.84767166
X.6_spline3   0.04071508
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.10536006
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.34364734
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.00379879
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
               1
[1,]  0.56841499
[2,]  0.55967969
[3,] -0.03943561
[4,]  0.19715295
[5,] -1.54060711
[6,]  0.38178049
[1] "head(CATE_true)"
[1]  1.737377  1.959255  0.495900  1.138660 -1.616620  2.208897
[1] "config_name: T_lasso_mild-complex. MSE: 0.903676100851221. time_taken: 119.096132993698"
[1] "CATE_spec: correctly-specified"
[1] 0.6009082
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3          -0.007667236
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2  -0.046273895
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.526896166
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   0.438028955
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3 -0.497838043
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.009061341
              0.015285817
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.217940936
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.020390608
              .          
              .          
              0.022925621
              .          
              .          
              .          
              .          
              .          
              0.016636964
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.015261869
              .          
              0.400461774
              0.601162529
[1] "beta_CATE: "
[1] 0.4004618 0.6011625
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.600908155853778; time_taken: 55.6924664974213"
[1] "CATE_spec: linear"
[1] 0.5812852
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3          -0.035103238
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2  -0.020108910
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.239272638
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   0.361558965
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3 -0.303863487
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50          -0.024903429
V51           0.020617104
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59          -0.193707949
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           0.007199870
V69           .          
V70           .          
V71           0.007009348
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           0.026666133
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94          -0.007617005
V95           .          
train_data$W  .          
X.1           0.359117026
X.2           .          
X.3           .          
X.4           .          
X.5           0.108072667
X.6           0.031873338
X.7           .          
X.8           .          
X.9           .          
X.10          0.519058242
[1] "beta_CATE: "
 [1] 0.00000000 0.35911703 0.00000000 0.00000000 0.00000000 0.10807267
 [7] 0.03187334 0.00000000 0.00000000 0.00000000 0.51905824
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.581285197840985; time_taken: 58.4424991607666"
[1] "CATE_spec: flexible"
[1] 0.6675659
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.015396407
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.001737712
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.398429396
X.2           .          
X.3           .          
X.4           .          
X.5           0.091671867
X.6           0.068766100
X.7           .          
X.8           .          
X.9           .          
X.10          0.534431262
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.101798112
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.346081100
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.009791302
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.398429396  0.000000000  0.000000000  0.000000000
 [6]  0.091671867  0.068766100  0.000000000  0.000000000  0.000000000
[11]  0.534431262  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[51] -0.101798112  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000 -0.346081100
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.009791302  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.667565873553455; time_taken: 97.8861362934113"
Time to run lasso model: 395.124821424484 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.9688151

$`S_lasso_correctly-specified_linear-only`
[1] 0.8353868

$`S_lasso_linear_linear-only`
[1] 0.9468821

$`S_lasso_flexible_linear-only`
[1] 0.9616253

$`T_lasso_mild-complex`
[1] 0.9036761

$`S_lasso_correctly-specified_mild-complex`
[1] 0.6009082

$`S_lasso_linear_mild-complex`
[1] 0.5812852

$`S_lasso_flexible_mild-complex`
[1] 0.6675659

Results for iteration 45 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_45-seed_618.csv
There were 50 or more warnings (use warnings() to see the first 50)
