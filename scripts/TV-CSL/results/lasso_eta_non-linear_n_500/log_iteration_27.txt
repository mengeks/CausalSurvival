Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 27
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 27: 420
Loaded dataset 27 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_27_n_500.rds 
Time to load dataset: 0.0423812866210938 seconds
Loaded dataset 127 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_127_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  -0.0171338
X.2   .        
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7  -0.1920604
X.8   .        
X.9   .        
X.10  .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.31225860
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.05045381
X.8  .         
X.9  .         
X.10 0.16435803
[1] "head(CATE_est)"
                1
[1,] -0.608267456
[2,] -0.075451313
[3,]  0.817802785
[4,] -0.099663349
[5,] -0.001940619
[6,] -0.474775617
[1] "head(CATE_true)"
[1] -2.25637589 -0.25707620  1.47585564 -1.05666776 -0.03042319 -1.66164873
[1] "config_name: T_lasso_linear-only. MSE: 0.903852082271589. time_taken: 18.9122309684753"
[1] "CATE_spec: correctly-specified"
[1] 0.6698525
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.04617145
X.2   .         
X.3  -0.05012255
X.4   .         
X.5  -0.05583849
X.6  -0.09061544
X.7   .         
X.8   .         
X.9  -0.04037242
X.10  .         
      0.53968891
      0.36986611
[1] "beta_CATE: "
[1] 0.5396889 0.3698661
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.669852533363985; time_taken: 13.3810486793518"
[1] "CATE_spec: linear"
[1] 0.7510424
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3          -0.02407155
X.4           .         
X.5          -0.04115007
X.6          -0.16994149
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W -0.04494543
X.1           0.43040590
X.2           0.01555776
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.20019134
X.8           .         
X.9           .         
X.10          0.21383323
[1] "beta_CATE: "
 [1] -0.04494543  0.43040590  0.01555776  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.20019134  0.00000000  0.00000000  0.21383323
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.751042414271345; time_taken: 14.3909180164337"
[1] "CATE_spec: flexible"
[1] 0.7510424
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   .         
X.3  -0.02407155
X.4   .         
X.5  -0.04115007
X.6  -0.16994149
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.04494543
X.1   0.43040590
X.2   0.01555776
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   0.20019134
X.8   .         
X.9   .         
X.10  0.21383323
[1] "beta_CATE: "
 [1] -0.04494543  0.43040590  0.01555776  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.20019134  0.00000000  0.00000000  0.21383323
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.751042414271345; time_taken: 14.7453334331512"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.17127367
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3 -0.51805770
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.06494120
              .         
              .         
              .         
              .         
              0.06177214
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.43350385
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.13033833
X.8           .         
X.9           .         
X.10          0.11794885
X.1_spline1  -0.26034428
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   0.52677094
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   0.04432096
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   0.71992832
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   1.67447702
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  1.46064725
              .         
              .         
              .         
              .         
             -0.05051879
             -0.05283229
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.29265053
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.01873271
              .         
              .         
              .         
             -0.02265438
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02466623
             -0.02841850
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02373861
             -0.07531110
              .         
[1] "head(CATE_est)"
              1
[1,] -1.0279685
[2,]  0.5424272
[3,]  1.2578045
[4,]  0.4550588
[5,]  0.5492218
[6,] -0.4045450
[1] "head(CATE_true)"
[1] -2.25637589 -0.25707620  1.47585564 -1.05666776 -0.03042319 -1.66164873
[1] "config_name: T_lasso_mild-complex. MSE: 0.711582894765382. time_taken: 101.923145532608"
[1] "CATE_spec: correctly-specified"
[1] 0.228549
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5          -0.032234378
X.6          -0.097896948
X.7           .          
X.8           .          
X.9          -0.117253888
X.10         -0.030929567
X.1_spline1  -0.643188433
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   0.008958411
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.113853588
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.731850698
X.5_spline3  -0.473510339
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3  -0.165300021
X.7_spline1   .          
X.7_spline2  -0.288973675
X.7_spline3   .          
X.8_spline1   0.314292980
X.8_spline2   .          
X.8_spline3  -0.021657107
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3  -0.058455311
X.10_spline1  .          
X.10_spline2  1.877827569
X.10_spline3  .          
              .          
              0.010400472
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.168986178
              .          
              .          
              .          
              .          
              .          
              .          
             -0.024115244
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.012887190
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.028938636
              .          
              0.705759509
              0.651660522
[1] "beta_CATE: "
[1] 0.7057595 0.6516605
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.228548956227671; time_taken: 55.1198003292084"
[1] "CATE_spec: linear"
[1] 0.1368903
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5          -0.008389089
X.6          -0.194832307
X.7           .          
X.8           .          
X.9          -0.125216762
X.10          .          
X.1_spline1  -0.601553209
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3  -0.214324935
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.982441538
X.5_spline3  -0.651698033
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3  -0.217186172
X.7_spline1   .          
X.7_spline2  -0.119701467
X.7_spline3   .          
X.8_spline1   0.133540263
X.8_spline2  -0.001422363
X.8_spline3  -0.770479739
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.011416273
X.10_spline2  1.506396820
X.10_spline3  .          
V41           0.006270381
V42           0.010717117
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59          -0.103698004
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66          -0.112354855
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84          -0.022678876
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.628406269
X.2           0.142479915
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.298180553
X.8           0.191296558
X.9           .          
X.10          0.445668874
[1] "beta_CATE: "
 [1] 0.0000000 0.6284063 0.1424799 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.2981806 0.1912966 0.0000000 0.4456689
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.136890305489953; time_taken: 66.5187978744507"
[1] "CATE_spec: flexible"
[1] 0.65483
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6          -1.358585e-01
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1  -2.216727e-01
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  1.146476e+00
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              1.303468e-02
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -2.183247e-02
              .           
              .           
X.1           5.336886e-01
X.2           3.189900e-02
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           1.897923e-01
X.8           2.265293e-02
X.9           .           
X.10          3.443991e-01
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   1.904193e-01
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   5.498353e-03
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   2.914403e-01
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  6.342723e-01
              .           
              3.769397e-02
              .           
              .           
             -4.126108e-02
             -1.717659e-05
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -3.382487e-01
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -3.343625e-03
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -9.579894e-02
              .           
              .           
             -9.130365e-02
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1]  0.000000e+00  5.336886e-01  3.189900e-02  0.000000e+00  0.000000e+00
 [6]  0.000000e+00  0.000000e+00  1.897923e-01  2.265293e-02  0.000000e+00
[11]  3.443991e-01  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[16]  0.000000e+00  1.904193e-01  0.000000e+00  0.000000e+00  0.000000e+00
[21]  0.000000e+00  0.000000e+00  0.000000e+00  5.498353e-03  0.000000e+00
[26]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[31]  0.000000e+00  0.000000e+00  2.914403e-01  0.000000e+00  0.000000e+00
[36]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[41]  6.342723e-01  0.000000e+00  3.769397e-02  0.000000e+00  0.000000e+00
[46] -4.126108e-02 -1.717659e-05  0.000000e+00  0.000000e+00  0.000000e+00
[51]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[56]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 -3.382487e-01
[61]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[66]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[71] -3.343625e-03  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[76]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[81]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00 -9.579894e-02
[86]  0.000000e+00  0.000000e+00 -9.130365e-02  0.000000e+00  0.000000e+00
[91]  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00  0.000000e+00
[96]  0.000000e+00
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.654830027428735; time_taken: 104.196020841599"
Time to run lasso model: 391.265077829361 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.9038521

$`S_lasso_correctly-specified_linear-only`
[1] 0.6698525

$`S_lasso_linear_linear-only`
[1] 0.7510424

$`S_lasso_flexible_linear-only`
[1] 0.7510424

$`T_lasso_mild-complex`
[1] 0.7115829

$`S_lasso_correctly-specified_mild-complex`
[1] 0.228549

$`S_lasso_linear_mild-complex`
[1] 0.1368903

$`S_lasso_flexible_mild-complex`
[1] 0.65483

Results for iteration 27 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_27-seed_420.csv
There were 50 or more warnings (use warnings() to see the first 50)
