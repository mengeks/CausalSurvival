Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 48
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 48: 651
Loaded dataset 48 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_48_n_500.rds 
Time to load dataset: 0.0319328308105469 seconds
Loaded dataset 148 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_148_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   0.24934179
X.3   .         
X.4   .         
X.5  -0.34684920
X.6   .         
X.7   0.10656517
X.8   .         
X.9   .         
X.10  0.07880497
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.10613332
X.2  .         
X.3  0.04767292
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.33704375
[1] "head(CATE_est)"
              1
[1,] -0.4022541
[2,] -0.0789328
[3,]  0.3681942
[4,]  0.1589851
[5,]  0.2233931
[6,]  0.5727802
[1] "head(CATE_true)"
[1]  0.31009787 -0.02127927  1.07947282  0.72032676  1.75136866  2.15498544
[1] "config_name: T_lasso_linear-only. MSE: 1.40845152422485. time_taken: 10.7055068016052"
[1] "CATE_spec: correctly-specified"
[1] 1.331456
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.1018161
     0.3466879
[1] "beta_CATE: "
[1] 0.1018161 0.3466879
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.33145623593738; time_taken: 6.67041325569153"
[1] "CATE_spec: linear"
[1] 1.342743
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
train_data$W .          
X.1          0.092337673
X.2          .          
X.3          0.007885314
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.341588421
[1] "beta_CATE: "
 [1] 0.000000000 0.092337673 0.000000000 0.007885314 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.341588421
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.34274269240725; time_taken: 8.67941284179688"
[1] "CATE_spec: flexible"
[1] 1.342743
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  .          
X.2  .          
X.3  .          
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 .          
     .          
X.1  0.092337673
X.2  .          
X.3  0.007885314
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 0.341588421
[1] "beta_CATE: "
 [1] 0.000000000 0.092337673 0.000000000 0.007885314 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.341588421
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.34274269240725; time_taken: 8.5626802444458"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           .        
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           .        
X.10          .        
X.1_spline1   .        
X.1_spline2   .        
X.1_spline3   .        
X.2_spline1   .        
X.2_spline2   1.3389826
X.2_spline3   .        
X.3_spline1   .        
X.3_spline2   .        
X.3_spline3   .        
X.4_spline1   .        
X.4_spline2   .        
X.4_spline3   .        
X.5_spline1  -0.3902739
X.5_spline2   .        
X.5_spline3   .        
X.6_spline1   .        
X.6_spline2   .        
X.6_spline3   .        
X.7_spline1   .        
X.7_spline2   .        
X.7_spline3   .        
X.8_spline1   .        
X.8_spline2   .        
X.8_spline3   .        
X.9_spline1   .        
X.9_spline2   .        
X.9_spline3   .        
X.10_spline1  .        
X.10_spline2  .        
X.10_spline3  .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.225991550
X.2           0.007173878
X.3           0.001367835
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.450151856
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.317188102
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.485007033
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  1.023140641
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.028120997
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.015122027
              .          
              .          
             -0.178825155
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -0.5609611
[2,] -0.2010718
[3,]  0.1209494
[4,] -0.2030552
[5,]  0.1259693
[6,]  0.2069623
[1] "head(CATE_true)"
[1]  0.31009787 -0.02127927  1.07947282  0.72032676  1.75136866  2.15498544
[1] "config_name: T_lasso_mild-complex. MSE: 1.34228406701171. time_taken: 80.3582408428192"
[1] "CATE_spec: correctly-specified"
[1] 0.9741154
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5          -0.0165766071
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1  -0.0002710949
X.2_spline2   0.0753181623
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -0.4229717213
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3  -0.0240669786
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  1.1664109335
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0526214251
              .           
             -0.0800258811
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.2194549277
              0.4574297846
[1] "beta_CATE: "
[1] 0.2194549 0.4574298
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.974115446780314; time_taken: 46.3810937404633"
[1] "CATE_spec: linear"
[1] 1.03562
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5          -9.646006e-04
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   2.248538e-05
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -2.814128e-01
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  1.043852e+00
X.10_spline3  .           
V41           .           
V42           .           
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           .           
V49           .           
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57          -5.219847e-02
V58           .           
V59          -6.493312e-02
V60           .           
V61           .           
V62           .           
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W -1.772900e-02
X.1           1.890529e-01
X.2           .           
X.3           9.144409e-03
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           1.953629e-02
X.10          4.187637e-01
[1] "beta_CATE: "
 [1] -0.017728996  0.189052919  0.000000000  0.009144409  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.000000000  0.019536292
[11]  0.418763733
[1] "config_name: S_lasso_linear_mild-complex; MSE: 1.03562013350385; time_taken: 48.1300191879272"
[1] "CATE_spec: flexible"
[1] 1.090426
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.086633512
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.061241530
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.511866439
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.009297779
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.216705028
X.2           .          
X.3           0.008861078
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.010857595
X.10          0.454972723
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   0.071943820
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   0.077584146
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.044342905
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.175268131
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.216705028  0.000000000  0.008861078  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.000000000  0.010857595
[11]  0.454972723  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.071943820  0.000000000  0.000000000  0.077584146
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000 -0.044342905  0.000000000
[51]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000 -0.175268131
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 1.09042597208635; time_taken: 75.2357609272003"
Time to run lasso model: 285.901327133179 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.408452

$`S_lasso_correctly-specified_linear-only`
[1] 1.331456

$`S_lasso_linear_linear-only`
[1] 1.342743

$`S_lasso_flexible_linear-only`
[1] 1.342743

$`T_lasso_mild-complex`
[1] 1.342284

$`S_lasso_correctly-specified_mild-complex`
[1] 0.9741154

$`S_lasso_linear_mild-complex`
[1] 1.03562

$`S_lasso_flexible_mild-complex`
[1] 1.090426

Results for iteration 48 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_48-seed_651.csv
There were 50 or more warnings (use warnings() to see the first 50)
