Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 91
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 91: 1124
Loaded dataset 91 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_91_n_500.rds 
Time to load dataset: 0.0186827182769775 seconds
Loaded dataset 191 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_191_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.13543883
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.07051168
X.8  .         
X.9  .         
X.10 0.22119406
[1] "head(CATE_est)"
               1
[1,] -0.39504264
[2,] -0.44650973
[3,] -0.01097001
[4,]  0.37683560
[5,] -0.37140494
[6,]  0.12551777
[1] "head(CATE_true)"
[1] -1.3334821 -1.8015339 -0.2603911  1.6773984 -1.0699670 -0.4807908
[1] "config_name: T_lasso_linear-only. MSE: 1.4890419004689. time_taken: 13.8364717960358"
[1] "CATE_spec: correctly-specified"
[1] 1.481655
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.1516020
     0.2817313
[1] "beta_CATE: "
[1] 0.1516020 0.2817313
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.48165533625847; time_taken: 8.00006318092346"
[1] "CATE_spec: linear"
[1] 1.443075
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.13764107
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          0.08124114
X.8          .         
X.9          .         
X.10         0.23365829
[1] "beta_CATE: "
 [1] 0.00000000 0.13764107 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.08124114 0.00000000 0.00000000 0.23365829
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.44307543959157; time_taken: 10.535683631897"
[1] "CATE_spec: flexible"
[1] 1.457587
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     .        
X.1  0.1331757
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  0.0808708
X.8  .        
X.9  .        
X.10 0.2307817
[1] "beta_CATE: "
 [1] 0.0000000 0.1331757 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0808708 0.0000000 0.0000000 0.2307817
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.45758696455692; time_taken: 10.4727704524994"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   0.03980013
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.25943407
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.07578439
              .         
              .         
             -0.18285248
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.16820820
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.17718286
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.45505960
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   0.38388327
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   0.09875243
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   0.26765039
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  0.16240631
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.03980269
              .         
             -0.20105334
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.21201405
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -0.8762098
[2,] -1.2019820
[3,]  0.3371305
[4,]  1.0788307
[5,] -1.2070295
[6,]  0.6562460
[1] "head(CATE_true)"
[1] -1.3334821 -1.8015339 -0.2603911  1.6773984 -1.0699670 -0.4807908
[1] "config_name: T_lasso_mild-complex. MSE: 1.07327637548264. time_taken: 85.5356678962708"
[1] "CATE_spec: correctly-specified"
[1] 1.299932
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   0.16096600
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.12745753
             -0.01456086
             -0.05405213
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.15169393
              0.39164139
[1] "beta_CATE: "
[1] 0.1516939 0.3916414
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 1.29993170567352; time_taken: 43.1588711738586"
[1] "CATE_spec: linear"
[1] 1.137412
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57          -0.186644312
V58          -0.027867981
V59          -0.031850267
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.143428956
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.172132911
X.8           0.007453857
X.9           .          
X.10          0.318568427
[1] "beta_CATE: "
 [1] 0.000000000 0.143428956 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.172132911 0.007453857 0.000000000 0.318568427
[1] "config_name: S_lasso_linear_mild-complex; MSE: 1.13741189405926; time_taken: 44.9132995605469"
[1] "CATE_spec: flexible"
[1] 0.8267943
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1  -0.123023210
X.3_spline2   0.022779516
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.030146488
              .          
             -0.004828329
             -0.125499931
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.071916925
              .          
              .          
              .          
              .          
X.1           0.269791017
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.104181720
X.8           0.064823007
X.9           .          
X.10          0.580888126
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   0.300083524
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.008667841
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.062274595
              .          
             -0.023233733
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.180147452
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.298180109
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.001883668
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.269791017  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.104181720  0.064823007  0.000000000
[11]  0.580888126  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.300083524  0.000000000
[26]  0.000000000  0.008667841  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000 -0.062274595  0.000000000
[51] -0.023233733  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000 -0.180147452
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000 -0.298180109
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86] -0.001883668  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.82679428031606; time_taken: 75.3841326236725"
Time to run lasso model: 293.222445011139 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.489042

$`S_lasso_correctly-specified_linear-only`
[1] 1.481655

$`S_lasso_linear_linear-only`
[1] 1.443075

$`S_lasso_flexible_linear-only`
[1] 1.457587

$`T_lasso_mild-complex`
[1] 1.073276

$`S_lasso_correctly-specified_mild-complex`
[1] 1.299932

$`S_lasso_linear_mild-complex`
[1] 1.137412

$`S_lasso_flexible_mild-complex`
[1] 0.8267943

Results for iteration 91 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_91-seed_1124.csv
There were 50 or more warnings (use warnings() to see the first 50)
