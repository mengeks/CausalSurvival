Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 49
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 49: 662
Loaded dataset 49 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_49_n_500.rds 
Time to load dataset: 0.0282292366027832 seconds
Loaded dataset 149 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_149_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   .        
X.2   .        
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7   0.0159542
X.8   0.1344264
X.9   .        
X.10 -0.1465325
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.056872159
X.2  0.075342680
X.3  0.007730358
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 0.352181603
[1] "head(CATE_est)"
              1
[1,]  0.7491945
[2,] -0.4881874
[3,]  0.6464027
[4,] -0.3314250
[5,]  0.4262750
[6,]  0.6150006
[1] "head(CATE_true)"
[1]  0.5325370 -0.5377433  2.7914621  0.1064422 -0.1315152  2.3011537
[1] "config_name: T_lasso_linear-only. MSE: 1.3330327660228. time_taken: 10.7145829200745"
[1] "CATE_spec: correctly-specified"
[1] 1.320218
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  .          
X.2  0.001284653
X.3  .          
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 .          
     0.117525587
     0.375061788
[1] "beta_CATE: "
[1] 0.1175256 0.3750618
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.3202183874517; time_taken: 7.05548882484436"
[1] "CATE_spec: linear"
[1] 1.387277
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.01991651
X.2          0.06662621
X.3          0.02120029
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         0.34677787
[1] "beta_CATE: "
 [1] 0.00000000 0.01991651 0.06662621 0.02120029 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.34677787
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.38727669987115; time_taken: 8.12743091583252"
[1] "CATE_spec: flexible"
[1] 1.291818
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.04985148
X.2  0.07230584
X.3  0.02075258
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.36455428
[1] "beta_CATE: "
 [1] 0.00000000 0.04985148 0.07230584 0.02075258 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.36455428
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.29181818106842; time_taken: 8.3100438117981"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.1802039534
X.9           .           
X.10         -0.1952065113
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   0.2730472831
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.8611515774
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   0.0031956650
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   0.0324170941
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
             -0.0046796702
              .           
              .           
              0.0009687487
              .           
              .           
              .           
              .           
              .           
             -0.0303444050
              .           
              .           
              .           
             -0.0163151147
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0955776542
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.2157649467
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0207096385
              .           
              .           
              .           
              .           
              .           
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           0.001093558
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.451419435
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   0.621920273
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.186190199
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   0.433395305
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   0.932536538
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.089550937
              0.113376294
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.120966077
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
             1
[1,] 2.1313199
[2,] 0.5998179
[3,] 0.6432288
[4,] 0.5296620
[5,] 1.6929522
[6,] 0.9970841
[1] "head(CATE_true)"
[1]  0.5325370 -0.5377433  2.7914621  0.1064422 -0.1315152  2.3011537
[1] "config_name: T_lasso_mild-complex. MSE: 2.31071600713211. time_taken: 80.3292310237885"
[1] "CATE_spec: correctly-specified"
[1] 1.333455
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1  -0.1440709143
X.1_spline2   0.5568734912
X.1_spline3   1.1855122731
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   0.0328166226
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   0.1682409665
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.6259600685
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.4047088230
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   0.3709626913
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  1.2804655804
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0006998496
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0410896885
              .           
             -0.0311785811
             -0.0077729366
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0579778383
              .           
              .           
              .           
              .           
             -0.0217712189
              .           
              .           
              .           
              .           
              .           
              0.0409941563
              0.4825930142
[1] "beta_CATE: "
[1] 0.04099416 0.48259301
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 1.33345522377801; time_taken: 46.5834558010101"
[1] "CATE_spec: linear"
[1] 1.258472
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.0009283918
X.9           .           
X.10          .           
X.1_spline1  -0.1842844896
X.1_spline2   0.6864542582
X.1_spline3   1.3014340984
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   0.1256892210
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.6768851279
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.4144602914
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   0.3990501028
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  1.3948712741
X.10_spline3  .           
V41           .           
V42           .           
V43           .           
V44           .           
V45           .           
V46           .           
V47          -0.0037809260
V48           .           
V49           .           
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56          -0.0448946702
V57           .           
V58          -0.0377945997
V59          -0.0091032455
V60           .           
V61           .           
V62           .           
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85          -0.0614709220
V86           .           
V87           .           
V88           .           
V89           .           
V90          -0.0143351302
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W  .           
X.1           0.0160715970
X.2           0.0561459567
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.4937907561
[1] "beta_CATE: "
 [1] 0.00000000 0.01607160 0.05614596 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.49379076
[1] "config_name: S_lasso_linear_mild-complex; MSE: 1.2584722069494; time_taken: 47.0125999450684"
[1] "CATE_spec: flexible"
[1] 1.425147
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.02370621
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.31494980
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.18007639
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   0.37622667
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  0.49611080
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.04342210
X.2           .         
X.3           0.02871763
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.48203308
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              0.00879836
              .         
              .         
              .         
             -0.01543081
              .         
              .         
              .         
              .         
              .         
              0.04133949
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.12505550
              0.12968708
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.15502958
              .         
              .         
              .         
              .         
              .         
              .         
             -0.01858736
              .         
              .         
              .         
[1] "beta_CATE: "
 [1]  0.00000000  0.04342210  0.00000000  0.02871763  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.00000000  0.48203308  0.00000000
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00879836
[43]  0.00000000  0.00000000  0.00000000 -0.01543081  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.04133949  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.12505550
[61]  0.12968708  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000 -0.15502958  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000 -0.01858736  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 1.42514702108936; time_taken: 71.4771230220795"
Time to run lasso model: 280.785964488983 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.333033

$`S_lasso_correctly-specified_linear-only`
[1] 1.320218

$`S_lasso_linear_linear-only`
[1] 1.387277

$`S_lasso_flexible_linear-only`
[1] 1.291818

$`T_lasso_mild-complex`
[1] 2.310716

$`S_lasso_correctly-specified_mild-complex`
[1] 1.333455

$`S_lasso_linear_mild-complex`
[1] 1.258472

$`S_lasso_flexible_mild-complex`
[1] 1.425147

Results for iteration 49 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_49-seed_662.csv
There were 50 or more warnings (use warnings() to see the first 50)
