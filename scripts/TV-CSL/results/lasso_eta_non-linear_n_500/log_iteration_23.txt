Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 23
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 23: 376
Loaded dataset 23 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_23_n_500.rds 
Time to load dataset: 0.0911881923675537 seconds
Loaded dataset 123 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_123_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.19579696
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.09571572
X.8  .         
X.9  0.01414312
X.10 0.17589466
[1] "head(CATE_est)"
              1
[1,] -0.3295214
[2,]  0.2135379
[3,]  0.7696011
[4,]  0.1755094
[5,] -0.3191469
[6,]  0.1989087
[1] "head(CATE_true)"
[1] -1.1002454  1.0653430  3.1391279  0.9393710 -1.4255407  0.8166642
[1] "config_name: T_lasso_linear-only. MSE: 1.35830594857327. time_taken: 17.1304733753204"
[1] "CATE_spec: correctly-specified"
[1] 1.184667
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2  -0.08525513
X.3  -0.01367824
X.4   .         
X.5   .         
X.6   .         
X.7   0.04025199
X.8   .         
X.9   .         
X.10  .         
      0.30089285
      0.27403690
[1] "beta_CATE: "
[1] 0.3008929 0.2740369
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.18466717473313; time_taken: 12.5236542224884"
[1] "CATE_spec: linear"
[1] 1.466703
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
train_data$W .          
X.1          0.142124219
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          0.096448845
X.8          .          
X.9          0.005401889
X.10         0.176769690
[1] "beta_CATE: "
 [1] 0.000000000 0.142124219 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.096448845 0.000000000 0.005401889 0.176769690
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.46670339929629; time_taken: 13.7493762969971"
[1] "CATE_spec: flexible"
[1] 1.414881
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   .          
X.2   .          
X.3   .          
X.4   .          
X.5   .          
X.6   .          
X.7   .          
X.8   .          
X.9   .          
X.10  .          
     -0.001173628
X.1   0.158560867
X.2   .          
X.3   .          
X.4   .          
X.5   .          
X.6   .          
X.7   0.097747790
X.8   .          
X.9   0.004435061
X.10  0.188466820
[1] "beta_CATE: "
 [1] -0.001173628  0.158560867  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.097747790  0.000000000  0.004435061
[11]  0.188466820
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.41488145152115; time_taken: 13.9019048213959"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   1.22952711
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.35523252
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              0.04044205
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.62679856
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.25074186
X.8           .         
X.9           .         
X.10          0.76590298
X.1_spline1   .         
X.1_spline2   1.05409114
X.1_spline3   .         
X.2_spline1  -0.54811351
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1  -0.15437085
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -1.57974657
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1  -0.20639322
X.6_spline2   0.46063175
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1  -0.16516753
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.10918098
X.10_spline2  2.94344347
X.10_spline3  .         
              .         
              .         
              .         
              .         
             -0.01883950
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.31181239
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.19779179
              .         
             -0.13165597
              .         
              .         
              .         
              .         
             -0.08701826
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -0.3746123
[2,]  1.1064874
[3,]  3.4001688
[4,]  0.9703099
[5,] -0.7610360
[6,]  1.0444875
[1] "head(CATE_true)"
[1] -1.1002454  1.0653430  3.1391279  0.9393710 -1.4255407  0.8166642
[1] "config_name: T_lasso_mild-complex. MSE: 1.23756452120167. time_taken: 112.030346393585"
[1] "CATE_spec: correctly-specified"
[1] 0.5267497
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3          -0.02338586
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1  -0.25299922
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -0.51071172
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3  -0.13985548
X.6_spline1   .         
X.6_spline2   0.61428354
X.6_spline3   .         
X.7_spline1   0.17330116
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.43074470
X.10_spline2  1.57460110
X.10_spline3  .         
              .         
              .         
              .         
              .         
             -0.05377868
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.03895304
              .         
              .         
              .         
              .         
              .         
             -0.29581699
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02499104
              .         
              .         
              .         
              0.40756627
              0.65845043
[1] "beta_CATE: "
[1] 0.4075663 0.6584504
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.526749672943838; time_taken: 68.4935264587402"
[1] "CATE_spec: linear"
[1] 0.4736701
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3          -0.031917847
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.221218729
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.512897992
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3  -0.567081127
X.6_spline1   .          
X.6_spline2   0.564813930
X.6_spline3  -0.138863340
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.317739512
X.10_spline2  1.466809818
X.10_spline3  .          
V41           0.001995918
V42           .          
V43           .          
V44           .          
V45          -0.022766370
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           0.009116945
V53           0.008667379
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59          -0.292294606
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65          -0.001920000
V66           .          
V67          -0.004641527
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92          -0.029161075
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.392571933
X.2           .          
X.3           .          
X.4           0.007752465
X.5           .          
X.6           .          
X.7           0.219255015
X.8           .          
X.9           .          
X.10          0.525844337
[1] "beta_CATE: "
 [1] 0.000000000 0.392571933 0.000000000 0.000000000 0.007752465 0.000000000
 [7] 0.000000000 0.219255015 0.000000000 0.000000000 0.525844337
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.473670096549549; time_taken: 69.7454130649567"
[1] "CATE_spec: flexible"
[1] 0.8860897
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.150510158
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.220978234
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   0.956954545
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.467053358
X.10_spline3  .          
              .          
              .          
              .          
              .          
             -0.016917727
              .          
              .          
              .          
              .          
              .          
              .          
              0.015706741
              .          
              .          
              .          
              .          
             -0.003749233
              .          
             -0.016450493
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.397636906
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.245906867
X.8           .          
X.9           .          
X.10          0.505038367
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.011410893
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.048600183
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
             -0.018250790
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.142790969
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.233145734
              .          
             -0.038595962
              .          
              .          
              .          
              .          
             -0.137924732
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.00000000  0.39763691  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.24590687  0.00000000  0.00000000  0.50503837  0.00000000
[13]  0.00000000  0.00000000 -0.01141089  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000 -0.04860018  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000 -0.01825079  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.14279097
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000 -0.23314573  0.00000000 -0.03859596  0.00000000  0.00000000
[73]  0.00000000  0.00000000 -0.13792473  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.886089675894618; time_taken: 109.929097890854"
Time to run lasso model: 419.586702346802 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.358306

$`S_lasso_correctly-specified_linear-only`
[1] 1.184667

$`S_lasso_linear_linear-only`
[1] 1.466703

$`S_lasso_flexible_linear-only`
[1] 1.414881

$`T_lasso_mild-complex`
[1] 1.237565

$`S_lasso_correctly-specified_mild-complex`
[1] 0.5267497

$`S_lasso_linear_mild-complex`
[1] 0.4736701

$`S_lasso_flexible_mild-complex`
[1] 0.8860897

Results for iteration 23 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_23-seed_376.csv
There were 50 or more warnings (use warnings() to see the first 50)
