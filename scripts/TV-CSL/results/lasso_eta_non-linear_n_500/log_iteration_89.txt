Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 89
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 89: 1102
Loaded dataset 89 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_89_n_500.rds 
Time to load dataset: 0.0326330661773682 seconds
Loaded dataset 189 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_189_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.22375588
X.2   .         
X.3  -0.01042858
X.4   .         
X.5   .         
X.6   .         
X.7   0.22885333
X.8   .         
X.9   0.05862627
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.13290986
X.2  0.07823580
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.10264859
X.9  0.04349783
X.10 0.14508409
[1] "head(CATE_est)"
               1
[1,]  0.73789472
[2,] -0.02272481
[3,] -0.29805373
[4,] -0.19786198
[5,]  0.27051253
[6,]  0.49955965
[1] "head(CATE_true)"
[1]  2.89809278 -0.51228141 -1.43678675 -0.02862926  0.43459532  1.01810097
[1] "config_name: T_lasso_linear-only. MSE: 1.24220490333257. time_taken: 11.6902024745941"
[1] "CATE_spec: correctly-specified"
[1] 0.9112295
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.27080476
X.2   0.16836252
X.3  -0.24011152
X.4   .         
X.5   .         
X.6   0.10156101
X.7   .         
X.8   0.11149933
X.9   0.07605538
X.10  .         
      0.54813962
      0.15102617
[1] "beta_CATE: "
[1] 0.5481396 0.1510262
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.911229505097999; time_taken: 7.7444474697113"
[1] "CATE_spec: linear"
[1] 1.013862
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          -0.04743954
X.2           .         
X.3          -0.16906509
X.4           .         
X.5           .         
X.6           0.04625782
X.7           .         
X.8           0.08187813
X.9           0.08573091
X.10          .         
train_data$W  .         
X.1           0.22018917
X.2           0.22455796
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.03340115
X.9           .         
X.10          0.12746908
[1] "beta_CATE: "
 [1] 0.00000000 0.22018917 0.22455796 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.03340115 0.00000000 0.12746908
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.01386160199753; time_taken: 9.55339813232422"
[1] "CATE_spec: flexible"
[1] 1.013862
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.04743954
X.2   .         
X.3  -0.16906509
X.4   .         
X.5   .         
X.6   0.04625782
X.7   .         
X.8   0.08187813
X.9   0.08573091
X.10  .         
      .         
X.1   0.22018917
X.2   0.22455796
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   0.03340115
X.9   .         
X.10  0.12746908
[1] "beta_CATE: "
 [1] 0.00000000 0.22018917 0.22455796 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.03340115 0.00000000 0.12746908
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.01386160199753; time_taken: 9.48127055168152"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.09493512
X.8           .         
X.9           0.00501288
X.10          .         
X.1_spline1  -0.25008771
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   0.09406281
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.07439490
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           0.01838185
X.10          0.27649457
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   0.20289239
X.3_spline1   0.16094135
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.00775137
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.82970652
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   0.26887159
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  0.75417830
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              0.02152211
              .         
              .         
              .         
              .         
              0.06302774
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.17638906
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
                1
[1,]  0.431897166
[2,] -0.187314026
[3,] -0.459417879
[4,]  0.005309882
[5,]  0.276420748
[6,]  0.291284650
[1] "head(CATE_true)"
[1]  2.89809278 -0.51228141 -1.43678675 -0.02862926  0.43459532  1.01810097
[1] "config_name: T_lasso_mild-complex. MSE: 1.30714781268137. time_taken: 81.1486604213715"
[1] "CATE_spec: correctly-specified"
[1] 1.132456
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.044774236
X.9           0.055201033
X.10          .          
X.1_spline1  -0.438480406
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   0.241338369
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.030291569
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.018557567
X.10_spline3  .          
              .          
              0.008727455
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.041654148
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.101185047
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.271953770
              0.230134624
[1] "beta_CATE: "
[1] 0.2719538 0.2301346
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 1.13245618992084; time_taken: 42.1730000972748"
[1] "CATE_spec: linear"
[1] 0.8490419
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3          -0.014709367
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.024864431
X.9           0.068343946
X.10          .          
X.1_spline1  -0.653955117
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3  -0.456781678
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.119847889
X.6_spline3   0.308121942
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.174212359
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.237309320
X.10_spline3  .          
V41           .          
V42           0.027192777
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           0.025387767
V52           .          
V53           .          
V54           .          
V55           .          
V56          -0.005842255
V57           .          
V58           .          
V59          -0.137979752
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.318518059
X.2           0.117042063
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.030898837
X.9           .          
X.10          0.244889309
[1] "beta_CATE: "
 [1] 0.00000000 0.31851806 0.11704206 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.03089884 0.00000000 0.24488931
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.849041883373468; time_taken: 42.647155046463"
[1] "CATE_spec: flexible"
[1] 0.7006199
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3          -0.057154546
X.4          -0.089889203
X.5           .          
X.6           .          
X.7           .          
X.8           0.048037745
X.9           0.160676387
X.10          .          
X.1_spline1  -0.924182931
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3  -0.717414841
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.361736433
X.6_spline3   .          
X.7_spline1   0.230807678
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   0.360484803
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.160463737
X.10_spline3  .          
              .          
              .          
              .          
              .          
             -0.077224313
              .          
              .          
              .          
              .          
              .          
              0.023543928
              .          
              .          
              .          
              .          
             -0.008653988
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.010317065
             -0.020619665
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.087607054
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.464261686
X.2           0.086511689
X.3           .          
X.4          -0.053905142
X.5           .          
X.6          -0.170221629
X.7          -0.060547901
X.8           .          
X.9           .          
X.10          0.646709705
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   0.470284939
X.3_spline1   1.056198531
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   0.196943896
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.251465044
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.904097414
X.10_spline2  .          
X.10_spline3  .          
              .          
              0.011373918
              .          
              .          
              .          
              0.103874502
              .          
              .          
              .          
             -0.088195072
              0.106287580
              .          
             -0.063736443
              .          
              .          
             -0.254146135
              .          
              .          
             -0.131613375
              .          
              .          
              .          
              0.092554777
              .          
              .          
              .          
             -0.076773172
              .          
              .          
              .          
              .          
              .          
              .          
             -0.303483256
              .          
              0.124789380
              .          
              0.199799239
              0.081189529
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.059579250
[1] "beta_CATE: "
 [1]  0.00000000  0.46426169  0.08651169  0.00000000 -0.05390514  0.00000000
 [7] -0.17022163 -0.06054790  0.00000000  0.00000000  0.64670971  0.00000000
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.47028494  1.05619853
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.19694390
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.25146504  0.00000000
[37]  0.00000000  0.00000000 -0.90409741  0.00000000  0.00000000  0.00000000
[43]  0.01137392  0.00000000  0.00000000  0.00000000  0.10387450  0.00000000
[49]  0.00000000  0.00000000 -0.08819507  0.10628758  0.00000000 -0.06373644
[55]  0.00000000  0.00000000 -0.25414614  0.00000000  0.00000000 -0.13161338
[61]  0.00000000  0.00000000  0.00000000  0.09255478  0.00000000  0.00000000
[67]  0.00000000 -0.07677317  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000 -0.30348326  0.00000000  0.12478938  0.00000000
[79]  0.19979924  0.08118953  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.05957925
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.700619944656267; time_taken: 72.7136039733887"
Time to run lasso model: 278.365052700043 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.242205

$`S_lasso_correctly-specified_linear-only`
[1] 0.9112295

$`S_lasso_linear_linear-only`
[1] 1.013862

$`S_lasso_flexible_linear-only`
[1] 1.013862

$`T_lasso_mild-complex`
[1] 1.307148

$`S_lasso_correctly-specified_mild-complex`
[1] 1.132456

$`S_lasso_linear_mild-complex`
[1] 0.8490419

$`S_lasso_flexible_mild-complex`
[1] 0.7006199

Results for iteration 89 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_89-seed_1102.csv
There were 50 or more warnings (use warnings() to see the first 50)
