Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 66
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 66: 849
Loaded dataset 66 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_66_n_500.rds 
Time to load dataset: 0.0460638999938965 seconds
Loaded dataset 166 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_166_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2  -0.17646350
X.3   .         
X.4   0.16799221
X.5   .         
X.6   .         
X.7  -0.36725099
X.8  -0.00111055
X.9   .         
X.10  0.01809984
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.14917177
X.2  0.09147487
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.14235139
X.9  0.05213908
X.10 0.03727084
[1] "head(CATE_est)"
               1
[1,]  0.27161906
[2,]  0.16278568
[3,]  0.09218568
[4,]  1.32199947
[5,]  0.05010022
[6,] -0.73788375
[1] "head(CATE_true)"
[1]  0.1084775 -0.5342208 -0.0855593  1.6783036  0.1706225 -2.0392798
[1] "config_name: T_lasso_linear-only. MSE: 0.885474137813079. time_taken: 30.3453397750854"
[1] "CATE_spec: correctly-specified"
[1] 1.145164
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1  -0.034016543
X.2  -0.004534362
X.3   .          
X.4   .          
X.5   .          
X.6   .          
X.7  -0.066146791
X.8   .          
X.9   .          
X.10  .          
      0.318883324
      0.280257199
[1] "beta_CATE: "
[1] 0.3188833 0.2802572
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.14516420915408; time_taken: 20.6467154026031"
[1] "CATE_spec: linear"
[1] 0.8826316
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2          -0.04682106
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.20068501
X.8           .         
X.9           .         
X.10          .         
train_data$W  .         
X.1           0.14937220
X.2           0.20574723
X.3           .         
X.4           0.02443172
X.5           .         
X.6           .         
X.7           .         
X.8           0.33561176
X.9           0.08312158
X.10          0.01524441
[1] "beta_CATE: "
 [1] 0.00000000 0.14937220 0.20574723 0.00000000 0.02443172 0.00000000
 [7] 0.00000000 0.00000000 0.33561176 0.08312158 0.01524441
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.882631573095955; time_taken: 24.0476338863373"
[1] "CATE_spec: flexible"
[1] 0.8576089
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2  -0.05447244
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7  -0.20660591
X.8   .         
X.9   .         
X.10  .         
      .         
X.1   0.15106044
X.2   0.21571022
X.3   .         
X.4   0.02759528
X.5   .         
X.6   .         
X.7   .         
X.8   0.33990630
X.9   0.08458454
X.10  0.01554404
[1] "beta_CATE: "
 [1] 0.00000000 0.15106044 0.21571022 0.00000000 0.02759528 0.00000000
 [7] 0.00000000 0.00000000 0.33990630 0.08458454 0.01554404
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.857608893905136; time_taken: 22.3627009391785"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.18076217
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1  -0.07084877
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.74684844
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.09030253
X.9           0.01813606
X.10          0.49176215
X.1_spline1   .         
X.1_spline2   3.81402597
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2  -0.54729332
X.2_spline3   .         
X.3_spline1  -0.46510906
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -1.45214991
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.76318642
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.01156382
X.8_spline3   0.04677102
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.21754294
X.10_spline1 -0.06744412
X.10_spline2  1.10328906
X.10_spline3  .         
             -0.01696628
              .         
              .         
              0.04864931
              .         
              .         
             -0.02776799
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.49538519
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.13621285
              .         
              .         
             -0.12029403
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  1.3962900
[2,]  0.8393421
[3,]  0.9524708
[4,]  1.6134906
[5,]  1.1780549
[6,] -1.3509558
[1] "head(CATE_true)"
[1]  0.1084775 -0.5342208 -0.0855593  1.6783036  0.1706225 -2.0392798
[1] "config_name: T_lasso_mild-complex. MSE: 1.30867478656642. time_taken: 133.770322799683"
[1] "CATE_spec: correctly-specified"
[1] 0.2302728
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2          -0.02730982
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.10904915
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   2.45886059
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.06657515
X.4_spline2  -1.64182257
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.02143201
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2  -0.18229335
X.7_spline3  -0.52573883
X.8_spline1   .         
X.8_spline2  -0.68525981
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.67438878
X.10_spline2  0.59346963
X.10_spline3 -0.56627818
              .         
              0.08747111
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.38826996
              .         
              .         
              .         
              .         
              .         
              0.09249865
              .         
             -0.11542259
              .         
              .         
              .         
              .         
              0.09477391
              .         
              .         
              .         
              .         
             -0.02296536
              .         
              .         
              .         
              .         
             -0.04068192
              .         
              .         
             -0.05338670
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.60489460
              0.78722747
[1] "beta_CATE: "
[1] 0.6048946 0.7872275
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.23027276504986; time_taken: 71.148877620697"
[1] "CATE_spec: linear"
[1] 0.4543625
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.17904411
X.8          -0.02437438
X.9           .         
X.10          .         
X.1_spline1  -0.07828036
X.1_spline2   1.10330702
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -1.21052785
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3  -0.45355456
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.19080081
X.10_spline2  0.74097816
X.10_spline3  .         
V41           .         
V42           0.05734637
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59          -0.29828824
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82          -0.02215815
V83           .         
V84           .         
V85          -0.01440190
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.45384685
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.35086366
X.9           0.09946625
X.10          0.26294373
[1] "beta_CATE: "
 [1] 0.00000000 0.45384685 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.35086366 0.09946625 0.26294373
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.454362480075415; time_taken: 85.0167963504791"
[1] "CATE_spec: flexible"
[1] 0.7502288
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7          -0.127262632
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.067611921
X.1_spline2   0.559918831
X.1_spline3   .          
X.2_spline1  -0.063695767
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.571995396
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  0.746643875
X.10_spline3  .          
              .          
              0.013695806
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.003284505
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.490926597
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.209348177
X.9           0.086938948
X.10          0.375112335
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   0.066559097
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
             -0.008967566
              .          
              .          
              .          
              .          
              .          
             -0.003423168
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.014480343
             -0.423490713
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.075325332
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.070511189
              .          
              .          
             -0.128040345
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.490926597  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.209348177  0.086938948
[11]  0.375112335  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.066559097  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000 -0.008967566  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000 -0.003423168  0.000000000  0.000000000
[51]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000 -0.014480343 -0.423490713
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.075325332  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000 -0.070511189  0.000000000  0.000000000
[86] -0.128040345  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.750228811795605; time_taken: 154.940785646439"
Time to run lasso model: 546.049072980881 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.8854741

$`S_lasso_correctly-specified_linear-only`
[1] 1.145164

$`S_lasso_linear_linear-only`
[1] 0.8826316

$`S_lasso_flexible_linear-only`
[1] 0.8576089

$`T_lasso_mild-complex`
[1] 1.308675

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2302728

$`S_lasso_linear_mild-complex`
[1] 0.4543625

$`S_lasso_flexible_mild-complex`
[1] 0.7502288

Results for iteration 66 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_66-seed_849.csv
There were 50 or more warnings (use warnings() to see the first 50)
