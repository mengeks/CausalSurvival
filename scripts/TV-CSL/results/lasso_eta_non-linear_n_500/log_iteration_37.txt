Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 37
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 37: 530
Loaded dataset 37 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_37_n_500.rds 
Time to load dataset: 0.0575258731842041 seconds
Loaded dataset 137 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_137_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.21783540
X.2  .         
X.3  0.10162226
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.03906275
X.10 0.05831611
[1] "head(CATE_est)"
                1
[1,] -0.031135400
[2,] -0.070568476
[3,]  0.001758061
[4,] -0.095881968
[5,] -0.261753584
[6,] -0.138433634
[1] "head(CATE_true)"
[1] -0.1622808 -0.6318769  0.3006789 -0.9268471 -1.5638366 -0.6590606
[1] "config_name: T_lasso_linear-only. MSE: 1.40730457738573. time_taken: 16.8471655845642"
[1] "CATE_spec: correctly-specified"
[1] 1.299372
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  .          
X.2  .          
X.3  0.003260094
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 .          
     0.347698296
     0.129765713
[1] "beta_CATE: "
[1] 0.3476983 0.1297657
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.29937208702358; time_taken: 10.992561340332"
[1] "CATE_spec: linear"
[1] 1.324779
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.22962228
X.2          .         
X.3          0.15317232
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          0.03923785
X.10         0.05461171
[1] "beta_CATE: "
 [1] 0.00000000 0.22962228 0.00000000 0.15317232 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.03923785 0.05461171
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.32477872035113; time_taken: 14.8008029460907"
[1] "CATE_spec: flexible"
[1] 1.310007
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.23323566
X.2  .         
X.3  0.15478549
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.03967329
X.10 0.05806572
[1] "beta_CATE: "
 [1] 0.00000000 0.23323566 0.00000000 0.15478549 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.03967329 0.05806572
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.31000679536708; time_taken: 14.6186864376068"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           2.274638e-01
X.2           .           
X.3           3.885515e-02
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           5.582043e-02
X.10          1.699907e-01
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   2.746681e-01
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   8.259223e-02
X.3_spline2  -4.471671e-01
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  3.049035e-05
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
             -1.147278e-02
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -4.289448e-03
             -2.315672e-01
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -1.159690e-02
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "head(CATE_est)"
               1
[1,] -0.06531601
[2,] -0.29852041
[3,]  0.11496705
[4,] -0.25705968
[5,] -0.62740063
[6,] -0.39223313
[1] "head(CATE_true)"
[1] -0.1622808 -0.6318769  0.3006789 -0.9268471 -1.5638366 -0.6590606
[1] "config_name: T_lasso_mild-complex. MSE: 1.19644152140328. time_taken: 97.1829116344452"
[1] "CATE_spec: correctly-specified"
[1] 1.076242
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2  -0.05104307
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2  -0.94566130
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   0.30491988
X.9_spline3   .         
X.10_spline1 -0.25239634
X.10_spline2  0.01914279
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02297963
              .         
              .         
              .         
             -0.14196319
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.33184011
              0.26701902
[1] "beta_CATE: "
[1] 0.3318401 0.2670190
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 1.07624187523218; time_taken: 54.4163546562195"
[1] "CATE_spec: linear"
[1] 0.869278
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6          -0.041243378
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2  -0.396176965
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.009223961
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3  -0.039516439
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   0.373619698
X.9_spline3   .          
X.10_spline1 -0.275731369
X.10_spline2  .          
X.10_spline3  .          
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55          -0.039429330
V56          -0.010361547
V57           .          
V58           .          
V59          -0.133661370
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.271112411
X.2           .          
X.3           0.194294758
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.098905900
X.10          0.201342168
[1] "beta_CATE: "
 [1] 0.0000000 0.2711124 0.0000000 0.1942948 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0989059 0.2013422
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.869278022572855; time_taken: 45.6722409725189"
[1] "CATE_spec: flexible"
[1] 1.052785
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.253924351
X.2           .          
X.3           0.150579674
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.069832412
X.10          0.168306596
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.163825335
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.009518786
             -0.230521881
              .          
              .          
              .          
              .          
             -0.029219222
              .          
              .          
             -0.007139309
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.253924351  0.000000000  0.150579674  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.000000000  0.069832412
[11]  0.168306596  0.000000000  0.000000000  0.000000000  0.163825335
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[51]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000 -0.009518786 -0.230521881
[61]  0.000000000  0.000000000  0.000000000  0.000000000 -0.029219222
[66]  0.000000000  0.000000000 -0.007139309  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 1.05278545412351; time_taken: 75.9048702716827"
Time to run lasso model: 332.624163627625 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.407305

$`S_lasso_correctly-specified_linear-only`
[1] 1.299372

$`S_lasso_linear_linear-only`
[1] 1.324779

$`S_lasso_flexible_linear-only`
[1] 1.310007

$`T_lasso_mild-complex`
[1] 1.196442

$`S_lasso_correctly-specified_mild-complex`
[1] 1.076242

$`S_lasso_linear_mild-complex`
[1] 0.869278

$`S_lasso_flexible_mild-complex`
[1] 1.052785

Results for iteration 37 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_37-seed_530.csv
There were 50 or more warnings (use warnings() to see the first 50)
