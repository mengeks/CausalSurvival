Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 95
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 95: 1168
Loaded dataset 95 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_95_n_500.rds 
Time to load dataset: 0.0248138904571533 seconds
Loaded dataset 195 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_195_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1  -0.075687699
X.2  -0.006151261
X.3   .          
X.4   .          
X.5   .          
X.6   .          
X.7   .          
X.8   .          
X.9   .          
X.10 -0.010099117
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.24253116
X.2  .         
X.3  0.01872639
X.4  .         
X.5  .         
X.6  .         
X.7  0.12221978
X.8  .         
X.9  0.01259620
X.10 0.08615293
[1] "head(CATE_est)"
              1
[1,]  0.0819622
[2,]  0.2545521
[3,]  0.2845140
[4,]  0.1273796
[5,] -0.1636907
[6,]  0.2004901
[1] "head(CATE_true)"
[1]  0.01246013  1.73997998  0.28397182 -0.38577179 -0.65924053  0.75123760
[1] "config_name: T_lasso_linear-only. MSE: 1.09424270628474. time_taken: 11.4489569664001"
[1] "CATE_spec: correctly-specified"
[1] 0.8685382
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.02961755
X.2  -0.07216244
X.3   .         
X.4  -0.07914286
X.5   .         
X.6   0.03371451
X.7   0.08158587
X.8   .         
X.9   .         
X.10 -0.06425903
      0.48342214
      0.25157977
[1] "beta_CATE: "
[1] 0.4834221 0.2515798
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.868538168290826; time_taken: 7.220707654953"
[1] "CATE_spec: linear"
[1] 0.8090847
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2          -0.10804268
X.3           .         
X.4          -0.06003605
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W  .         
X.1           0.36849565
X.2           .         
X.3           0.30232052
X.4          -0.20043327
X.5           0.01356016
X.6           .         
X.7           0.20322645
X.8           .         
X.9           0.02941086
X.10          0.08742278
[1] "beta_CATE: "
 [1]  0.00000000  0.36849565  0.00000000  0.30232052 -0.20043327  0.01356016
 [7]  0.00000000  0.20322645  0.00000000  0.02941086  0.08742278
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.80908466494508; time_taken: 10.1931681632996"
[1] "CATE_spec: flexible"
[1] 0.7984625
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2  -0.11802468
X.3   .         
X.4  -0.05495710
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
      .         
X.1   0.37576948
X.2   .         
X.3   0.32732872
X.4  -0.23964675
X.5   0.02955622
X.6   .         
X.7   0.20420963
X.8   .         
X.9   0.03066832
X.10  0.08658993
[1] "beta_CATE: "
 [1]  0.00000000  0.37576948  0.00000000  0.32732872 -0.23964675  0.02955622
 [7]  0.00000000  0.20420963  0.00000000  0.03066832  0.08658993
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.798462518703791; time_taken: 10.207102060318"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2          -0.022499248
X.3          -0.008391036
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.597972341
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.378361546
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.019487592
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.024515367
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.35783961
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.13061198
X.8           .         
X.9           .         
X.10          0.42072486
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   0.28203893
X.2_spline1   .         
X.2_spline2   1.11641741
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2  -1.73210669
X.3_spline3   .         
X.4_spline1  -0.18569287
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   0.69969343
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  1.61976977
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.26474826
              .         
              .         
              .         
              .         
              0.05041132
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02442771
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.09423816
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
             1
[1,] 0.9368233
[2,] 1.7063167
[3,] 1.4951244
[4,] 1.0703092
[5,] 0.5840115
[6,] 1.2654697
[1] "head(CATE_true)"
[1]  0.01246013  1.73997998  0.28397182 -0.38577179 -0.65924053  0.75123760
[1] "config_name: T_lasso_mild-complex. MSE: 1.30156372201715. time_taken: 71.39914894104"
[1] "CATE_spec: correctly-specified"
[1] 0.5369605
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.02914187
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.61102731
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1  -0.11222975
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2  -0.45450523
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   0.08229955
X.6_spline3   .         
X.7_spline1   0.08747094
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.45770464
X.10_spline2  1.17203312
X.10_spline3  .         
              .         
              .         
              0.01213714
              .         
              .         
             -0.03094581
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.15138451
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.03496383
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02940936
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.54693952
              0.44769243
[1] "beta_CATE: "
[1] 0.5469395 0.4476924
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.536960524127298; time_taken: 34.3906831741333"
[1] "CATE_spec: linear"
[1] 0.562507
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4          -0.004138986
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.516366770
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.121266665
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.300553027
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   0.045839725
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.339356032
X.10_spline2  0.918412368
X.10_spline3  .          
V41           .          
V42           .          
V43           0.020927537
V44           .          
V45           .          
V46          -0.027257614
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59          -0.115105048
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85          -0.035207797
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.486474518
X.2           .          
X.3           0.021247678
X.4           .          
X.5           .          
X.6           .          
X.7           0.150601584
X.8           .          
X.9           .          
X.10          0.323777126
[1] "beta_CATE: "
 [1] 0.00000000 0.48647452 0.00000000 0.02124768 0.00000000 0.00000000
 [7] 0.00000000 0.15060158 0.00000000 0.00000000 0.32377713
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.562506993105471; time_taken: 37.0228142738342"
[1] "CATE_spec: flexible"
[1] 0.7265519
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.35282873
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1  -0.11721925
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2  -0.16325402
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   0.20626085
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.04866035
X.10_spline2  0.99534359
X.10_spline3  .         
              .         
              .         
              0.01462555
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.44303017
X.2           .         
X.3           0.06554272
X.4           .         
X.5           .         
X.6           .         
X.7           0.13150088
X.8           .         
X.9           .         
X.10          0.36930547
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.21892407
              .         
              .         
              .         
              .         
              0.03406087
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02510753
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.11879352
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "beta_CATE: "
 [1]  0.00000000  0.44303017  0.00000000  0.06554272  0.00000000  0.00000000
 [7]  0.00000000  0.13150088  0.00000000  0.00000000  0.36930547  0.00000000
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.21892407
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.03406087  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000 -0.02510753  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000 -0.11879352  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.726551850154147; time_taken: 64.6621789932251"
Time to run lasso model: 247.743808507919 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.094243

$`S_lasso_correctly-specified_linear-only`
[1] 0.8685382

$`S_lasso_linear_linear-only`
[1] 0.8090847

$`S_lasso_flexible_linear-only`
[1] 0.7984625

$`T_lasso_mild-complex`
[1] 1.301564

$`S_lasso_correctly-specified_mild-complex`
[1] 0.5369605

$`S_lasso_linear_mild-complex`
[1] 0.562507

$`S_lasso_flexible_mild-complex`
[1] 0.7265519

Results for iteration 95 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_95-seed_1168.csv
There were 50 or more warnings (use warnings() to see the first 50)
