Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 72
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 72: 915
Loaded dataset 72 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_72_n_500.rds 
Time to load dataset: 0.0324671268463135 seconds
Loaded dataset 172 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_172_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.1742498
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 0.2632093
[1] "head(CATE_est)"
               1
[1,] -0.30782551
[2,] -0.33582462
[3,] -0.04431447
[4,] -0.12793611
[5,]  0.32160507
[6,] -0.32961507
[1] "head(CATE_true)"
[1] -1.7203095 -1.2730894  0.3331343 -0.9857143  1.4843064 -1.7227340
[1] "config_name: T_lasso_linear-only. MSE: 1.22591338046731. time_taken: 15.2542989253998"
[1] "CATE_spec: correctly-specified"
[1] 1.041297
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   .         
X.3   .         
X.4  -0.04674022
X.5   .         
X.6   .         
X.7  -0.02303028
X.8   .         
X.9   .         
X.10  .         
      0.24618445
      0.31269524
[1] "beta_CATE: "
[1] 0.2461844 0.3126952
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.04129722211229; time_taken: 9.98346447944641"
[1] "CATE_spec: linear"
[1] 1.261222
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                     1
X.1          .        
X.2          .        
X.3          .        
X.4          .        
X.5          .        
X.6          .        
X.7          .        
X.8          .        
X.9          .        
X.10         .        
train_data$W .        
X.1          0.1628061
X.2          .        
X.3          .        
X.4          .        
X.5          .        
X.6          .        
X.7          .        
X.8          .        
X.9          .        
X.10         0.2522544
[1] "beta_CATE: "
 [1] 0.0000000 0.1628061 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.2522544
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.261222467762; time_taken: 13.3676528930664"
[1] "CATE_spec: flexible"
[1] 1.244742
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     .        
X.1  0.1689726
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 0.2563734
[1] "beta_CATE: "
 [1] 0.0000000 0.1689726 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.2563734
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.24474230792789; time_taken: 13.1861550807953"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.18819709
X.1_spline2   1.24442359
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   0.01873263
X.3_spline3   .         
X.4_spline1  -0.18996746
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1  -0.68975803
X.6_spline2   0.31127418
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.09335068
X.8_spline3   1.32522706
X.9_spline1   .         
X.9_spline2  -0.43453967
X.9_spline3   .         
X.10_spline1 -0.26992995
X.10_spline2  .         
X.10_spline3  .         
              .         
              0.03458355
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.27567387
              .         
              .         
             -0.01041846
              .         
              .         
              .         
              0.15032036
              .         
              .         
              .         
              .         
              0.03274942
              .         
              .         
              .         
              0.18683009
              0.04348867
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.00667083
             -0.03133374
              .         
              .         
              .         
             -0.30081783
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06308609
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.23970647
X.2           0.14765330
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.72704319
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1  -0.88181493
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1  -0.05209157
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  1.70152163
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.10837225
              .         
              .         
              .         
              .         
              .         
              .         
             -0.00666424
              .         
             -0.39882047
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.01768209
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  0.1429089
[2,] -0.4041693
[3,]  1.1517885
[4,]  0.9981472
[5,]  1.1261207
[6,] -1.0567093
[1] "head(CATE_true)"
[1] -1.7203095 -1.2730894  0.3331343 -0.9857143  1.4843064 -1.7227340
[1] "config_name: T_lasso_mild-complex. MSE: 1.0034101978577. time_taken: 110.791928052902"
[1] "CATE_spec: correctly-specified"
[1] 0.4610136
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           0.003333787
X.6           .          
X.7          -0.010217919
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.153573093
X.1_spline2   1.078688196
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   0.290824337
X.3_spline1  -0.177289393
X.3_spline2   0.029642559
X.3_spline3   .          
X.4_spline1  -0.231990967
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1  -0.229817782
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.908041985
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  2.055829378
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.135939877
              .          
             -0.150657299
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.089395042
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.048926877
              .          
             -0.063576287
              .          
              .          
              .          
              .          
              .          
              .          
             -0.003124312
              .          
              .          
              .          
              0.424083626
              0.642874176
[1] "beta_CATE: "
[1] 0.4240836 0.6428742
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.461013621125703; time_taken: 67.4991750717163"
[1] "CATE_spec: linear"
[1] 0.4862665
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7          -0.010676769
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.180324906
X.1_spline2   0.801839049
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   0.101132741
X.3_spline1  -0.308334696
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1  -0.185693212
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1  -0.153567535
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.599532687
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  1.736425186
X.10_spline3  .          
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57          -0.129402758
V58           .          
V59          -0.127359414
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           0.054675600
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83          -0.001986415
V84           .          
V85          -0.079303951
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  0.066275553
X.1           0.379450579
X.2           0.054387121
X.3           .          
X.4           .          
X.5           0.002228340
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.598414590
[1] "beta_CATE: "
 [1] 0.06627555 0.37945058 0.05438712 0.00000000 0.00000000 0.00222834
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.59841459
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.486266522366594; time_taken: 67.7012436389923"
[1] "CATE_spec: flexible"
[1] 0.6412627
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.64225226
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1  -0.43395412
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1  -0.16192885
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1  -0.17687144
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.15349820
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  0.26034874
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.05037112
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.34136783
X.2           0.06294933
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.66575448
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  0.42632336
X.10_spline3  .         
              .         
              0.01437726
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.12900371
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.35243446
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02269749
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.04735248
              .         
              .         
              .         
[1] "beta_CATE: "
 [1]  0.00000000  0.34136783  0.06294933  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.00000000  0.66575448  0.00000000
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.42632336  0.00000000  0.00000000
[43]  0.01437726  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000 -0.12900371  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.35243446
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.02269749  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000 -0.04735248  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.641262683544965; time_taken: 104.141290903091"
Time to run lasso model: 403.738506793976 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.225913

$`S_lasso_correctly-specified_linear-only`
[1] 1.041297

$`S_lasso_linear_linear-only`
[1] 1.261222

$`S_lasso_flexible_linear-only`
[1] 1.244742

$`T_lasso_mild-complex`
[1] 1.00341

$`S_lasso_correctly-specified_mild-complex`
[1] 0.4610136

$`S_lasso_linear_mild-complex`
[1] 0.4862665

$`S_lasso_flexible_mild-complex`
[1] 0.6412627

Results for iteration 72 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_72-seed_915.csv
There were 50 or more warnings (use warnings() to see the first 50)
