Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 4
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 4: 167
Loaded dataset 4 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_4_n_500.rds 
Time to load dataset: 0.0441334247589111 seconds
Loaded dataset 104 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_104_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   .        
X.2  -0.1432485
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   .        
X.10  .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.3785244
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 0.2297581
[1] "head(CATE_est)"
                 1
[1,]  4.044166e-01
[2,] -8.587349e-01
[3,]  1.175904e-01
[4,]  9.291341e-01
[5,]  1.386946e+00
[6,]  7.457581e-05
[1] "head(CATE_true)"
[1]  2.0200572 -2.7427775  0.2399709  2.3475807  3.1552642  0.2738804
[1] "config_name: T_lasso_linear-only. MSE: 0.865451142863795. time_taken: 12.8141906261444"
[1] "CATE_spec: correctly-specified"
[1] 0.7576571
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   .          
X.2  -0.159393078
X.3  -0.001081543
X.4   .          
X.5  -0.003598950
X.6  -0.002248128
X.7   .          
X.8   .          
X.9   .          
X.10  .          
      0.564071956
      0.270192019
[1] "beta_CATE: "
[1] 0.564072 0.270192
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.757657122996165; time_taken: 8.73845672607422"
[1] "CATE_spec: linear"
[1] 0.8675671
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           .        
X.2          -0.0834530
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           .        
X.10          .        
train_data$W -0.1291232
X.1           0.5014984
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           0.0069892
X.9           .        
X.10          0.2533388
[1] "beta_CATE: "
 [1] -0.1291232  0.5014984  0.0000000  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.0000000  0.0069892  0.0000000  0.2533388
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.867567065752835; time_taken: 10.6523909568787"
[1] "CATE_spec: flexible"
[1] 0.8458556
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2  -0.09442582
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.13170553
X.1   0.51696212
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   0.01022137
X.9   .         
X.10  0.25323837
[1] "beta_CATE: "
 [1] -0.13170553  0.51696212  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.01022137  0.00000000  0.25323837
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.845855551789611; time_taken: 10.4305262565613"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              0.046551480
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.005986184
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.017108415
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.405188364
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.013446769
X.9           .          
X.10          0.432636711
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   0.007885216
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              0.003635951
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.405301362
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
               1
[1,]  1.45712381
[2,] -1.85108006
[3,]  0.08583023
[4,]  0.39692630
[5,]  0.23682698
[6,]  0.28729932
[1] "head(CATE_true)"
[1]  2.0200572 -2.7427775  0.2399709  2.3475807  3.1552642  0.2738804
[1] "config_name: T_lasso_mild-complex. MSE: 0.996920554015118. time_taken: 73.6625430583954"
[1] "CATE_spec: correctly-specified"
[1] 0.4724015
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2          -0.0722644750
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7          -0.0007861747
X.8           .           
X.9          -0.0116099423
X.10          .           
X.1_spline1  -0.0443653572
X.1_spline2   0.6708073316
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2  -0.2838094730
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1  -0.0933674745
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3  -0.5470351029
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3  -0.1196560699
X.8_spline1   .           
X.8_spline2  -0.7392243395
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3 -0.4333694642
              .           
              0.0037325768
              .           
              0.0343165194
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.2092746662
              .           
              0.0224626819
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0087109715
              .           
              .           
              .           
              .           
              .           
             -0.0318865754
              .           
              .           
              .           
              .           
              .           
              .           
              0.5731754041
              0.4923236672
[1] "beta_CATE: "
[1] 0.5731754 0.4923237
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.472401539494439; time_taken: 31.8222708702087"
[1] "CATE_spec: linear"
[1] 0.5191613
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2          -0.04264331
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.04105436
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.04976938
X.1_spline2   0.31835629
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2  -0.04917787
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1  -0.05953896
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3  -0.50800185
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3  -0.02553317
X.8_spline1   .         
X.8_spline2  -0.55045958
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3  -0.04535338
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3 -0.29396934
V41           .         
V42           0.01245130
V43           .         
V44           0.01688046
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59          -0.19613149
V60           .         
V61           0.03079868
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89          -0.02993843
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W -0.08117633
X.1           0.53138835
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.07957702
X.9           .         
X.10          0.42200737
[1] "beta_CATE: "
 [1] -0.08117633  0.53138835  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.07957702  0.00000000  0.42200737
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.519161269218228; time_taken: 31.1938638687134"
[1] "CATE_spec: flexible"
[1] 1.019498
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1  -0.092353395
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   0.109821346
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              0.017518048
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.009242558
              .          
              .          
              .          
              0.045131809
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.014080811
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.435085180
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.486602699
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   0.102190393
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.154366104
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.415641347
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
             -0.059063301
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.512098891
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.014372454
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.00000000  0.43508518  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.00000000  0.48660270  0.00000000
[13]  0.00000000  0.10219039  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.15436610
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.41564135  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000  0.00000000 -0.05906330  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.51209889
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.01437245  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 1.01949825009936; time_taken: 64.0931670665741"
Time to run lasso model: 244.861803293228 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.8654511

$`S_lasso_correctly-specified_linear-only`
[1] 0.7576571

$`S_lasso_linear_linear-only`
[1] 0.8675671

$`S_lasso_flexible_linear-only`
[1] 0.8458556

$`T_lasso_mild-complex`
[1] 0.9969206

$`S_lasso_correctly-specified_mild-complex`
[1] 0.4724015

$`S_lasso_linear_mild-complex`
[1] 0.5191613

$`S_lasso_flexible_mild-complex`
[1] 1.019498

Results for iteration 4 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_4-seed_167.csv
There were 50 or more warnings (use warnings() to see the first 50)
