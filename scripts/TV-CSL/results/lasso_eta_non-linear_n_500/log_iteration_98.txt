Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 98
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 98: 1201
Loaded dataset 98 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_98_n_500.rds 
Time to load dataset: 0.0457472801208496 seconds
Loaded dataset 198 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_198_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.39076685
X.2   .         
X.3  -0.08678818
X.4  -0.06358895
X.5   .         
X.6  -0.03351829
X.7   .         
X.8   .         
X.9   0.08341920
X.10  0.27718128
[1] "head(CATE_est)"
              1
[1,]  0.2824866
[2,] -0.2851802
[3,]  0.3720738
[4,] -0.1702546
[5,] -0.3068881
[6,]  0.3544725
[1] "head(CATE_true)"
[1]  0.7702408 -0.6920386  1.2064106 -0.5665445 -1.6131530  1.7575708
[1] "config_name: T_lasso_linear-only. MSE: 1.08378645892353. time_taken: 11.0467393398285"
[1] "CATE_spec: correctly-specified"
[1] 1.146051
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.2324308
     0.2920320
[1] "beta_CATE: "
[1] 0.2324308 0.2920320
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.14605126166809; time_taken: 6.97060823440552"
[1] "CATE_spec: linear"
[1] 1.156059
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.22397260
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          0.03012096
X.10         0.26392264
[1] "beta_CATE: "
 [1] 0.00000000 0.22397260 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.03012096 0.26392264
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.15605898031858; time_taken: 10.0330562591553"
[1] "CATE_spec: flexible"
[1] 1.052029
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.05827474
X.1   0.36796889
X.2   .         
X.3  -0.05859034
X.4  -0.06762719
X.5   .         
X.6  -0.01780677
X.7   .         
X.8   .         
X.9   0.06473920
X.10  0.29758772
[1] "beta_CATE: "
 [1] -0.05827474  0.36796889  0.00000000 -0.05859034 -0.06762719  0.00000000
 [7] -0.01780677  0.00000000  0.00000000  0.06473920  0.29758772
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.0520294447159; time_taken: 9.9009256362915"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           1.0385011041
X.2           .           
X.3           .           
X.4           .           
X.5           0.0843984318
X.6           .           
X.7           0.0959964361
X.8           .           
X.9           .           
X.10          0.9084493664
X.1_spline1  -1.2494669094
X.1_spline2   .           
X.1_spline3   0.2180509999
X.2_spline1  -0.8326221608
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1  -0.2780736643
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1  -0.6571824754
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   0.1719343598
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   0.5417739382
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1 -0.8490580276
X.10_spline2  4.3231880126
X.10_spline3  0.0001646152
              .           
              .           
             -0.0169413163
              .           
              .           
              .           
             -0.0761036816
              0.1209550594
              .           
              0.0119173678
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.2544186356
             -0.4352185112
              .           
              .           
              0.0727536826
              .           
              .           
              0.0291832212
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.1211095038
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0707242633
              .           
              .           
              .           
              .           
[1] "head(CATE_est)"
             1
[1,] 1.8167063
[2,] 1.2060107
[3,] 1.2046709
[4,] 1.6297950
[5,] 0.7604172
[6,] 2.0951890
[1] "head(CATE_true)"
[1]  0.7702408 -0.6920386  1.2064106 -0.5665445 -1.6131530  1.7575708
[1] "config_name: T_lasso_mild-complex. MSE: 3.09748750478923. time_taken: 80.0562791824341"
[1] "CATE_spec: correctly-specified"
[1] 0.3114336
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.61865962
X.1_spline2   0.33453229
X.1_spline3   0.15042729
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   0.85521341
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1  -0.16479304
X.6_spline2   0.28651138
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.11012711
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.59430183
X.10_spline2  0.38625341
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.01836670
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02107946
             -0.18844381
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.01602904
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.60759046
              0.62274298
[1] "beta_CATE: "
[1] 0.6075905 0.6227430
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.311433619792508; time_taken: 41.054655790329"
[1] "CATE_spec: linear"
[1] 0.2990532
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1  -0.6378778640
X.1_spline2   0.3836082306
X.1_spline3   0.2679547224
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   0.9139761451
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1  -0.1811470597
X.6_spline2   0.2864165917
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2  -0.1702000717
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3  -0.0189562599
X.10_spline1 -0.6405825297
X.10_spline2  0.3527147568
X.10_spline3  .           
V41           .           
V42           .           
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           0.0001920233
V49          -0.0253653986
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57           .           
V58          -0.0364341561
V59          -0.1868854905
V60           .           
V61           .           
V62           .           
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           0.0229809641
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W  .           
X.1           0.6005214919
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           0.0552890278
X.10          0.5907320717
[1] "beta_CATE: "
 [1] 0.00000000 0.60052149 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.05528903 0.59073207
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.299053245989021; time_taken: 41.5060496330261"
[1] "CATE_spec: flexible"
[1] 0.5602869
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.326861169
X.1_spline2   0.642044251
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   0.915935176
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1  -0.243100736
X.6_spline2   0.271734502
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   0.431261558
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.341934589
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.010821280
X.10_spline2  0.001658092
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.021394377
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.028955927
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.039235828
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.678253783
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.049665174
X.8           .          
X.9           0.094315288
X.10          0.800424990
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.487507038
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -1.247629547
X.10_spline2  0.505367387
X.10_spline3  .          
              0.090915445
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.190112104
             -0.279371709
              .          
              .          
              0.072857580
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.030135136
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.011801564
              .          
              .          
              .          
             -0.104151038
[1] "beta_CATE: "
 [1]  0.00000000  0.67825378  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.04966517  0.00000000  0.09431529  0.80042499  0.00000000
[13]  0.00000000  0.00000000 -0.48750704  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000 -1.24762955  0.50536739  0.00000000  0.09091544
[43]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000 -0.19011210 -0.27937171
[61]  0.00000000  0.00000000  0.07285758  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.03013514  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000 -0.01180156  0.00000000  0.00000000  0.00000000 -0.10415104
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.560286913129268; time_taken: 73.1043658256531"
Time to run lasso model: 274.854966402054 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.083786

$`S_lasso_correctly-specified_linear-only`
[1] 1.146051

$`S_lasso_linear_linear-only`
[1] 1.156059

$`S_lasso_flexible_linear-only`
[1] 1.052029

$`T_lasso_mild-complex`
[1] 3.097488

$`S_lasso_correctly-specified_mild-complex`
[1] 0.3114336

$`S_lasso_linear_mild-complex`
[1] 0.2990532

$`S_lasso_flexible_mild-complex`
[1] 0.5602869

Results for iteration 98 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_98-seed_1201.csv
There were 50 or more warnings (use warnings() to see the first 50)
