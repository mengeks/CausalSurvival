Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 25
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 25: 398
Loaded dataset 25 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_25_n_500.rds 
Time to load dataset: 0.0604097843170166 seconds
Loaded dataset 125 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_125_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.26872033
X.2   .         
X.3   0.06695678
X.4   .         
X.5   .         
X.6   .         
X.7  -0.11331224
X.8   0.14554937
X.9   .         
X.10  0.18534684
[1] "head(CATE_est)"
              1
[1,] -1.0406573
[2,]  0.3348530
[3,] -0.1828518
[4,] -0.2615807
[5,]  0.7415306
[6,]  0.3567823
[1] "head(CATE_true)"
[1] -3.5801396  1.2676249 -0.9433558 -1.2527577  2.4895601  1.3815814
[1] "config_name: T_lasso_linear-only. MSE: 1.2350407621914. time_taken: 19.3378939628601"
[1] "CATE_spec: correctly-specified"
[1] 1.287412
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7  -0.02726558
X.8   .         
X.9   .         
X.10  .         
      0.25648893
      0.25965003
[1] "beta_CATE: "
[1] 0.2564889 0.2596500
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.28741211184849; time_taken: 13.574503660202"
[1] "CATE_spec: linear"
[1] 1.099725
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.09429754
X.8           .         
X.9           .         
X.10          .         
train_data$W -0.01527938
X.1           0.25047136
X.2           .         
X.3           0.05841532
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.12443696
X.9           .         
X.10          0.20519392
[1] "beta_CATE: "
 [1] -0.01527938  0.25047136  0.00000000  0.05841532  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.12443696  0.00000000  0.20519392
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.09972466415349; time_taken: 14.6714580059052"
[1] "CATE_spec: flexible"
[1] 1.439435
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.19596095
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.04613647
X.9  .         
X.10 0.19206253
[1] "beta_CATE: "
 [1] 0.00000000 0.19596095 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.04613647 0.00000000 0.19206253
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.43943476120523; time_taken: 14.9326281547546"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.6492568007
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.7414249784
X.1_spline1  -0.9637543736
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1  -0.0225020759
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1  -0.0494009548
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2  -0.2307514884
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1  -0.1738161505
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   0.2978090489
X.9_spline1   .           
X.9_spline2  -1.8119319771
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  4.9134740459
X.10_spline3  .           
              .           
              .           
              .           
              .           
             -0.0732356654
              .           
              .           
              .           
              0.0029453970
              .           
              .           
              0.0002044737
              .           
              .           
              .           
             -0.1623330653
              .           
             -0.1412047943
             -0.3906210068
              .           
              .           
              .           
              .           
             -0.0255604538
              .           
              .           
              .           
              .           
              0.0277577571
              0.1799710961
              .           
              .           
              .           
              0.0498364140
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "head(CATE_est)"
               1
[1,] -2.87671742
[2,]  1.15278982
[3,]  0.36985967
[4,] -0.04698409
[5,]  1.78673416
[6,]  0.97696075
[1] "head(CATE_true)"
[1] -3.5801396  1.2676249 -0.9433558 -1.2527577  2.4895601  1.3815814
[1] "config_name: T_lasso_mild-complex. MSE: 1.61854573660344. time_taken: 122.367486953735"
[1] "CATE_spec: correctly-specified"
[1] 0.5718081
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7          -0.0225302111
X.8           .           
X.9           .           
X.10         -0.0122009908
X.1_spline1   .           
X.1_spline2   1.3646173986
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   0.0967370304
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1  -0.2324180179
X.7_spline2   0.0172182980
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2  -0.7222568777
X.9_spline3   .           
X.10_spline1 -0.6665941321
X.10_spline2  0.6628858473
X.10_spline3 -0.8913573327
              .           
              .           
              .           
              .           
             -0.0619679815
              .           
              .           
              .           
              .           
              .           
              .           
              0.2387465486
              .           
              .           
              .           
              .           
              .           
             -0.1346499266
             -0.1705509807
              .           
              .           
              .           
             -0.0027326151
             -0.0380021596
              .           
             -0.0036028777
              .           
              .           
              0.0340347650
              0.0052818876
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0007912042
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.3491920914
              0.7489684250
[1] "beta_CATE: "
[1] 0.3491921 0.7489684
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.571808142164661; time_taken: 62.9447464942932"
[1] "CATE_spec: linear"
[1] 0.6799148
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7          -0.08235398
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.65534498
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1  -0.12707533
X.7_spline2   .         
X.7_spline3  -0.05252681
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.31481937
X.10_spline2  0.68980192
X.10_spline3 -0.32920573
V41           .         
V42           .         
V43           .         
V44           .         
V45          -0.03511244
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           0.18376097
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58          -0.17728417
V59          -0.06253975
V60           .         
V61           .         
V62           .         
V63           .         
V64          -0.03547981
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.29533317
X.2           .         
X.3           .         
X.4           0.01423203
X.5           .         
X.6           .         
X.7           .         
X.8           0.23225161
X.9           .         
X.10          0.44288128
[1] "beta_CATE: "
 [1] 0.00000000 0.29533317 0.00000000 0.00000000 0.01423203 0.00000000
 [7] 0.00000000 0.00000000 0.23225161 0.00000000 0.44288128
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.679914769023875; time_taken: 63.7126207351685"
[1] "CATE_spec: flexible"
[1] 0.764532
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7          -0.0740772731
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   0.7829895582
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1  -0.3729260316
X.7_spline2   0.1063337717
X.7_spline3  -0.1257259759
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2  -0.7723854329
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  0.8792746889
X.10_spline3  .           
              .           
              .           
              .           
              .           
             -0.0508065940
              .           
              .           
              .           
              0.0272793517
              .           
              .           
              0.1925329606
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.1088918140
             -0.0365714621
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.4799986079
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.1685801034
X.9           .           
X.10          0.8749927976
X.1_spline1  -0.4113925646
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   0.1412068925
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1 -0.9662751226
X.10_spline2  0.5107683022
X.10_spline3  .           
              .           
              .           
              .           
              .           
             -0.0123635909
              .           
              .           
              .           
              0.0121717168
             -0.1187909332
              .           
              .           
              .           
              .           
              .           
             -0.0829501654
              .           
             -0.1742787075
             -0.4667160217
              .           
             -0.0184466133
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0344272613
              0.2320010316
              .           
              0.0007165808
              .           
              0.0488445111
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0187891038
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1]  0.0000000000  0.4799986079  0.0000000000  0.0000000000  0.0000000000
 [6]  0.0000000000  0.0000000000  0.0000000000  0.1685801034  0.0000000000
[11]  0.8749927976 -0.4113925646  0.0000000000  0.0000000000  0.0000000000
[16]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[21]  0.0000000000  0.0000000000  0.0000000000  0.1412068925  0.0000000000
[26]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[31]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[36]  0.0000000000  0.0000000000  0.0000000000 -0.9662751226  0.5107683022
[41]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[46] -0.0123635909  0.0000000000  0.0000000000  0.0000000000  0.0121717168
[51] -0.1187909332  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[56]  0.0000000000 -0.0829501654  0.0000000000 -0.1742787075 -0.4667160217
[61]  0.0000000000 -0.0184466133  0.0000000000  0.0000000000  0.0000000000
[66]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0344272613
[71]  0.2320010316  0.0000000000  0.0007165808  0.0000000000  0.0488445111
[76]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[81]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[86]  0.0000000000  0.0000000000  0.0000000000  0.0000000000 -0.0187891038
[91]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[96]  0.0000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.764531956122435; time_taken: 104.612118244171"
Time to run lasso model: 418.202408790588 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.235041

$`S_lasso_correctly-specified_linear-only`
[1] 1.287412

$`S_lasso_linear_linear-only`
[1] 1.099725

$`S_lasso_flexible_linear-only`
[1] 1.439435

$`T_lasso_mild-complex`
[1] 1.618546

$`S_lasso_correctly-specified_mild-complex`
[1] 0.5718081

$`S_lasso_linear_mild-complex`
[1] 0.6799148

$`S_lasso_flexible_mild-complex`
[1] 0.764532

Results for iteration 25 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_25-seed_398.csv
There were 50 or more warnings (use warnings() to see the first 50)
