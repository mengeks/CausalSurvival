Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 67
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 67: 860
Loaded dataset 67 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_67_n_500.rds 
Time to load dataset: 0.0434927940368652 seconds
Loaded dataset 167 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_167_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  -0.04423624
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   0.19640092
X.7   .         
X.8   .         
X.9   .         
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.13993764
X.2  0.04830615
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.20979591
X.10 .         
[1] "head(CATE_est)"
               1
[1,] -0.24366005
[2,] -0.30749735
[3,]  0.01172908
[4,] -0.44647417
[5,]  0.41519356
[6,]  0.02851162
[1] "head(CATE_true)"
[1] -1.14459137 -2.13885164 -0.05614131 -1.95037572  2.60205672 -1.73225208
[1] "config_name: T_lasso_linear-only. MSE: 1.69868030036737. time_taken: 28.4973361492157"
[1] "CATE_spec: correctly-specified"
[1] 1.320385
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1  -0.130472110
X.2   .          
X.3   .          
X.4  -0.007486232
X.5   .          
X.6   .          
X.7   0.095692320
X.8   .          
X.9   .          
X.10  .          
      0.290835184
      0.160012166
[1] "beta_CATE: "
[1] 0.2908352 0.1600122
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.32038528411019; time_taken: 18.9622011184692"
[1] "CATE_spec: linear"
[1] 1.571349
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.047339478
X.8           .          
X.9           .          
X.10          0.009645958
train_data$W -0.168607162
X.1           0.123722848
X.2           0.037290018
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.181073867
X.10          .          
[1] "beta_CATE: "
 [1] -0.16860716  0.12372285  0.03729002  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.18107387  0.00000000
[1] "config_name: S_lasso_linear_linear-only; MSE: 1.5713486139021; time_taken: 24.5767357349396"
[1] "CATE_spec: flexible"
[1] 1.4646
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1  -0.068347234
X.2   .          
X.3   .          
X.4   .          
X.5   .          
X.6   .          
X.7   0.114565253
X.8   .          
X.9   .          
X.10  .          
     -0.241075603
X.1   0.227887608
X.2   0.088660140
X.3   .          
X.4   .          
X.5   .          
X.6  -0.109328465
X.7   .          
X.8   .          
X.9   0.207809951
X.10  0.009332228
[1] "beta_CATE: "
 [1] -0.241075603  0.227887608  0.088660140  0.000000000  0.000000000
 [6]  0.000000000 -0.109328465  0.000000000  0.000000000  0.207809951
[11]  0.009332228
[1] "config_name: S_lasso_flexible_linear-only; MSE: 1.46460041740864; time_taken: 23.6869885921478"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.007731771
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.032642314
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.050343319
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.503540480
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.188915768
X.8           .          
X.9           0.272396045
X.10          0.422979842
X.1_spline1  -0.801014096
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.207085359
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1  -0.399010119
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.100049977
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   1.245580086
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.449839397
X.10_spline2  2.796934177
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
             -0.077675530
              .          
              .          
             -0.057702412
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.003188775
             -0.443861077
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.052091220
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
             1
[1,] 1.4669004
[2,] 0.3733728
[3,] 1.7508924
[4,] 1.2550533
[5,] 1.8216109
[6,] 0.8901655
[1] "head(CATE_true)"
[1] -1.14459137 -2.13885164 -0.05614131 -1.95037572  2.60205672 -1.73225208
[1] "config_name: T_lasso_mild-complex. MSE: 3.2864335414015. time_taken: 180.21554684639"
[1] "CATE_spec: correctly-specified"
[1] 0.7475492
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.08124293
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.81162797
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2  -0.66848469
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1  -0.01149354
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  2.34572277
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
             -0.04013040
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.02885459
              .         
              .         
              .         
             -0.28049768
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.40099684
              0.43350131
[1] "beta_CATE: "
[1] 0.4009968 0.4335013
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.747549198468138; time_taken: 98.4784388542175"
[1] "CATE_spec: linear"
[1] 0.6234534
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.833905073
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2  -0.722063098
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1  -0.023551858
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   0.001166220
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  2.280803729
X.10_spline3  .          
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46          -0.054995400
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55          -0.052890345
V56           .          
V57           .          
V58           .          
V59          -0.286244585
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W -0.017413686
X.1           0.408512786
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.094151268
X.8           0.005589905
X.9           0.238910803
X.10          0.214600938
[1] "beta_CATE: "
 [1] -0.017413686  0.408512786  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.094151268  0.005589905  0.238910803
[11]  0.214600938
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.623453352981144; time_taken: 99.3653678894043"
[1] "CATE_spec: flexible"
[1] 1.206607
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.052991766
X.8           .          
X.9           .          
X.10          .          
X.1_spline1  -0.211997500
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2  -0.573522510
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  1.313395745
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
             -0.051038904
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.120845363
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.088940304
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.010594269
X.9           0.243997792
X.10          0.199956903
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   0.826094106
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.012003828
              .          
              0.001249992
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.238749434
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.003890485
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.088940304  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.010594269  0.243997792
[11]  0.199956903  0.000000000  0.000000000  0.826094106  0.000000000
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000  0.000000000 -0.012003828
[51]  0.000000000  0.001249992  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000 -0.238749434
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.003890485  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 1.20660658082381; time_taken: 163.238723278046"
Time to run lasso model: 640.739218950272 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 1.69868

$`S_lasso_correctly-specified_linear-only`
[1] 1.320385

$`S_lasso_linear_linear-only`
[1] 1.571349

$`S_lasso_flexible_linear-only`
[1] 1.4646

$`T_lasso_mild-complex`
[1] 3.286434

$`S_lasso_correctly-specified_mild-complex`
[1] 0.7475492

$`S_lasso_linear_mild-complex`
[1] 0.6234534

$`S_lasso_flexible_mild-complex`
[1] 1.206607

Results for iteration 67 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_67-seed_860.csv
There were 50 or more warnings (use warnings() to see the first 50)
