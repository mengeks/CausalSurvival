Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 62
Configuration Parameters:
n: 500
R: 100
eta_type: non-linear
CATE_type: linear
Seed value for iteration 62: 805
Loaded dataset 62 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_62_n_500.rds 
Time to load dataset: 0.0651824474334717 seconds
Loaded dataset 162 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data/non-linear_linear/sim_data_162_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.41016275
X.2  .         
X.3  .         
X.4  .         
X.5  0.08982348
X.6  0.02753222
X.7  .         
X.8  .         
X.9  .         
X.10 0.18346667
[1] "head(CATE_est)"
               1
[1,] -0.02808445
[2,] -0.03968628
[3,]  0.00435905
[4,] -0.03265477
[5,] -0.37922745
[6,] -0.03485927
[1] "head(CATE_true)"
[1]  0.36663185 -0.35537048  0.22697972  0.22178512 -0.93487495 -0.08425871
[1] "config_name: T_lasso_linear-only. MSE: 0.939623857950068. time_taken: 16.8145470619202"
[1] "CATE_spec: correctly-specified"
[1] 1.072137
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.4012716
     0.2134672
[1] "beta_CATE: "
[1] 0.4012716 0.2134672
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 1.07213707637907; time_taken: 11.389365196228"
[1] "CATE_spec: linear"
[1] 0.9885133
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W -0.17480151
X.1           0.40015602
X.2           .         
X.3           .         
X.4           .         
X.5           0.07518295
X.6           0.03623035
X.7           .         
X.8           .         
X.9           .         
X.10          0.18701574
[1] "beta_CATE: "
 [1] -0.17480151  0.40015602  0.00000000  0.00000000  0.00000000  0.07518295
 [7]  0.03623035  0.00000000  0.00000000  0.00000000  0.18701574
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.98851327799057; time_taken: 15.495210647583"
[1] "CATE_spec: flexible"
[1] 0.9885133
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.17480151
X.1   0.40015602
X.2   .         
X.3   .         
X.4   .         
X.5   0.07518295
X.6   0.03623035
X.7   .         
X.8   .         
X.9   .         
X.10  0.18701574
[1] "beta_CATE: "
 [1] -0.17480151  0.40015602  0.00000000  0.00000000  0.00000000  0.07518295
 [7]  0.03623035  0.00000000  0.00000000  0.00000000  0.18701574
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.98851327799057; time_taken: 15.3941037654877"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.583217457
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.671684388
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              0.108736429
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.102452977
             -0.082416905
             -0.037916465
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.005659755
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.658446701
X.2           .          
X.3           .          
X.4           .          
X.5           0.053947418
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.505393736
X.1_spline1  -0.640017065
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1  -0.240318987
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.196656005
X.4_spline3   .          
X.5_spline1   0.335596310
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.275703867
X.6_spline2  -0.716723794
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  2.725082063
X.10_spline3  .          
              0.005525089
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.037597678
              .          
              .          
              .          
              .          
              .          
              .          
             -0.157957541
              .          
             -0.175848250
              .          
              .          
             -0.014857738
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
            1
[1,] 1.360195
[2,] 1.413903
[3,] 1.310418
[4,] 1.181625
[5,] 1.096667
[6,] 1.369218
[1] "head(CATE_true)"
[1]  0.36663185 -0.35537048  0.22697972  0.22178512 -0.93487495 -0.08425871
[1] "config_name: T_lasso_mild-complex. MSE: 2.0971107810536. time_taken: 118.263631105423"
[1] "CATE_spec: correctly-specified"
[1] 0.378733
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3          -0.10460317
X.4          -0.04221113
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.44485678
X.1_spline2   1.14380668
X.1_spline3   .         
X.2_spline1  -0.35208399
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -0.69617748
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -1.37630970
X.5_spline3   .         
X.6_spline1   0.29059573
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2  -1.35854652
X.7_spline3   .         
X.8_spline1  -0.11726738
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  2.30158741
X.10_spline3  .         
              0.02485830
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.01945258
              .         
              .         
              .         
              .         
             -0.21499904
             -0.02765567
             -0.11001843
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.73478958
              0.47159899
[1] "beta_CATE: "
[1] 0.7347896 0.4715990
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.378733005298994; time_taken: 50.9934470653534"
[1] "CATE_spec: linear"
[1] 0.4705746
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3          -0.07623033
X.4          -0.02167448
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1  -0.30294648
X.1_spline2   1.15338551
X.1_spline3   .         
X.2_spline1  -0.25880717
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -0.53610547
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -1.40888350
X.5_spline3   .         
X.6_spline1   0.23397737
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2  -1.21841099
X.7_spline3   .         
X.8_spline1  -0.06204037
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  2.19349554
X.10_spline3  .         
V41           0.03595479
V42           .         
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           0.02326811
V53           .         
V54           .         
V55           .         
V56           .         
V57          -0.20077066
V58          -0.02917970
V59          -0.10016064
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W -0.12755330
X.1           0.66576219
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.45014814
[1] "beta_CATE: "
 [1] -0.1275533  0.6657622  0.0000000  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.0000000  0.4501481
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.47057458534718; time_taken: 51.6240775585175"
[1] "CATE_spec: flexible"
[1] 0.9173701
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.18557528
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.78140519
X.5_spline3   .         
X.6_spline1   0.07400777
X.6_spline2  -0.08421777
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2  -0.16995047
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  0.42483936
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.10189303
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.36520071
X.2           .         
X.3           .         
X.4           .         
X.5           0.05142267
X.6           0.04216482
X.7           .         
X.8           .         
X.9           .         
X.10          0.26606803
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   0.66675178
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.12422321
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.11762266
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "beta_CATE: "
 [1]  0.00000000  0.36520071  0.00000000  0.00000000  0.00000000  0.05142267
 [7]  0.04216482  0.00000000  0.00000000  0.00000000  0.26606803  0.00000000
[13]  0.00000000  0.66675178  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000 -0.12422321  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000 -0.11762266
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.917370138837863; time_taken: 100.037238836288"
Time to run lasso model: 382.10333609581 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.9396239

$`S_lasso_correctly-specified_linear-only`
[1] 1.072137

$`S_lasso_linear_linear-only`
[1] 0.9885133

$`S_lasso_flexible_linear-only`
[1] 0.9885133

$`T_lasso_mild-complex`
[1] 2.097111

$`S_lasso_correctly-specified_mild-complex`
[1] 0.378733

$`S_lasso_linear_mild-complex`
[1] 0.4705746

$`S_lasso_flexible_mild-complex`
[1] 0.9173701

Results for iteration 62 saved to scripts/TV-CSL/results/non-linear_linear-n_500-iteration_62-seed_805.csv
There were 50 or more warnings (use warnings() to see the first 50)
