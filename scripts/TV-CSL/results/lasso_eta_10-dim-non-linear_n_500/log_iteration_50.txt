Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 50
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 50: 673
Loaded dataset 50 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_50_n_500.rds 
Time to load dataset: 0.00385808944702148 seconds
Loaded dataset 150 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_150_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.18971146
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10 -0.03108967
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.78870644
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.12226158
X.8  .         
X.9  0.07524856
X.10 0.76279127
[1] "head(CATE_est)"
              1
[1,]  0.3822342
[2,] -0.2497073
[3,]  1.0504431
[4,] -0.3376150
[5,]  0.7368155
[6,]  0.6906364
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] "config_name: T_lasso_linear-only. MSE: 0.139944778141458. time_taken: 24.3387770652771"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.2805406 -0.2904868  1.0171889 -0.3099496  0.7662015  0.4009033
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.2589588
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.27045114
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.05522567
X.8  .         
X.9  .         
X.10 .         
     0.52852168
     0.87349975
[1] "beta_CATE: "
[1] 0.5285217 0.8734998
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.258958781953732; time_taken: 14.070955991745"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.3533520 -0.2039335  1.0051755 -0.3533877  0.8042720  0.5155387
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.2276591
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.28090983
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.49829179
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          0.12563471
X.8          .         
X.9          0.07038196
X.10         0.77612558
[1] "beta_CATE: "
 [1] 0.00000000 0.49829179 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.12563471 0.00000000 0.07038196 0.77612558
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.227659057795205; time_taken: 17.9301581382751"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.3508435 -0.2035323  0.9964226 -0.3486696  0.7930532  0.5172048
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.2318385
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.27413841
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.49713042
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.12434708
X.8  .         
X.9  0.06913164
X.10 0.76912350
[1] "beta_CATE: "
 [1] 0.00000000 0.49713042 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.12434708 0.00000000 0.06913164 0.76912350
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.231838499322939; time_taken: 18.1593790054321"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.021025235
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.080946601
              .          
             -0.063133675
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.007958753
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.705482498
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.056878956
X.8           .          
X.9           .          
X.10          0.669909090
X.1_spline1   0.140291514
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1  -0.020891234
X.8_spline2   .          
X.8_spline3   0.283312324
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.541737194
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.095405628
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.007731394
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.024164789
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.013518963
              .          
[1] "head(CATE_est)"
              1
[1,]  0.1630648
[2,] -0.5770376
[3,]  0.7929803
[4,] -0.4575076
[5,]  0.2694836
[6,]  0.8148628
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] "config_name: T_lasso_mild-complex. MSE: 0.148135672121089. time_taken: 124.159124612808"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.2516540 -0.2729668  0.8459317 -0.2251660  0.5338694  0.4962460
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.3620045
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.21431386
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  0.05678476
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  0.63103308
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.06598945
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.00159928
             .         
             0.51821864
             0.70735953
[1] "beta_CATE: "
[1] 0.5182186 0.7073595
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.362004535907727; time_taken: 55.8205170631409"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.3069103 -0.2010474  0.8411208 -0.2347990  0.5720384  0.5669443
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.3300835
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.224624442
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  0.518620979
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
V41          .          
V42          .          
V43          .          
V44          .          
V45          .          
V46          .          
V47          .          
V48          .          
V49          .          
V50          .          
V51          .          
V52          .          
V53          .          
V54          .          
V55          .          
V56          .          
V57          .          
V58          .          
V59          .          
V60          .          
V61          .          
V62          .          
V63          .          
V64          .          
V65          .          
V66          .          
V67          .          
V68          .          
V69          .          
V70          .          
V71          .          
V72          .          
V73          .          
V74          .          
V75          .          
V76          .          
V77          .          
V78          .          
V79          .          
V80          0.069464350
V81          .          
V82          .          
V83          .          
V84          .          
V85          .          
V86          .          
V87          .          
V88          .          
V89          .          
V90          .          
V91          .          
V92          .          
V93          .          
V94          0.003516026
V95          0.012650953
train_data$W .          
X.1          0.492174807
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          0.103258341
X.8          .          
X.9          .          
X.10         0.674552718
[1] "beta_CATE: "
 [1] 0.0000000 0.4921748 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.1032583 0.0000000 0.0000000 0.6745527
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.330083456239751; time_taken: 67.3360550403595"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.3081261 -0.2056657  0.8629638 -0.2198424  0.6145152  0.5676579
[1] "head(CATE_true)"
[1]  0.4282938 -0.4977176  1.2617323 -0.2417642  0.4980803  1.2101001
[1] 0.3237388
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.20710486
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  0.45526385
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.06196616
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
X.1          0.49943824
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          0.10052266
X.8          .         
X.9          .         
X.10         0.67390336
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.03085089
             .         
[1] "beta_CATE: "
 [1] 0.00000000 0.49943824 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.10052266 0.00000000 0.00000000 0.67390336 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.03085089 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.323738843298085; time_taken: 110.112817764282"
Time to run lasso model: 433.682308912277 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1399448

$`S_lasso_correctly-specified_linear-only`
[1] 0.2589588

$`S_lasso_linear_linear-only`
[1] 0.2276591

$`S_lasso_flexible_linear-only`
[1] 0.2318385

$`T_lasso_mild-complex`
[1] 0.1481357

$`S_lasso_correctly-specified_mild-complex`
[1] 0.3620045

$`S_lasso_linear_mild-complex`
[1] 0.3300835

$`S_lasso_flexible_mild-complex`
[1] 0.3237388

Results for iteration 50 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_50-seed_673.csv
There were 50 or more warnings (use warnings() to see the first 50)
