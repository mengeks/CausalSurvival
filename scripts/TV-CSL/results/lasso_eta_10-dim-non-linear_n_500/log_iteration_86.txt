Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 86
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 86: 1069
Loaded dataset 86 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_86_n_500.rds 
Time to load dataset: 0.03096604347229 seconds
Loaded dataset 186 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_186_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  0.1091165
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   1.04146253
X.2  -0.32757831
X.3  -0.04032067
X.4   .         
X.5  -0.05853191
X.6   .         
X.7   .         
X.8   0.27345675
X.9  -0.12943709
X.10  1.11923496
[1] "head(CATE_est)"
                 1
[1,]  0.0009174523
[2,]  0.5750175660
[3,]  2.7719833343
[4,] -0.1674934038
[5,] -0.7832653116
[6,] -0.6055309220
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] "config_name: T_lasso_linear-only. MSE: 0.18646611939599. time_taken: 28.0019116401672"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.089257257  0.199031389  2.106148627 -0.007591521 -0.262454254
[6] -0.063761582
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.2396576
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.22427113
X.2   .         
X.3  -0.10960538
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   0.11254702
X.9  -0.09123848
X.10  .         
      0.51349446
      1.05681311
[1] "beta_CATE: "
[1] 0.5134945 1.0568131
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.239657621956033; time_taken: 14.8819718360901"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.1478643  0.3813346  2.5047499 -0.1021015 -0.4394930 -0.2725682
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.2852074
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.17562110
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9          -0.05894115
X.10          .         
train_data$W -0.01040087
X.1           0.72299645
X.2          -0.24672688
X.3          -0.05406600
X.4           .         
X.5          -0.03502467
X.6           .         
X.7           .         
X.8           0.21583561
X.9           .         
X.10          0.99388197
[1] "beta_CATE: "
 [1] -0.01040087  0.72299645 -0.24672688 -0.05406600  0.00000000 -0.03502467
 [7]  0.00000000  0.00000000  0.21583561  0.00000000  0.99388197
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.285207359850388; time_taken: 27.345062494278"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.09996061  0.35554168  2.45061598 -0.08033462 -0.41368716 -0.24640152
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.2788886
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.16479148
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9  -0.04105178
X.10  .         
      .         
X.1   0.69543892
X.2  -0.21334116
X.3  -0.05927228
X.4   .         
X.5  -0.02207944
X.6   .         
X.7   .         
X.8   0.19574792
X.9   .         
X.10  0.97499980
[1] "beta_CATE: "
 [1]  0.00000000  0.69543892 -0.21334116 -0.05927228  0.00000000 -0.02207944
 [7]  0.00000000  0.00000000  0.19574792  0.00000000  0.97499980
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.278888641157136; time_taken: 25.4223520755768"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
             -0.03456906
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.648343861
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.047213173
X.9           .          
X.10          0.708629188
X.1_spline1   0.141764551
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.117047975
X.5_spline2   0.090272053
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.861821137
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.472188258
X.10_spline2 -0.190063470
X.10_spline3  0.823702720
              .          
              .          
             -0.003349029
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.106960579
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
               1
[1,] -0.05777528
[2,] -0.27423135
[3,]  2.35091871
[4,] -0.60775371
[5,] -0.94405306
[6,] -0.72576783
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] "config_name: T_lasso_mild-complex. MSE: 0.265684833477611. time_taken: 139.278703927994"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.30555320  0.18446210  2.05623396 -0.04844969 -0.46137782 -0.25177922
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.1683667
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.027959006
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.069653034
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.027886497
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.319328577
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.192621350
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.049654247
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.000839842
              .          
              .          
              .          
              .          
              0.037970204
              .          
              .          
              .          
              0.613841927
              0.924855889
[1] "beta_CATE: "
[1] 0.6138419 0.9248559
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.168366745497075; time_taken: 60.4739782810211"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.21015924  0.15338124  2.17317419 -0.04970846 -0.35071159 -0.16147203
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.1971957
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.04610431
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   0.04904196
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.21856177
X.10_spline3  .         
V41           .         
V42           .         
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60          -0.03582167
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           0.04801569
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.55393918
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.10469381
X.9           .         
X.10          0.85972625
[1] "beta_CATE: "
 [1] 0.0000000 0.5539392 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.1046938 0.0000000 0.8597262
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.197195710470064; time_taken: 61.2654449939728"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.3046107  0.1685588  2.4766583 -0.2025695 -0.5556541 -0.3289538
[1] "head(CATE_true)"
[1]  0.7954331  0.2204743  2.6589634 -0.1378681 -0.9726158 -0.6729594
[1] 0.1536288
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.052368224
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.091730113
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.238727758
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2  -0.230837411
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.225814893
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.005528093
              .          
              .          
              .          
              0.022623796
             -0.047315183
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.018354909
              .          
              .          
              .          
              .          
              0.011184757
              .          
              .          
              .          
              .          
X.1           0.669208741
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.120112021
X.9           .          
X.10          0.853695303
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.225162513
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.190413258
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.253219678
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.201824792
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.055454429
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.041136687
              0.006592951
[1] "beta_CATE: "
 [1]  0.000000000  0.669208741  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.120112021  0.000000000
[11]  0.853695303  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000 -0.225162513  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.190413258
[36]  0.000000000  0.000000000  0.000000000  0.253219678  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[51]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000 -0.201824792  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.055454429  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.041136687
[96]  0.006592951
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.153628832180525; time_taken: 117.93185377121"
Time to run lasso model: 476.58927822113 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1864661

$`S_lasso_correctly-specified_linear-only`
[1] 0.2396576

$`S_lasso_linear_linear-only`
[1] 0.2852074

$`S_lasso_flexible_linear-only`
[1] 0.2788886

$`T_lasso_mild-complex`
[1] 0.2656848

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1683667

$`S_lasso_linear_mild-complex`
[1] 0.1971957

$`S_lasso_flexible_mild-complex`
[1] 0.1536288

Results for iteration 86 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_86-seed_1069.csv
There were 50 or more warnings (use warnings() to see the first 50)
