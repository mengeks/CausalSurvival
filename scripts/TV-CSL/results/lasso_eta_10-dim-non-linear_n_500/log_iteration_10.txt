Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 10
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 10: 233
Loaded dataset 10 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_10_n_500.rds 
Time to load dataset: 0.00493526458740234 seconds
Loaded dataset 110 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_110_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.2424171
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.8347204
X.2   .        
X.3   .        
X.4  -0.1005245
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   0.2622434
X.10  0.7578530
[1] "head(CATE_est)"
              1
[1,] -0.8340457
[2,]  0.3644842
[3,] -0.7666564
[4,] -1.2653251
[5,] -1.4794632
[6,] -0.6534469
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] "config_name: T_lasso_linear-only. MSE: 0.206446160601894. time_taken: 32.3802199363708"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.8335637  0.3942476 -0.5651480 -0.9438082 -1.3053975 -0.6165946
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2771407
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.38785117
X.2   .         
X.3   .         
X.4  -0.08276648
X.5   .         
X.6   .         
X.7  -0.01032115
X.8   .         
X.9   0.15337491
X.10  .         
      0.48164370
      0.89144737
[1] "beta_CATE: "
[1] 0.4816437 0.8914474
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.277140667736932; time_taken: 16.1205310821533"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.7941458  0.3054902 -0.7504012 -1.1494473 -1.4062505 -0.5857873
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2860718
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           0.3286171
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           0.0380420
X.10          .        
train_data$W  .        
X.1           0.5150541
X.2           .        
X.3           .        
X.4          -0.1045166
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           0.2304209
X.10          0.7674269
[1] "beta_CATE: "
 [1]  0.0000000  0.5150541  0.0000000  0.0000000 -0.1045166  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.2304209  0.7674269
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.286071845561469; time_taken: 20.3378562927246"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.7941458  0.3054902 -0.7504012 -1.1494473 -1.4062505 -0.5857873
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2860718
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.3286171
X.2   .        
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   0.0380420
X.10  .        
      .        
X.1   0.5150541
X.2   .        
X.3   .        
X.4  -0.1045166
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   0.2304209
X.10  0.7674269
[1] "beta_CATE: "
 [1]  0.0000000  0.5150541  0.0000000  0.0000000 -0.1045166  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.2304209  0.7674269
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.286071845561469; time_taken: 19.8046753406525"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.48964685
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.02828209
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.21685112
X.10_spline3  0.57171669
             -0.04522351
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06374599
              .         
             -0.06100517
             -0.04810095
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1          0.7013461391
X.2          .           
X.3          .           
X.4          .           
X.5          .           
X.6          .           
X.7          .           
X.8          .           
X.9          0.1902002032
X.10         0.5868918086
X.1_spline1  .           
X.1_spline2  .           
X.1_spline3  .           
X.2_spline1  .           
X.2_spline2  .           
X.2_spline3  .           
X.3_spline1  .           
X.3_spline2  .           
X.3_spline3  .           
X.4_spline1  .           
X.4_spline2  .           
X.4_spline3  .           
X.5_spline1  .           
X.5_spline2  .           
X.5_spline3  .           
X.6_spline1  .           
X.6_spline2  .           
X.6_spline3  .           
X.7_spline1  .           
X.7_spline2  .           
X.7_spline3  .           
X.8_spline1  .           
X.8_spline2  .           
X.8_spline3  .           
X.9_spline1  .           
X.9_spline2  .           
X.9_spline3  0.1970269175
X.10_spline1 .           
X.10_spline2 .           
X.10_spline3 0.5433489578
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             0.0000521859
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
             .           
[1] "head(CATE_est)"
              1
[1,] -0.9667618
[2,]  0.5260973
[3,] -0.7220061
[4,] -1.3450396
[5,] -1.5458959
[6,] -0.8610766
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] "config_name: T_lasso_mild-complex. MSE: 0.212896523847822. time_taken: 136.094424009323"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.7743771  0.4371867 -0.5041631 -0.9911656 -1.2014544 -0.6678494
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2501233
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.218853039
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   0.001881578
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.704218645
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.442285951
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.049965404
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.576424103
              0.762603569
[1] "beta_CATE: "
[1] 0.5764241 0.7626036
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.250123341339333; time_taken: 71.6774618625641"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.7514631  0.4722002 -0.5191819 -1.1445169 -1.2795293 -0.6482860
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2251118
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.22007132
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   0.05080961
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.17602499
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  0.92636719
V41           .         
V42           .         
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60           .         
V61          -0.05913784
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           0.01084259
V94           .         
V95           .         
train_data$W  .         
X.1           0.58431242
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           0.21526317
X.10          0.58567163
[1] "beta_CATE: "
 [1] 0.0000000 0.5843124 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.2152632 0.5856716
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.225111847393996; time_taken: 77.3992731571198"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.7028049  0.5018759 -0.5059518 -1.0468996 -1.2176121 -0.6216174
[1] "head(CATE_true)"
[1] -1.1064602  0.7216714 -0.6918453 -1.5726229 -1.7012943 -1.0842135
[1] 0.2701288
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.200793810
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.146339882
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.937548186
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.063078162
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.002046168
              .          
              .          
              .          
X.1           0.562917173
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.203395014
X.10          0.569466873
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.061233758
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.00000000 0.56291717 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.20339501 0.56946687 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.06123376 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.270128751275392; time_taken: 108.554684877396"
Time to run lasso model: 484.337985754013 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.2064462

$`S_lasso_correctly-specified_linear-only`
[1] 0.2771407

$`S_lasso_linear_linear-only`
[1] 0.2860718

$`S_lasso_flexible_linear-only`
[1] 0.2860718

$`T_lasso_mild-complex`
[1] 0.2128965

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2501233

$`S_lasso_linear_mild-complex`
[1] 0.2251118

$`S_lasso_flexible_mild-complex`
[1] 0.2701288

Results for iteration 10 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_10-seed_233.csv
There were 50 or more warnings (use warnings() to see the first 50)
