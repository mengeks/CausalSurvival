Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 30
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 30: 453
Loaded dataset 30 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_30_n_500.rds 
Time to load dataset: 0.00465202331542969 seconds
Loaded dataset 130 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_130_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.89846061
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  0.13061980
X.7  .         
X.8  0.04814063
X.9  .         
X.10 1.00763237
[1] "head(CATE_est)"
              1
[1,] -1.1043823
[2,] -1.6448231
[3,] -0.8566925
[4,]  2.0659795
[5,] -1.4810366
[6,] -0.6380205
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] "config_name: T_lasso_linear-only. MSE: 0.0256826542360894. time_taken: 30.3613755702972"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.0739582 -1.6356571 -0.7101727  1.9299118 -1.4187092 -0.7239003
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.0223419
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.03059332
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  0.04848175
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     0.85466700
     1.04715677
[1] "beta_CATE: "
[1] 0.854667 1.047157
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0223419004156044; time_taken: 15.2026929855347"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.4014030 -1.7156083 -0.7860077  1.7341061 -1.4581371 -0.6414299
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.08317032
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           0.1468171
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           .        
X.10          .        
train_data$W -0.1681483
X.1           0.7355701
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           0.1436209
X.7           .        
X.8           0.0417636
X.9           .        
X.10          0.9966032
[1] "beta_CATE: "
 [1] -0.1681483  0.7355701  0.0000000  0.0000000  0.0000000  0.0000000
 [7]  0.1436209  0.0000000  0.0417636  0.0000000  0.9966032
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0831703220364806; time_taken: 29.0601398944855"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.0772757 -1.5153308 -0.7328113  1.8939658 -1.3330230 -0.5442318
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.0317114
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.03298286
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.79485471
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  0.13361714
X.7  .         
X.8  0.04185453
X.9  .         
X.10 0.94254038
[1] "beta_CATE: "
 [1] 0.00000000 0.79485471 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.13361714 0.00000000 0.04185453 0.00000000 0.94254038
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0317113962968037; time_taken: 28.2460963726044"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.05162224
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.69177400
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           0.11613369
X.7           .         
X.8           0.02280496
X.9           .         
X.10          0.81077945
X.1_spline1   0.79883627
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.07971972
X.10_spline3  0.91153304
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.08873845
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02449359
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -0.7268261
[2,] -1.5418264
[3,] -0.8794855
[4,]  2.1140080
[5,] -1.5567158
[6,] -0.8992507
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] "config_name: T_lasso_mild-complex. MSE: 0.0655343846188661. time_taken: 132.770234584808"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.9771776 -1.5197146 -0.6804598  1.7986717 -1.3293350 -0.6846751
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.03975053
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.214185627
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   0.395803226
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.156669306
X.10_spline3  .          
             -0.002437136
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.027378530
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.032945785
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.019734255
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.806080858
              0.967485458
[1] "beta_CATE: "
[1] 0.8060809 0.9674855
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0397505301367208; time_taken: 71.9069933891296"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.9876093 -1.4351917 -0.7375006  1.8093481 -1.2847576 -0.5327309
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.03685513
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   0.17583508
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.18415318
X.10_spline3  .         
V41           .         
V42           .         
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           0.01780769
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           0.01341444
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           0.03272348
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.77489058
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           0.13038219
X.7           .         
X.8           0.04424667
X.9           .         
X.10          0.88094267
[1] "beta_CATE: "
 [1] 0.00000000 0.77489058 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.13038219 0.00000000 0.04424667 0.00000000 0.88094267
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0368551339306118; time_taken: 81.5586352348328"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.1239676 -1.5127723 -0.8379933  1.6708963 -1.4287431 -0.7842716
[1] "head(CATE_true)"
[1] -0.8570888 -1.6570847 -0.9501185  2.0173673 -1.5624164 -0.8685457
[1] 0.09947485
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.022858283
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.466741158
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   0.016338004
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.123046514
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.005897471
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.004836558
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.708238364
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           0.122856622
X.7           .          
X.8           0.025333266
X.9           .          
X.10          0.787557887
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   0.014720853
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.818854766
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.069859869
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.043405283
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.00000000 0.70823836 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.12285662 0.00000000 0.02533327 0.00000000 0.78755789 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.01472085 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.81885477 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.06985987 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.04340528 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0994748479130691; time_taken: 109.807804584503"
Time to run lasso model: 500.660769939423 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.02568265

$`S_lasso_correctly-specified_linear-only`
[1] 0.0223419

$`S_lasso_linear_linear-only`
[1] 0.08317032

$`S_lasso_flexible_linear-only`
[1] 0.0317114

$`T_lasso_mild-complex`
[1] 0.06553438

$`S_lasso_correctly-specified_mild-complex`
[1] 0.03975053

$`S_lasso_linear_mild-complex`
[1] 0.03685513

$`S_lasso_flexible_mild-complex`
[1] 0.09947485

Results for iteration 30 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_30-seed_453.csv
There were 50 or more warnings (use warnings() to see the first 50)
