Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 31
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 31: 464
Loaded dataset 31 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_31_n_500.rds 
Time to load dataset: 0.00563645362854004 seconds
Loaded dataset 131 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_131_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.96403208
X.2  -0.14828725
X.3   .         
X.4   0.15008468
X.5   .         
X.6   .         
X.7   0.07204169
X.8   .         
X.9   .         
X.10  0.91218984
[1] "head(CATE_est)"
              1
[1,] -1.3739934
[2,]  0.4116727
[3,] -1.7711987
[4,]  1.6188580
[5,]  0.3237351
[6,]  1.9843323
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] "config_name: T_lasso_linear-only. MSE: 0.0134926098905221. time_taken: 27.8217170238495"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.0401349  0.3049104 -1.2366915  1.2302819  0.1531288  1.7092006
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.08953654
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.02646806
X.2  .         
X.3  .         
X.4  0.01555296
X.5  .         
X.6  0.01091195
X.7  0.06931937
X.8  .         
X.9  0.03230043
X.10 0.05920101
     0.80113853
     0.77067474
[1] "beta_CATE: "
[1] 0.8011385 0.7706747
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0895365418052414; time_taken: 14.2437148094177"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.28722742  0.13445194 -1.61513558  1.03443028  0.07052407  1.30552038
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.1729193
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.183354774
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.011412488
X.8           .          
X.9           0.003496576
X.10          0.184885148
train_data$W -0.203466066
X.1           0.776711757
X.2          -0.181654181
X.3           .          
X.4           0.150491119
X.5           .          
X.6           .          
X.7           0.068172974
X.8           .          
X.9           .          
X.10          0.692343619
[1] "beta_CATE: "
 [1] -0.20346607  0.77671176 -0.18165418  0.00000000  0.15049112  0.00000000
 [7]  0.00000000  0.06817297  0.00000000  0.00000000  0.69234362
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.172919328415979; time_taken: 28.2841022014618"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.0723486  0.3198252 -1.4090095  1.3534247  0.1556551  1.6802269
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.09694526
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.05028756
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.02071333
X.10 0.10490352
     .         
X.1  0.72043316
X.2  .         
X.3  .         
X.4  0.08250155
X.5  .         
X.6  .         
X.7  0.07198884
X.8  .         
X.9  .         
X.10 0.69535012
[1] "beta_CATE: "
 [1] 0.00000000 0.72043316 0.00000000 0.00000000 0.08250155 0.00000000
 [7] 0.00000000 0.07198884 0.00000000 0.00000000 0.69535012
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0969452642129224; time_taken: 28.2706532478333"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.866378305
X.2           .          
X.3           .          
X.4           0.007257745
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.732358499
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   0.174014282
X.4_spline2  -0.456971382
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.129417717
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   0.487128717
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.123035359
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.640553730
              .          
             -0.023988027
              .          
              .          
              .          
             -0.058360608
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.040490314
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.052421006
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -1.6974721
[2,] -0.1098879
[3,] -1.6876673
[4,]  1.3063856
[5,] -0.2262862
[6,]  1.4167727
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] "config_name: T_lasso_mild-complex. MSE: 0.225171349817839. time_taken: 128.232446670532"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.05446462  0.33270299 -1.23986517  1.21824152  0.06112943  1.81504435
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.08538535
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.013698018
X.10          0.006928375
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.283588617
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.004797171
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.034285971
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   0.677485503
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.083184512
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.370241811
              .          
             -0.031827783
              .          
              .          
              .          
             -0.031612405
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.859507803
              0.734625991
[1] "beta_CATE: "
[1] 0.8595078 0.7346260
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0853853513422647; time_taken: 66.0065703392029"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.11151894  0.33471446 -1.37326994  1.33042444  0.08491953  1.80832332
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.08257298
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.012161411
X.10          0.034793261
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.165167902
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   0.310770007
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.054164950
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.338859523
V41           .          
V42          -0.039767848
V43           .          
V44           .          
V45           .          
V46          -0.009444576
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.796544364
X.2           .          
X.3           .          
X.4           0.090526109
X.5           .          
X.6           .          
X.7           0.024662053
X.8           .          
X.9           .          
X.10          0.698684622
[1] "beta_CATE: "
 [1] 0.00000000 0.79654436 0.00000000 0.00000000 0.09052611 0.00000000
 [7] 0.00000000 0.02466205 0.00000000 0.00000000 0.69868462
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0825729767779528; time_taken: 68.0881628990173"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.326219648  0.149606911 -1.429334668  1.365415683  0.001878588
[6]  1.730162510
[1] "head(CATE_true)"
[1] -1.3236657  0.3782960 -1.5795197  1.5776014  0.2336839  2.1411707
[1] 0.08248902
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.07633246
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   0.26981768
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   0.07389264
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   0.46753553
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
             -0.05339042
              .         
              .         
              .         
             -0.03064979
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.85602324
X.2           .         
X.3           .         
X.4           0.09258062
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.64490089
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.01303704
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.12703296
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  0.57383676
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.01032835
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.01734664
              .         
              .         
              .         
              .         
              .         
[1] "beta_CATE: "
 [1] 0.00000000 0.85602324 0.00000000 0.00000000 0.09258062 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.64490089 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.01303704 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.12703296 0.00000000 0.00000000 0.57383676 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.01032835 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.01734664 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0824890230941561; time_taken: 108.347631931305"
Time to run lasso model: 471.263908624649 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.01349261

$`S_lasso_correctly-specified_linear-only`
[1] 0.08953654

$`S_lasso_linear_linear-only`
[1] 0.1729193

$`S_lasso_flexible_linear-only`
[1] 0.09694526

$`T_lasso_mild-complex`
[1] 0.2251713

$`S_lasso_correctly-specified_mild-complex`
[1] 0.08538535

$`S_lasso_linear_mild-complex`
[1] 0.08257298

$`S_lasso_flexible_mild-complex`
[1] 0.08248902

Results for iteration 31 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_31-seed_464.csv
There were 50 or more warnings (use warnings() to see the first 50)
