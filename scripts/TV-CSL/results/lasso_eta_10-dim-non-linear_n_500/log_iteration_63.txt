Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 63
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 63: 816
Loaded dataset 63 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_63_n_500.rds 
Time to load dataset: 0.0149946212768555 seconds
Loaded dataset 163 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_163_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.06940602
X.2  .         
X.3  0.09562254
X.4  0.01694761
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.8100570
X.2  .        
X.3  .        
X.4  0.1851078
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 1.0355728
[1] "head(CATE_est)"
              1
[1,]  1.4559703
[2,]  3.3876042
[3,] -0.1283818
[4,] -0.9897303
[5,] -3.3037101
[6,] -0.7253065
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] "config_name: T_lasso_linear-only. MSE: 0.0506855217730315. time_taken: 28.7037212848663"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.41177826  3.27725774 -0.04619779 -0.87281456 -3.09754693 -0.74869935
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.04612585
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  .        
X.3  .        
X.4  0.1054037
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.7801234
     0.9974469
[1] "beta_CATE: "
[1] 0.7801234 0.9974469
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0461258472432652; time_taken: 14.3008592128754"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.0794707  2.9538764 -0.3977397 -1.1842789 -3.4486891 -1.0319339
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.1888062
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.141908042
X.2           .          
X.3           .          
X.4           0.109017000
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.002912133
train_data$W -0.330414536
X.1           0.661526397
X.2           .          
X.3           .          
X.4           0.085796742
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9          -0.060700952
X.10          1.084753635
[1] "beta_CATE: "
 [1] -0.33041454  0.66152640  0.00000000  0.00000000  0.08579674  0.00000000
 [7]  0.00000000  0.00000000  0.00000000 -0.06070095  1.08475364
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.188806212600861; time_taken: 28.4405918121338"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.0960487  2.9785975 -0.3868759 -1.1743681 -3.4395941 -1.0237274
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.1712924
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.135536041
X.2   .          
X.3   .          
X.4   0.100852811
X.5   .          
X.6   .          
X.7   .          
X.8   .          
X.9   .          
X.10  0.001342328
     -0.308361196
X.1   0.664060536
X.2   .          
X.3   .          
X.4   0.089245051
X.5   .          
X.6   .          
X.7   .          
X.8   .          
X.9  -0.043754262
X.10  1.067073732
[1] "beta_CATE: "
 [1] -0.30836120  0.66406054  0.00000000  0.00000000  0.08924505  0.00000000
 [7]  0.00000000  0.00000000  0.00000000 -0.04375426  1.06707373
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.171292390064556; time_taken: 28.198810338974"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.08297091
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.08583106
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.66459614
X.2           .         
X.3           .         
X.4           0.03418666
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.83225868
X.1_spline1   0.31491237
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   0.03635506
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.20748567
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.44521725
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   0.04379171
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.49817870
X.10_spline3  0.43425629
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  1.4870892
[2,]  3.5264986
[3,] -0.3362401
[4,] -1.0990758
[5,] -2.9008970
[6,] -0.8444821
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] "config_name: T_lasso_mild-complex. MSE: 0.0623925823754169. time_taken: 121.722410440445"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.37695682  3.21260133 -0.07573928 -0.90591740 -3.04772792 -0.78936033
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.0428853
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.28989066
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   0.04168087
X.6_spline2  -0.04873342
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.26601051
X.10_spline3  .         
             -0.03545542
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.80208912
              0.94920659
[1] "beta_CATE: "
[1] 0.8020891 0.9492066
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0428852964533373; time_taken: 58.8637273311615"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.240025  3.360866 -0.524826 -1.467243 -3.750869 -1.324217
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.06125706
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.11915519
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.07617954
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   0.08692515
X.6_spline2  -0.45550545
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   0.91873538
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -1.00999081
X.10_spline3  .         
V41          -0.06764566
V42           .         
V43          -0.03797393
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           0.01899970
train_data$W -0.22470797
X.1           0.86826296
X.2           .         
X.3           .         
X.4           0.15191848
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.97502619
[1] "beta_CATE: "
 [1] -0.2247080  0.8682630  0.0000000  0.0000000  0.1519185  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.0000000  0.9750262
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0612570649756243; time_taken: 64.9395678043365"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.2107168  3.3076124 -0.4288459 -1.2876981 -3.1794277 -1.1541029
[1] "head(CATE_true)"
[1]  1.5375071  3.6281644 -0.1622931 -1.1499393 -3.4704253 -1.0311836
[1] 0.05095471
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.0167490014
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   0.0628136217
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   0.0959688653
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   0.0364277508
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  0.0607593909
X.10_spline2 -0.1956977159
X.10_spline3  .           
             -0.0473017398
              .           
             -0.0030771650
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.7815742515
X.2           .           
X.3           .           
X.4           0.1275871206
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.8011599664
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  0.6580015644
             -0.0005363487
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1]  0.0000000000  0.7815742515  0.0000000000  0.0000000000  0.1275871206
 [6]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[11]  0.8011599664  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[16]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[21]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[26]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[31]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[36]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[41]  0.6580015644 -0.0005363487  0.0000000000  0.0000000000  0.0000000000
[46]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[51]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[56]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[61]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[66]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[71]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[76]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[81]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[86]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[91]  0.0000000000  0.0000000000  0.0000000000  0.0000000000  0.0000000000
[96]  0.0000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0509547148737182; time_taken: 117.223515510559"
Time to run lasso model: 464.164845705032 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.05068552

$`S_lasso_correctly-specified_linear-only`
[1] 0.04612585

$`S_lasso_linear_linear-only`
[1] 0.1888062

$`S_lasso_flexible_linear-only`
[1] 0.1712924

$`T_lasso_mild-complex`
[1] 0.06239258

$`S_lasso_correctly-specified_mild-complex`
[1] 0.0428853

$`S_lasso_linear_mild-complex`
[1] 0.06125706

$`S_lasso_flexible_mild-complex`
[1] 0.05095471

Results for iteration 63 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_63-seed_816.csv
There were 50 or more warnings (use warnings() to see the first 50)
