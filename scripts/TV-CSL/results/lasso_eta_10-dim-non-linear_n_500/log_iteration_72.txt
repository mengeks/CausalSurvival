Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 72
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 72: 915
Loaded dataset 72 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_72_n_500.rds 
Time to load dataset: 0.0232343673706055 seconds
Loaded dataset 172 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_172_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.71497691
X.2  0.03314663
X.3  .         
X.4  .         
X.5  .         
X.6  0.03630059
X.7  .         
X.8  .         
X.9  .         
X.10 1.01372369
[1] "head(CATE_est)"
               1
[1,]  1.32483201
[2,] -0.86996858
[3,]  0.08921886
[4,] -0.29839458
[5,]  0.19617563
[6,]  1.05341593
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] "config_name: T_lasso_linear-only. MSE: 0.0582456556470744. time_taken: 25.7927596569061"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.2886717 -0.8196214  0.1204762 -0.2153639  0.1668678  1.0019558
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.07968285
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.01256836
X.2  0.02588637
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.02187173
X.8  .         
X.9  .         
X.10 .         
     0.71662486
     1.02177053
[1] "beta_CATE: "
[1] 0.7166249 1.0217705
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0796828498353867; time_taken: 15.6253530979156"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.3487098 -0.8086820  0.1133262 -0.2047287  0.2013194  1.0262716
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.07511922
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.016393222
X.2          0.011431217
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
train_data$W 0.030518200
X.1          0.706164790
X.2          0.005797732
X.3          .          
X.4          .          
X.5          .          
X.6          0.038036668
X.7          .          
X.8          .          
X.9          .          
X.10         1.008949735
[1] "beta_CATE: "
 [1] 0.030518200 0.706164790 0.005797732 0.000000000 0.000000000 0.000000000
 [7] 0.038036668 0.000000000 0.000000000 0.000000000 1.008949735
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0751192169092837; time_taken: 21.0610754489899"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.32469352 -0.81282019  0.09972316 -0.21012357  0.18502469  1.00112582
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.07866763
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.016847431
X.2  0.013447236
X.3  .          
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 .          
     0.017166883
X.1  0.699591007
X.2  0.004147883
X.3  .          
X.4  .          
X.5  .          
X.6  0.036789358
X.7  .          
X.8  .          
X.9  .          
X.10 1.001476784
[1] "beta_CATE: "
 [1] 0.017166883 0.699591007 0.004147883 0.000000000 0.000000000 0.000000000
 [7] 0.036789358 0.000000000 0.000000000 0.000000000 1.001476784
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0786676300513326; time_taken: 20.7675828933716"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.6147696740
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.7137457801
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.1346020771
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   0.1292572053
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   0.0730652444
X.7_spline1   .           
X.7_spline2  -0.2283444330
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  1.0532742110
              .           
              .           
              .           
              0.0007304246
              .           
              .           
              .           
              0.0398019989
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0213849546
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "head(CATE_est)"
              1
[1,]  0.9442907
[2,] -1.1759786
[3,] -0.3622675
[4,] -0.5394769
[5,] -0.2814325
[6,]  0.4495810
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] "config_name: T_lasso_mild-complex. MSE: 0.253905465998925. time_taken: 137.652013778687"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.0963301 -0.7214083  0.1114783 -0.2404325  0.1483044  0.8947678
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.1433857
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.1011901035
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.1517827443
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.1391144586
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.5387178869
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -0.1105139023
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  0.3275838673
              .           
              .           
              .           
              .           
              0.0300004157
              0.0001039729
              .           
              0.0381321191
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.6415185016
              0.8769518648
[1] "beta_CATE: "
[1] 0.6415185 0.8769519
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.143385706384427; time_taken: 59.8922483921051"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.0952530 -0.7195166  0.1109281 -0.2373904  0.1478476  0.8918112
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.1452728
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.0992634660
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.1313388216
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.1461182669
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.5384874521
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -0.0891909382
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  0.3090828998
V41           .           
V42           .           
V43           .           
V44           .           
V45           0.0268505521
V46           .           
V47           .           
V48           0.0369515996
V49           .           
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57           .           
V58           .           
V59           .           
V60           .           
V61           .           
V62           .           
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           0.0001004126
V90           .           
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W  .           
X.1           0.6393259820
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.8757132677
[1] "beta_CATE: "
 [1] 0.0000000 0.6393260 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.8757133
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.145272772443835; time_taken: 65.6144316196442"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.3282344 -0.7227979  0.1162954 -0.1481925  0.1554079  0.8893182
[1] "head(CATE_true)"
[1]  1.1518126 -1.0047786  0.2090666 -0.8381567  0.2207233  1.3735878
[1] 0.1998098
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.0001523514
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.4333326250
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -0.0004282495
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.6220873711
X.2           0.0109472298
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.8551953694
X.1_spline1   0.0042093444
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              0.0045685069
              .           
              .           
              .           
              0.0095074411
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.1163680279
              .           
[1] "beta_CATE: "
 [1] 0.000000000 0.622087371 0.010947230 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.855195369 0.004209344
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[43] 0.000000000 0.000000000 0.004568507 0.000000000 0.000000000 0.000000000
[49] 0.009507441 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.116368028 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.199809782555269; time_taken: 114.003842592239"
Time to run lasso model: 462.405830144882 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.05824566

$`S_lasso_correctly-specified_linear-only`
[1] 0.07968285

$`S_lasso_linear_linear-only`
[1] 0.07511922

$`S_lasso_flexible_linear-only`
[1] 0.07866763

$`T_lasso_mild-complex`
[1] 0.2539055

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1433857

$`S_lasso_linear_mild-complex`
[1] 0.1452728

$`S_lasso_flexible_mild-complex`
[1] 0.1998098

Results for iteration 72 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_72-seed_915.csv
There were 50 or more warnings (use warnings() to see the first 50)
