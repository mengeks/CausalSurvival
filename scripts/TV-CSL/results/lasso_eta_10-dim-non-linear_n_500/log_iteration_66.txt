Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 66
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 66: 849
Loaded dataset 66 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_66_n_500.rds 
Time to load dataset: 0.0197367668151855 seconds
Loaded dataset 166 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_166_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.76495780
X.2  .         
X.3  .         
X.4  .         
X.5  0.06055594
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.81757405
[1] "head(CATE_est)"
               1
[1,] -0.04884448
[2,] -1.07878250
[3,]  0.22199222
[4,] -0.77477790
[5,]  1.18589016
[6,]  0.69718784
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] "config_name: T_lasso_linear-only. MSE: 0.0714309323835256. time_taken: 34.4651343822479"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.02061692 -1.04840813  0.24922920 -0.78579752  1.14474028  0.69023313
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.074187
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.05715220
X.2  .         
X.3  .         
X.4  .         
X.5  0.05685096
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.02991375
     0.77976564
     0.85573124
[1] "beta_CATE: "
[1] 0.7797656 0.8557312
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0741870011953182; time_taken: 24.4713544845581"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.01996382 -1.03345867  0.24463068 -0.78803144  1.14643378  0.68682859
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.07788456
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.05188202
X.2          .         
X.3          .         
X.4          .         
X.5          0.04986226
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         0.01744896
train_data$W .         
X.1          0.76630077
X.2          .         
X.3          .         
X.4          .         
X.5          0.01145432
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         0.84905216
[1] "beta_CATE: "
 [1] 0.00000000 0.76630077 0.00000000 0.00000000 0.00000000 0.01145432
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.84905216
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0778845619228734; time_taken: 28.901650428772"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.01744075 -1.02386236  0.24471330 -0.78845996  1.14192551  0.68391104
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.0807413
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.045938770
X.2  .          
X.3  .          
X.4  .          
X.5  0.050609291
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 0.006907956
     .          
X.1  0.761284600
X.2  .          
X.3  .          
X.4  .          
X.5  0.010826899
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 0.848262918
[1] "beta_CATE: "
 [1] 0.0000000 0.7612846 0.0000000 0.0000000 0.0000000 0.0108269 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.8482629
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0807413001124534; time_taken: 27.6631414890289"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.666124856
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.718139865
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  0.025287562
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  0.428400400
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             0.018005006
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.008080757
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.023514294
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
[1] "head(CATE_est)"
               1
[1,] -0.16006832
[2,] -1.05689544
[3,]  0.08365139
[4,] -0.76745378
[5,]  1.06548443
[6,]  0.51940863
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] "config_name: T_lasso_mild-complex. MSE: 0.187582829991152. time_taken: 156.479685306549"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.04632094 -1.00862269  0.21381802 -0.66194607  1.02302595  0.62181359
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.1558476
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.02807254
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  0.48712102
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 0.46462710
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.00341522
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.72775393
             0.74060399
[1] "beta_CATE: "
[1] 0.7277539 0.7406040
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.15584762986762; time_taken: 86.8430235385895"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.04632074 -1.00858875  0.21380950 -0.66191898  1.02298752  0.62179050
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.1558799
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.027947852
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  0.486982694
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 0.463884341
V41          .          
V42          .          
V43          .          
V44          .          
V45          .          
V46          .          
V47          .          
V48          .          
V49          .          
V50          .          
V51          .          
V52          .          
V53          .          
V54          .          
V55          .          
V56          .          
V57          .          
V58          .          
V59          .          
V60          .          
V61          .          
V62          .          
V63          .          
V64          .          
V65          .          
V66          .          
V67          .          
V68          .          
V69          .          
V70          .          
V71          .          
V72          .          
V73          .          
V74          .          
V75          .          
V76          .          
V77          .          
V78          .          
V79          .          
V80          .          
V81          .          
V82          .          
V83          .          
V84          .          
V85          0.003328402
V86          .          
V87          .          
V88          .          
V89          .          
V90          .          
V91          .          
V92          .          
V93          .          
V94          .          
V95          .          
train_data$W .          
X.1          0.727728289
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.740574836
[1] "beta_CATE: "
 [1] 0.0000000 0.7277283 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.7405748
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.155879874100939; time_taken: 86.1542770862579"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.02426421 -0.98879938  0.26060860 -0.57840224  1.20038304  0.67920650
[1] "head(CATE_true)"
[1] -0.07188612 -1.39510875  0.28809072 -0.88784425  1.39193357  0.84762088
[1] 0.2018569
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  0.05166186
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 0.36318941
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
X.1          0.71367493
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         0.72453628
X.1_spline1  .         
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  0.09935278
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 .         
             .         
             .         
             .         
             .         
             0.07569336
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.01864261
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.00112259
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
[1] "beta_CATE: "
 [1] 0.00000000 0.71367493 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.72453628 0.00000000
[13] 0.00000000 0.00000000 0.09935278 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.07569336 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.01864261
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00112259 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.201856916914837; time_taken: 125.17351937294"
Time to run lasso model: 572.203579902649 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.07143093

$`S_lasso_correctly-specified_linear-only`
[1] 0.074187

$`S_lasso_linear_linear-only`
[1] 0.07788456

$`S_lasso_flexible_linear-only`
[1] 0.0807413

$`T_lasso_mild-complex`
[1] 0.1875828

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1558476

$`S_lasso_linear_mild-complex`
[1] 0.1558799

$`S_lasso_flexible_mild-complex`
[1] 0.2018569

Results for iteration 66 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_66-seed_849.csv
There were 50 or more warnings (use warnings() to see the first 50)
