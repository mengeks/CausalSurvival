Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 48
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 48: 651
Loaded dataset 48 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_48_n_500.rds 
Time to load dataset: 0.00545930862426758 seconds
Loaded dataset 148 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_148_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.70135562
X.2  0.03687542
X.3  0.07679360
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.82350605
[1] "head(CATE_est)"
              1
[1,] -2.1355666
[2,] -0.6450807
[3,] -1.3296102
[4,] -1.0482490
[5,]  0.1164938
[6,]  2.8419336
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] "config_name: T_lasso_linear-only. MSE: 0.0724498334869325. time_taken: 25.1301023960114"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.0897333 -0.7133606 -1.2856743 -1.0269169  0.1829581  2.8500130
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.09652945
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.06859196
X.2  0.06059778
X.3  0.05785382
X.4  .         
X.5  .         
X.6  .         
X.7  0.01819415
X.8  .         
X.9  .         
X.10 .         
     0.72379647
     0.89126501
[1] "beta_CATE: "
[1] 0.7237965 0.8912650
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0965294470661715; time_taken: 14.0600917339325"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.9648954 -0.6885309 -1.2287384 -0.9144907  0.2855192  3.0274427
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.08415053
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.11039926
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.04816350
X.8           0.01781497
X.9           .         
X.10          .         
train_data$W  0.08942164
X.1           0.65038404
X.2           0.09783678
X.3           0.09244422
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9          -0.21874394
X.10          1.05641099
[1] "beta_CATE: "
 [1]  0.08942164  0.65038404  0.09783678  0.09244422  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000 -0.21874394  1.05641099
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0841505273019537; time_taken: 17.7339398860931"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.9529332 -0.6985012 -1.2211149 -0.9085969  0.2852666  3.0419873
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.08532499
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.10949366
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   0.04901764
X.8   0.02308586
X.9   .         
X.10  .         
      0.08848528
X.1   0.65286615
X.2   0.09795219
X.3   0.09610616
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9  -0.24428015
X.10  1.07662052
[1] "beta_CATE: "
 [1]  0.08848528  0.65286615  0.09795219  0.09610616  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000 -0.24428015  1.07662052
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0853249937895692; time_taken: 17.4617390632629"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.0002404543
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   0.6219187950
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   1.4800884560
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.5634354129
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.5737164435
X.10_spline1 -0.1992048446
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.86561588
X.2           .         
X.3           0.14816851
X.4           .         
X.5           .         
X.6           .         
X.7           0.05956530
X.8           .         
X.9           .         
X.10          0.66509094
X.1_spline1   .         
X.1_spline2   1.65417245
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   0.20839546
X.2_spline3   .         
X.3_spline1   0.43324141
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.37024736
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   0.98281229
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   0.08234689
X.8_spline3   .         
X.9_spline1  -0.56434767
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -2.18811305
X.10_spline3  0.48782158
              .         
              .         
             -0.04297574
              .         
              .         
             -0.01198666
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.12337031
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.03213545
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -3.0037044
[2,] -1.2957938
[3,] -1.9538518
[4,] -1.9167455
[5,] -0.6107791
[6,]  2.8758743
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] "config_name: T_lasso_mild-complex. MSE: 0.476275320286518. time_taken: 135.847440242767"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.35461257 -0.55518142 -1.20347540 -1.09285294  0.05495092  3.14473661
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.07106035
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           4.958500e-02
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   1.246448e+00
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   6.537767e-01
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   2.216447e-01
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1  -4.037484e-01
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2 -4.731373e-01
X.10_spline3  9.215688e-01
              .           
              .           
             -9.462833e-03
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              6.696385e-02
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -1.463612e-05
             -1.662285e-02
             -2.775525e-02
              .           
              .           
              .           
              .           
              .           
              .           
              9.397711e-01
              7.243480e-01
[1] "beta_CATE: "
[1] 0.9397711 0.7243480
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0710603485092864; time_taken: 60.8998608589172"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.26100448 -0.43834698 -1.28703175 -1.03808162  0.08349022  3.18294558
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.07377219
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.011114647
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   0.879539757
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   0.173127836
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1  -0.184620031
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.177332578
X.10_spline3  0.837098182
V41           .          
V42           .          
V43          -0.021934385
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           0.046039605
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68          -0.031695259
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88          -0.002915695
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  0.097889219
X.1           0.814570240
X.2           0.049306344
X.3           0.161325269
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.719304992
[1] "beta_CATE: "
 [1] 0.09788922 0.81457024 0.04930634 0.16132527 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.71930499
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0737721883926698; time_taken: 67.3734028339386"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.0500218 -0.2316316 -1.2790656 -0.9899096  0.2081222  3.7318970
[1] "head(CATE_true)"
[1] -2.6954614 -0.7872524 -1.5272941 -1.2902464  0.1551716  3.6405568
[1] 0.1620282
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.020149886
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   1.206774748
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   0.083530703
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1  -0.448231811
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  1.176516179
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.849016001
X.2           .          
X.3           0.119588967
X.4           .          
X.5           .          
X.6           .          
X.7           0.004122985
X.8           .          
X.9           .          
X.10          0.554302945
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   0.560904745
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   0.051271259
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.631797669
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
             -0.034329844
              .          
              .          
             -0.024359209
              .          
              .          
              .          
              0.005251685
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.107705079
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.849016001  0.000000000  0.119588967  0.000000000
 [6]  0.000000000  0.000000000  0.004122985  0.000000000  0.000000000
[11]  0.554302945  0.000000000  0.000000000  0.000000000  0.000000000
[16]  0.000000000  0.000000000  0.560904745  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.051271259  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.631797669  0.000000000
[41]  0.000000000  0.000000000  0.000000000 -0.034329844  0.000000000
[46]  0.000000000 -0.024359209  0.000000000  0.000000000  0.000000000
[51]  0.005251685  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000  0.000000000  0.000000000  0.000000000  0.107705079
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.162028200235094; time_taken: 115.8130671978"
Time to run lasso model: 456.032183170319 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.07244983

$`S_lasso_correctly-specified_linear-only`
[1] 0.09652945

$`S_lasso_linear_linear-only`
[1] 0.08415053

$`S_lasso_flexible_linear-only`
[1] 0.08532499

$`T_lasso_mild-complex`
[1] 0.4762753

$`S_lasso_correctly-specified_mild-complex`
[1] 0.07106035

$`S_lasso_linear_mild-complex`
[1] 0.07377219

$`S_lasso_flexible_mild-complex`
[1] 0.1620282

Results for iteration 48 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_48-seed_651.csv
There were 50 or more warnings (use warnings() to see the first 50)
