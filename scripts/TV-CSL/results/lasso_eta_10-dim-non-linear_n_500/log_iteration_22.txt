Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 22
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 22: 365
Loaded dataset 22 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_22_n_500.rds 
Time to load dataset: 0.00434207916259766 seconds
Loaded dataset 122 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_122_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.06613731
X.2  0.01206579
X.3  0.11503738
X.4  0.04455143
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.70435166
X.2  .         
X.3  0.25033392
X.4  0.08759500
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.01793683
X.10 0.95311064
[1] "head(CATE_est)"
              1
[1,]  0.1883985
[2,] -1.1257119
[3,] -0.2120677
[4,]  0.9618731
[5,]  0.5896332
[6,]  0.6714342
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] "config_name: T_lasso_linear-only. MSE: 0.0595792728294752. time_taken: 27.8184154033661"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.1213799 -1.1183652 -0.2598363  0.9559026  0.6827136  0.6930670
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.07488391
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  .         
X.3  0.10705163
X.4  0.07651226
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     0.73179386
     0.94328286
[1] "beta_CATE: "
[1] 0.7317939 0.9432829
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0748839099822544; time_taken: 15.8617658615112"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.03473480 -1.48277586 -0.52414659  0.66747982  0.09925455  0.33208065
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.1958391
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.090208191
X.2           .          
X.3           0.152674518
X.4           0.181495050
X.5          -0.055004846
X.6          -0.111347961
X.7           .          
X.8           0.040157957
X.9           .          
X.10          .          
train_data$W -0.341355694
X.1           0.694124543
X.2          -0.142224536
X.3           0.156869629
X.4           .          
X.5           .          
X.6           0.006474652
X.7           0.032421762
X.8           .          
X.9           0.055019719
X.10          0.944716351
[1] "beta_CATE: "
 [1] -0.341355694  0.694124543 -0.142224536  0.156869629  0.000000000
 [6]  0.000000000  0.006474652  0.032421762  0.000000000  0.055019719
[11]  0.944716351
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.195839115076356; time_taken: 27.8761579990387"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.002477235 -1.320250464 -0.420262987  0.747876166  0.333996675
[6]  0.449255223
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.113768
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.06968515
X.2   .         
X.3   0.11260506
X.4   0.07895814
X.5   .         
X.6  -0.02153840
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.21823915
X.1   0.62106791
X.2   .         
X.3   0.13143617
X.4   0.01719949
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   0.03010245
X.10  0.93904065
[1] "beta_CATE: "
 [1] -0.21823915  0.62106791  0.00000000  0.13143617  0.01719949  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.03010245  0.93904065
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.113768043970025; time_taken: 26.8548200130463"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   0.003537336
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
             -0.077749002
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.005613001
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.635683554
X.2           .          
X.3           0.181062287
X.4           0.083820669
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.001543622
X.10          0.727250891
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   0.351573239
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.085719836
X.10_spline1  .          
X.10_spline2 -0.123196505
X.10_spline3  0.802979338
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.010233356
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -0.1985250
[2,] -1.3763929
[3,] -0.6189227
[4,]  0.5286118
[5,]  0.7745118
[6,]  0.2218510
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] "config_name: T_lasso_mild-complex. MSE: 0.124980029800739. time_taken: 115.178104400635"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.004257271 -1.030346043 -0.319487538  0.837037435  0.808007614
[6]  0.619826092
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.08938223
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           0.10842844
X.4           0.07051400
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.48444171
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.24973070
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.14606933
X.10_spline1  .         
X.10_spline2 -0.41534402
X.10_spline3  0.03140766
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02583195
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02567835
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.75279422
              0.84463383
[1] "beta_CATE: "
[1] 0.7527942 0.8446338
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0893822291436472; time_taken: 57.8089354038239"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.03102664 -0.99407745 -0.34553885  0.79979625  0.85440690  0.56067687
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.05391528
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           0.05745440
X.4           0.03773498
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.55903597
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.29995177
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.16534378
X.10_spline1  .         
X.10_spline2 -0.35185176
X.10_spline3  0.11378616
V41           .         
V42           .         
V43           .         
V44           .         
V45           .         
V46           .         
V47           .         
V48           .         
V49           .         
V50           0.02253976
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.69566444
X.2           .         
X.3           0.17560924
X.4           0.02741375
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.81718699
[1] "beta_CATE: "
 [1] 0.00000000 0.69566444 0.00000000 0.17560924 0.02741375 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.81718699
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0539152762524415; time_taken: 65.1501529216766"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.04518794 -1.15782719 -0.44381788  0.73747858  0.51937807  0.42622869
[1] "head(CATE_true)"
[1] -0.1113816 -1.2521368 -0.4750524  0.9699397  1.1759188  0.7329932
[1] 0.1106426
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.02380004
X.2           .         
X.3           0.12267943
X.4           0.03900807
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.23454980
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.31469764
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.02321237
X.10_spline1  .         
X.10_spline2 -0.14699083
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.62824574
X.2           .         
X.3           0.10307302
X.4           0.03026903
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.73117544
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  0.79516031
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02781984
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "beta_CATE: "
 [1] 0.00000000 0.62824574 0.00000000 0.10307302 0.03026903 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.73117544 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.79516031 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.02781984 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.110642600616764; time_taken: 116.372976303101"
Time to run lasso model: 454.674181699753 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.05957927

$`S_lasso_correctly-specified_linear-only`
[1] 0.07488391

$`S_lasso_linear_linear-only`
[1] 0.1958391

$`S_lasso_flexible_linear-only`
[1] 0.113768

$`T_lasso_mild-complex`
[1] 0.12498

$`S_lasso_correctly-specified_mild-complex`
[1] 0.08938223

$`S_lasso_linear_mild-complex`
[1] 0.05391528

$`S_lasso_flexible_mild-complex`
[1] 0.1106426

Results for iteration 22 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_22-seed_365.csv
There were 50 or more warnings (use warnings() to see the first 50)
