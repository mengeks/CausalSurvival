Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 51
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 51: 684
Loaded dataset 51 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_51_n_500.rds 
Time to load dataset: 0.0396084785461426 seconds
Loaded dataset 151 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_151_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.10721396
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6  -0.05344144
X.7   .         
X.8   .         
X.9   .         
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.96049005
X.2  .         
X.3  .         
X.4  0.02613895
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.12953720
X.10 0.95283332
[1] "head(CATE_est)"
              1
[1,]  0.6755900
[2,]  0.6951628
[3,] -0.7673137
[4,]  0.4942073
[5,] -0.5591452
[6,] -0.1059488
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] "config_name: T_lasso_linear-only. MSE: 0.0248098095392019. time_taken: 27.001969575882"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.61981381  0.61974361 -0.77843985  0.32429006 -0.54076996  0.03760189
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.05209536
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.23877233
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6  -0.04855755
X.7   .         
X.8   .         
X.9   0.06088605
X.10  .         
      0.76575796
      1.04959455
[1] "beta_CATE: "
[1] 0.765758 1.049595
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0520953608518179; time_taken: 16.1428456306458"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.67849295  0.54452655 -0.74345382  0.35436182 -0.59677439  0.06229572
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.06747407
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.19398390
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.72066965
X.2          .         
X.3          .         
X.4          0.01347384
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          0.13687601
X.10         0.90052836
[1] "beta_CATE: "
 [1] 0.00000000 0.72066965 0.00000000 0.00000000 0.01347384 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.13687601 0.90052836
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0674740668592392; time_taken: 21.9305000305176"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.6880983  0.5571485 -0.8854129  0.4124689 -0.7749331  0.1508207
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.06691403
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.24845925
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6  -0.07022048
X.7   .         
X.8   .         
X.9   .         
X.10  .         
      .         
X.1   0.70396591
X.2   .         
X.3   .         
X.4   0.06551038
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   0.16877419
X.10  0.93881838
[1] "beta_CATE: "
 [1] 0.00000000 0.70396591 0.00000000 0.00000000 0.06551038 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.16877419 0.93881838
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0669140312420393; time_taken: 21.178190946579"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
             -0.02255937
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.72878581
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           0.08853039
X.10          0.74103340
X.1_spline1   0.38316941
X.1_spline2  -0.97960905
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.09742592
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   0.04046921
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   0.06511273
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  1.35340251
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.11541906
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
               1
[1,] -0.12952041
[2,] -0.03760572
[3,] -0.91356095
[4,] -0.14175416
[5,] -0.65065535
[6,] -0.58026814
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] "config_name: T_lasso_mild-complex. MSE: 0.393526036861353. time_taken: 150.476156711578"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.58204540  0.82076251 -0.25767604  0.63247283  0.01537256 -0.58472770
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.01823496
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.028446764
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.021080196
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.552413078
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.459534435
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.005310968
             -0.122302127
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.048336283
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.071816243
              .          
              .          
              .          
              .          
              .          
              0.013458676
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              1.003373902
              0.856177119
[1] "beta_CATE: "
[1] 1.0033739 0.8561771
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0182349573242886; time_taken: 70.5685424804688"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.65884354  0.77129700 -0.28748123  0.64213659 -0.08478604 -0.51694626
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.01381822
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0355161613
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.0230168812
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.2178935361
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  0.7556161004
V41           .           
V42           .           
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           .           
V49           .           
V50           .           
V51          -0.1153098045
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57          -0.0003682163
V58           .           
V59           .           
V60           .           
V61           .           
V62           0.0410698502
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           0.0663647265
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           0.0129750129
V81           .           
V82           .           
V83           .           
V84           .           
V85           0.0057131809
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           0.0056183235
V95           .           
train_data$W  .           
X.1           0.9759567274
X.2           .           
X.3           0.0079961932
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           0.1138835651
X.10          0.7837480714
[1] "beta_CATE: "
 [1] 0.000000000 0.975956727 0.000000000 0.007996193 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.113883565 0.783748071
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0138182237779662; time_taken: 73.4258863925934"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.59086141  0.65814234 -0.27121778  0.57121318  0.02261127 -0.37677347
[1] "head(CATE_true)"
[1]  0.6451146  0.8155408 -0.4722425  0.5716903 -0.1892683 -0.4035916
[1] 0.03913388
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.031959494
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.111091539
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.074248999
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.009992517
              .          
              .          
              .          
              .          
              .          
              0.015129275
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.032786279
              .          
              .          
X.1           0.907200129
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.091878132
X.10          0.802566969
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   0.028623014
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   0.013149148
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   0.038255676
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.032289956
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.106721707
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.00000000 0.90720013 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.09187813 0.80256697 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.02862301
[19] 0.00000000 0.00000000 0.01314915 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.03825568 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.03228996 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.10672171 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0391338833982132; time_taken: 117.552733182907"
Time to run lasso model: 500.24586725235 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.02480981

$`S_lasso_correctly-specified_linear-only`
[1] 0.05209536

$`S_lasso_linear_linear-only`
[1] 0.06747407

$`S_lasso_flexible_linear-only`
[1] 0.06691403

$`T_lasso_mild-complex`
[1] 0.393526

$`S_lasso_correctly-specified_mild-complex`
[1] 0.01823496

$`S_lasso_linear_mild-complex`
[1] 0.01381822

$`S_lasso_flexible_mild-complex`
[1] 0.03913388

Results for iteration 51 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_51-seed_684.csv
There were 50 or more warnings (use warnings() to see the first 50)
