Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 56
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 56: 739
Loaded dataset 56 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_56_n_500.rds 
Time to load dataset: 0.0143623352050781 seconds
Loaded dataset 156 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_156_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.05410838
X.2   0.23002908
X.3   0.20729914
X.4   .         
X.5  -0.28131458
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   1.16383770
X.2  -0.41273615
X.3   0.20841542
X.4   0.02019212
X.5   .         
X.6   0.22415523
X.7  -0.39474278
X.8   0.24340279
X.9   .         
X.10  0.97154079
[1] "head(CATE_est)"
              1
[1,] -2.3007287
[2,]  0.7809567
[3,]  0.9479668
[4,]  2.1088647
[5,] -2.5969152
[6,]  0.9016154
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] "config_name: T_lasso_linear-only. MSE: 0.164792981140756. time_taken: 35.5266304016113"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.2908760  0.5299959  0.4816605  1.4918322 -2.2530339  0.8633380
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.1310446
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.18660943
X.2  .         
X.3  0.02083705
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     0.66854446
     0.93006355
[1] "beta_CATE: "
[1] 0.6685445 0.9300636
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.131044595818691; time_taken: 16.9631626605988"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.4157916  0.8487844  0.8434764  2.0594232 -2.4278420  1.0538503
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.136234
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.203052815
X.2           .          
X.3           0.243277526
X.4           .          
X.5          -0.205102218
X.6           .          
X.7          -0.102345268
X.8           .          
X.9          -0.003844599
X.10          .          
train_data$W -0.018844111
X.1           0.920122127
X.2          -0.407342182
X.3           .          
X.4           .          
X.5           0.212763562
X.6           0.185036364
X.7          -0.209478961
X.8           0.195218803
X.9           .          
X.10          0.956840835
[1] "beta_CATE: "
 [1] -0.01884411  0.92012213 -0.40734218  0.00000000  0.00000000  0.21276356
 [7]  0.18503636 -0.20947896  0.19521880  0.00000000  0.95684083
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.136233989724773; time_taken: 28.4222884178162"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.4157916  0.8487844  0.8434764  2.0594232 -2.4278420  1.0538503
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.136234
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.203052815
X.2   .          
X.3   0.243277526
X.4   .          
X.5  -0.205102218
X.6   .          
X.7  -0.102345268
X.8   .          
X.9  -0.003844599
X.10  .          
     -0.018844111
X.1   0.920122127
X.2  -0.407342182
X.3   .          
X.4   .          
X.5   0.212763562
X.6   0.185036364
X.7  -0.209478961
X.8   0.195218803
X.9   .          
X.10  0.956840835
[1] "beta_CATE: "
 [1] -0.01884411  0.92012213 -0.40734218  0.00000000  0.00000000  0.21276356
 [7]  0.18503636 -0.20947896  0.19521880  0.00000000  0.95684083
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.136233989724773; time_taken: 27.7333471775055"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.604213447
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   0.008051983
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
             -0.028873739
              .          
              .          
              0.003777018
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.063014560
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.833289705
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.725691455
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.111004477
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   0.254523964
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   0.050172780
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   0.301029524
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.680064241
              .          
             -0.037217544
              .          
              .          
              0.010570311
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.009978939
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.007937826
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -2.6234064
[2,]  0.2255724
[3,]  0.1560151
[4,]  1.2059596
[5,] -2.4150123
[6,]  0.5817536
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] "config_name: T_lasso_mild-complex. MSE: 0.214050959939337. time_taken: 125.170791387558"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.4067483  0.4544120  0.5216031  1.5463988 -2.3474017  0.8649195
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.08266707
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.12747944
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.30516913
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.10489629
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.06068188
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2  -0.03925249
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
             -0.08146266
              .         
              .         
              0.10854514
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.74437386
              0.92294379
[1] "beta_CATE: "
[1] 0.7443739 0.9229438
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0826670668022417; time_taken: 60.2016706466675"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.4428069  0.4493838  0.5312190  1.5671525 -2.3803065  0.8730128
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.07206508
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.12265761
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.31615038
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.08218851
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2  -0.04180467
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2  -0.06228652
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
V41           .         
V42          -0.09099666
V43           .         
V44           .         
V45           0.11568525
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           .         
V57           .         
V58           .         
V59           .         
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           .         
V93           .         
V94           .         
V95           .         
train_data$W  .         
X.1           0.76038313
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.93051049
[1] "beta_CATE: "
 [1] 0.0000000 0.7603831 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.9305105
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0720650784522343; time_taken: 71.6255645751953"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.2938217  0.4363861  0.3935494  1.4203956 -2.2306670  0.7719170
[1] "head(CATE_true)"
[1] -2.9265593  0.3213888  0.6694347  1.8332275 -2.8101658  0.9567079
[1] 0.1392154
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.161408925
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   0.338806895
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.156442392
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
             -0.056233571
              .          
              .          
              0.091925685
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.680052570
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.850779670
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   0.016440747
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   0.008573747
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.339448485
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.005893254
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.000000000 0.680052570 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.850779670 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.016440747 0.000000000 0.000000000 0.008573747
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.339448485 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.005893254 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.139215373368585; time_taken: 113.498995780945"
Time to run lasso model: 481.152974843979 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.164793

$`S_lasso_correctly-specified_linear-only`
[1] 0.1310446

$`S_lasso_linear_linear-only`
[1] 0.136234

$`S_lasso_flexible_linear-only`
[1] 0.136234

$`T_lasso_mild-complex`
[1] 0.214051

$`S_lasso_correctly-specified_mild-complex`
[1] 0.08266707

$`S_lasso_linear_mild-complex`
[1] 0.07206508

$`S_lasso_flexible_mild-complex`
[1] 0.1392154

Results for iteration 56 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_56-seed_739.csv
There were 50 or more warnings (use warnings() to see the first 50)
