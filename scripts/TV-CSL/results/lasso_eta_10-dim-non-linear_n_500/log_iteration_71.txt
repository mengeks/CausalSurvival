Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 71
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 71: 904
Loaded dataset 71 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_71_n_500.rds 
Time to load dataset: 0.0308337211608887 seconds
Loaded dataset 171 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_171_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  .        
X.2  0.1446072
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.9210241
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  0.1768882
X.10 0.9348944
[1] "head(CATE_est)"
              1
[1,] -0.8124424
[2,] -1.4701295
[3,] -1.1997166
[4,] -1.6817935
[5,]  0.1464291
[6,]  1.3327832
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] "config_name: T_lasso_linear-only. MSE: 0.0438577786123412. time_taken: 32.5634729862213"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.8745576 -1.3610935 -1.0570873 -1.8284685  0.1291409  1.1679794
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.04014239
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.10262024
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.06722881
X.9  .         
X.10 .         
     0.79401994
     1.02862252
[1] "beta_CATE: "
[1] 0.7940199 1.0286225
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0401423895187011; time_taken: 15.7028691768646"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.8409246 -1.4206758 -1.0767061 -1.7111770  0.1288811  1.2039987
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.0444173
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.11043512
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          0.02379151
X.9          .         
X.10         .         
train_data$W .         
X.1          0.77439506
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          0.14041379
X.10         0.91935578
[1] "beta_CATE: "
 [1] 0.0000000 0.7743951 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.1404138 0.9193558
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0444173028670238; time_taken: 28.0697250366211"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8386255 -1.4163630 -1.0712773 -1.7073179  0.1308753  1.2013238
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.04471886
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.10781762
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.02203483
X.9  .         
X.10 .         
     .         
X.1  0.77297860
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.14040100
X.10 0.91491281
[1] "beta_CATE: "
 [1] 0.0000000 0.7729786 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.1404010 0.9149128
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0447188592796793; time_taken: 27.5046849250793"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   0.01510690
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
             -0.03739133
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.81081959
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          0.10305690
X.10         0.61388451
X.1_spline1  0.10682731
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  .         
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  .         
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  0.20197761
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 1.44355025
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.15627736
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.01697481
             .         
             .         
             .         
             .         
             .         
             .         
[1] "head(CATE_est)"
               1
[1,] -1.26359414
[2,] -1.53290478
[3,] -0.96077751
[4,] -2.11259997
[5,]  0.01550809
[6,]  0.91321411
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] "config_name: T_lasso_mild-complex. MSE: 0.150508287003706. time_taken: 147.319111824036"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.8924943 -1.2912340 -0.7218755 -1.9932943  0.4468204  1.2463262
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.04464375
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0001955908
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.0470289217
X.9           .           
X.10          .           
X.1_spline1   0.2112353471
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   0.6501406771
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   0.0048286267
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.9913929675
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  0.4160548993
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0595836433
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0986381775
              0.0081416625
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0692392082
              .           
              .           
              .           
              .           
              .           
              .           
              0.9009917859
              0.8141788450
[1] "beta_CATE: "
[1] 0.9009918 0.8141788
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0446437452466427; time_taken: 83.7754228115082"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.9018413 -1.3784347 -0.7332876 -1.9934086  0.4921755  1.3273863
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.02968482
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.033741983
X.9           .          
X.10          .          
X.1_spline1   0.253155060
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   0.629944977
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   0.419453626
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   0.108693070
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.012295211
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.495381492
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.707267507
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57          -0.092302969
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           0.144742042
V80           0.005982777
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           0.070832749
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.929410302
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.106873037
X.10          0.741914568
[1] "beta_CATE: "
 [1] 0.0000000 0.9294103 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.1068730 0.7419146
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.029684817441132; time_taken: 82.77712225914"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8532058 -1.1586602 -0.7167745 -1.8822790  0.3965306  1.2896043
[1] "head(CATE_true)"
[1] -1.0178311 -1.5022406 -0.9315624 -2.2345803  0.4139627  1.4048460
[1] 0.07306355
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.222485004
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   0.501826047
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.550549305
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.214661944
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.032402934
              .          
              .          
              .          
              .          
              .          
              .          
             -0.028485047
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.045185390
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.845569805
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.099983693
X.10          0.745853388
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.052492199
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.125106445
              0.032281886
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.003867545
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.000000000 0.845569805 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.099983693 0.745853388 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.052492199 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.125106445 0.032281886 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.003867545
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0730635504274882; time_taken: 116.589691400528"
Time to run lasso model: 536.297180175781 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.04385778

$`S_lasso_correctly-specified_linear-only`
[1] 0.04014239

$`S_lasso_linear_linear-only`
[1] 0.0444173

$`S_lasso_flexible_linear-only`
[1] 0.04471886

$`T_lasso_mild-complex`
[1] 0.1505083

$`S_lasso_correctly-specified_mild-complex`
[1] 0.04464375

$`S_lasso_linear_mild-complex`
[1] 0.02968482

$`S_lasso_flexible_mild-complex`
[1] 0.07306355

Results for iteration 71 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_71-seed_904.csv
There were 50 or more warnings (use warnings() to see the first 50)
