Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 8
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 8: 211
Loaded dataset 8 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_8_n_500.rds 
Time to load dataset: 0.00292563438415527 seconds
Loaded dataset 108 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_108_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.74506790
X.2  .         
X.3  .         
X.4  0.06290047
X.5  .         
X.6  .         
X.7  .         
X.8  0.10004449
X.9  0.02140718
X.10 0.78561062
[1] "head(CATE_est)"
              1
[1,] -2.2757800
[2,]  2.5440490
[3,] -0.9383134
[4,]  0.3678356
[5,] -1.3600896
[6,] -0.5508860
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] "config_name: T_lasso_linear-only. MSE: 0.0557187262212627. time_taken: 25.453818321228"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.0502384  2.3045434 -1.0486544  0.4538799 -1.0772472 -0.3253432
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.1620121
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.148286860
X.2   .          
X.3   0.115691170
X.4   .          
X.5  -0.118485739
X.6   0.001232107
X.7   .          
X.8   0.104713911
X.9   .          
X.10 -0.123675541
      0.606720902
      0.980359882
[1] "beta_CATE: "
[1] 0.6067209 0.9803599
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.16201209658464; time_taken: 15.6981065273285"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.8853301  2.2345665 -0.9330558  0.3099727 -1.1522164 -0.3307097
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.1775545
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.162070940
X.2          .          
X.3          0.002989487
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
train_data$W .          
X.1          0.559627918
X.2          .          
X.3          .          
X.4          0.054803318
X.5          .          
X.6          .          
X.7          .          
X.8          0.094363170
X.9          0.014468370
X.10         0.771499697
[1] "beta_CATE: "
 [1] 0.00000000 0.55962792 0.00000000 0.00000000 0.05480332 0.00000000
 [7] 0.00000000 0.00000000 0.09436317 0.01446837 0.77149970
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.177554530894562; time_taken: 23.0253303050995"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.9040098  2.3335254 -0.9854188  0.2849732 -1.2048661 -0.2907968
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.1738839
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.19055413
X.2   .         
X.3   0.04155086
X.4   .         
X.5  -0.07698698
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
      .         
X.1   0.53628880
X.2   .         
X.3   .         
X.4   0.08384349
X.5   .         
X.6   .         
X.7   .         
X.8   0.11236933
X.9   0.01733551
X.10  0.79240823
[1] "beta_CATE: "
 [1] 0.00000000 0.53628880 0.00000000 0.00000000 0.08384349 0.00000000
 [7] 0.00000000 0.00000000 0.11236933 0.01733551 0.79240823
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.173883881392317; time_taken: 22.8371214866638"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.67504788
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.55890709
X.1_spline1   0.11445192
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   0.22241516
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2  -0.06731961
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2  -1.10032354
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.40719325
X.10_spline1  0.14757389
X.10_spline2 -0.05466272
X.10_spline3  1.11545409
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.06178058
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.09080323
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.03362281
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -3.0090587
[2,]  1.9862011
[3,] -1.6248486
[4,] -0.5430707
[5,] -2.0856795
[6,] -1.6162417
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] "config_name: T_lasso_mild-complex. MSE: 0.877050269719678. time_taken: 125.73471736908"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.1254206  2.1509067 -0.7661253  0.4414724 -1.0972407 -0.6038357
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.126362
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           0.050059510
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           0.002695353
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.232288495
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   0.025710482
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.107235531
X.10_spline3  0.296658790
             -0.052478541
              .          
              .          
              .          
              0.020964327
              .          
              .          
              .          
              0.082840751
              .          
             -0.038418519
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.018544383
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.016911154
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.016841703
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.748826184
              0.754017121
[1] "beta_CATE: "
[1] 0.7488262 0.7540171
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.126362044831935; time_taken: 66.1012969017029"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.0845572  2.2090713 -0.7637950  0.3693924 -1.1581261 -0.5712469
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.1263231
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.010189073
X.2           .          
X.3           0.018740286
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.230487122
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.320120179
V41          -0.057256760
V42           .          
V43           .          
V44           .          
V45           0.001319464
V46           .          
V47           .          
V48           .          
V49           0.082133814
V50           .          
V51          -0.015014312
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           0.005494563
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           0.021218470
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           0.013856905
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.705963414
X.2           .          
X.3           .          
X.4           0.054878165
X.5           .          
X.6           .          
X.7           .          
X.8           0.039283958
X.9           .          
X.10          0.707658750
[1] "beta_CATE: "
 [1] 0.00000000 0.70596341 0.00000000 0.00000000 0.05487817 0.00000000
 [7] 0.00000000 0.00000000 0.03928396 0.00000000 0.70765875
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.126323098031999; time_taken: 67.3825147151947"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.7995228  2.2226819 -0.7910402  0.2958003 -1.0248900 -0.5425926
[1] "head(CATE_true)"
[1] -2.8321788  2.8618291 -1.0150721  0.5877478 -1.4617489 -0.8094517
[1] 0.202026
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.047559436
X.2           .          
X.3           0.002854643
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.307143953
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.247992742
             -0.040970706
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.076163779
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.605101525
X.2           .          
X.3           .          
X.4           0.063537243
X.5           .          
X.6           .          
X.7           .          
X.8           0.026911366
X.9           .          
X.10          0.673517334
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.170612738
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.069513812
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.016880509
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.00000000 0.60510153 0.00000000 0.00000000 0.06353724 0.00000000
 [7] 0.00000000 0.00000000 0.02691137 0.00000000 0.67351733 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.17061274 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.06951381
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.01688051 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.202026041046591; time_taken: 116.955898761749"
Time to run lasso model: 464.927805423737 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.05571873

$`S_lasso_correctly-specified_linear-only`
[1] 0.1620121

$`S_lasso_linear_linear-only`
[1] 0.1775545

$`S_lasso_flexible_linear-only`
[1] 0.1738839

$`T_lasso_mild-complex`
[1] 0.8770503

$`S_lasso_correctly-specified_mild-complex`
[1] 0.126362

$`S_lasso_linear_mild-complex`
[1] 0.1263231

$`S_lasso_flexible_mild-complex`
[1] 0.202026

Results for iteration 8 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_8-seed_211.csv
There were 50 or more warnings (use warnings() to see the first 50)
