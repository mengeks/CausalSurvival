Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 76
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 76: 959
Loaded dataset 76 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_76_n_500.rds 
Time to load dataset: 0.022904634475708 seconds
Loaded dataset 176 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_176_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.4044570
X.2   .        
X.3  -0.3929228
X.4   .        
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   .        
X.10  .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.790050573
X.2  0.008978615
X.3  0.007823906
X.4  .          
X.5  0.190577624
X.6  .          
X.7  0.092248269
X.8  .          
X.9  0.003513662
X.10 0.862742659
[1] "head(CATE_est)"
              1
[1,]  2.9249420
[2,]  1.4774304
[3,] -0.4017189
[4,] -3.4368078
[5,] -1.3859640
[6,] -0.8835269
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] "config_name: T_lasso_linear-only. MSE: 0.155799972940795. time_taken: 34.6814460754395"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  2.3761930  1.5753090  0.1360662 -2.5229759 -1.4222750 -0.9971235
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.09301065
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.1211499
X.2  .        
X.3  .        
X.4  .        
X.5  0.0736173
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.7085450
     0.9427947
[1] "beta_CATE: "
[1] 0.7085450 0.9427947
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0930106533440385; time_taken: 16.4507303237915"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  2.8602143  1.4935439 -0.5100506 -3.6674477 -1.3573786 -0.8138107
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.1932541
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.4930187714
X.2           .           
X.3          -0.4111532684
X.4          -0.0313052996
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
train_data$W -0.0162357939
X.1           0.3226949174
X.2           0.0006821683
X.3           0.4288171477
X.4           .           
X.5           0.2538253970
X.6          -0.0953969849
X.7           0.1320774156
X.8           .           
X.9           0.0215874124
X.10          0.8710229790
[1] "beta_CATE: "
 [1] -0.0162357939  0.3226949174  0.0006821683  0.4288171477  0.0000000000
 [6]  0.2538253970 -0.0953969849  0.1320774156  0.0000000000  0.0215874124
[11]  0.8710229790
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.193254145360527; time_taken: 25.873117685318"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  2.8209674  1.4642047 -0.4768199 -3.5365402 -1.3781764 -0.8182515
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.1704359
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.451634253
X.2   .          
X.3  -0.355968948
X.4  -0.035306118
X.5   .          
X.6   .          
X.7   .          
X.8   .          
X.9   .          
X.10  .          
     -0.016664002
X.1   0.359134622
X.2   0.002691781
X.3   0.373222652
X.4   .          
X.5   0.236904565
X.6  -0.055938756
X.7   0.109334479
X.8   .          
X.9   0.021070170
X.10  0.867621754
[1] "beta_CATE: "
 [1] -0.016664002  0.359134622  0.002691781  0.373222652  0.000000000
 [6]  0.236904565 -0.055938756  0.109334479  0.000000000  0.021070170
[11]  0.867621754
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.170435947600745; time_taken: 25.0772342681885"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -1.04103517
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.29151968
X.10_spline3  .         
             -0.17184483
              .         
              0.11237664
              .         
              0.01238638
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.64453560
X.2           .         
X.3           .         
X.4           .         
X.5           0.12583232
X.6           .         
X.7           0.06864808
X.8           .         
X.9           .         
X.10          0.75543935
X.1_spline1   0.18083555
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   0.18830718
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   0.02664691
X.3_spline2  -0.89525212
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.59504131
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.01456749
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  3.3277723
[2,]  1.6252662
[3,]  0.3130068
[4,] -2.3848809
[5,] -1.1406109
[6,] -0.6759692
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] "config_name: T_lasso_mild-complex. MSE: 0.162623781917087. time_taken: 141.393671751022"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  2.7020763  1.4883063  0.2852867 -2.2455548 -1.5618488 -1.2119535
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.04873925
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   0.087903259
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.617564758
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -1.441677569
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.173850981
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
             -0.110510561
              .          
              0.001662258
              .          
              0.005788851
              .          
              .          
              .          
              0.014296974
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.033527286
              .          
              0.004117551
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.026182976
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.842121654
              0.866133572
[1] "beta_CATE: "
[1] 0.8421217 0.8661336
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0487392485209204; time_taken: 71.1935031414032"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  2.8919214  1.4362571  0.1578991 -2.3452702 -1.6541660 -1.1893012
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.03383926
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2  -0.483310738
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.755928210
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
V41          -0.109050777
V42           .          
V43           0.014696937
V44           .          
V45           0.018443900
V46           .          
V47           .          
V48           .          
V49           0.009631637
V50           0.005555823
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           0.015230671
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           0.038536312
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.824409360
X.2           .          
X.3           .          
X.4           .          
X.5           0.032537222
X.6           .          
X.7           0.096531018
X.8           .          
X.9           0.054737883
X.10          0.773220472
[1] "beta_CATE: "
 [1] 0.00000000 0.82440936 0.00000000 0.00000000 0.00000000 0.03253722
 [7] 0.00000000 0.09653102 0.00000000 0.05473788 0.77322047
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0338392563929509; time_taken: 72.5949759483337"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  2.73192560  1.38696637  0.05831559 -2.21957487 -1.65870886 -1.20815335
[1] "head(CATE_true)"
[1]  3.1949700  1.7242916  0.3526213 -2.5821400 -1.8402505 -1.4421762
[1] 0.05040223
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0324240076
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2  -0.5535949135
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.7739475962
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
             -0.0990009668
              .           
              0.0001124372
              .           
              0.0074075252
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0326286058
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0358566923
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.7852990400
X.2           .           
X.3           .           
X.4           .           
X.5           0.0355899018
X.6           .           
X.7           0.0969657740
X.8           .           
X.9           0.0077174094
X.10          0.7814347053
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.3014540091
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0093225076
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1] 0.000000000 0.785299040 0.000000000 0.000000000 0.000000000 0.035589902
 [7] 0.000000000 0.096965774 0.000000000 0.007717409 0.781434705 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.301454009 0.000000000 0.000000000 0.000000000 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.009322508 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0504022341269618; time_taken: 125.586830854416"
Time to run lasso model: 514.821152448654 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1558

$`S_lasso_correctly-specified_linear-only`
[1] 0.09301065

$`S_lasso_linear_linear-only`
[1] 0.1932541

$`S_lasso_flexible_linear-only`
[1] 0.1704359

$`T_lasso_mild-complex`
[1] 0.1626238

$`S_lasso_correctly-specified_mild-complex`
[1] 0.04873925

$`S_lasso_linear_mild-complex`
[1] 0.03383926

$`S_lasso_flexible_mild-complex`
[1] 0.05040223

Results for iteration 76 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_76-seed_959.csv
There were 50 or more warnings (use warnings() to see the first 50)
