Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 78
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 78: 981
Loaded dataset 78 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_78_n_500.rds 
Time to load dataset: 0.0499310493469238 seconds
Loaded dataset 178 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_178_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.13101162
X.2   .         
X.3   .         
X.4   .         
X.5  -0.10428234
X.6   .         
X.7  -0.09006317
X.8  -0.03713056
X.9   .         
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.7116644
X.2  0.1105792
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  0.1955189
X.10 0.8485747
[1] "head(CATE_est)"
              1
[1,]  0.9203969
[2,] -1.4483890
[3,] -0.9393370
[4,] -0.6007485
[5,]  0.0895382
[6,]  0.4475502
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] "config_name: T_lasso_linear-only. MSE: 0.110762156895614. time_taken: 31.5353252887726"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.94304756 -0.82140299 -0.49092325 -0.59865600  0.08105866  0.58440075
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.05361407
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.01335699
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     0.75916270
     0.98985729
[1] "beta_CATE: "
[1] 0.7591627 0.9898573
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.053614071946681; time_taken: 18.2338321208954"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.00872262 -1.19641320 -0.64855686 -0.59333329  0.06249822  0.49994392
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.0660678
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.07884406
X.2           .         
X.3           .         
X.4           .         
X.5          -0.10302544
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W  .         
X.1           0.62060587
X.2           0.13452249
X.3           .         
X.4           .         
X.5           .         
X.6           0.05230068
X.7           0.01069176
X.8           .         
X.9           0.19478295
X.10          0.86324703
[1] "beta_CATE: "
 [1] 0.00000000 0.62060587 0.13452249 0.00000000 0.00000000 0.00000000
 [7] 0.05230068 0.01069176 0.00000000 0.19478295 0.86324703
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0660677969446958; time_taken: 21.8427379131317"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.01584529 -1.24976614 -0.67035759 -0.59446312  0.06917031  0.49754150
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.07103669
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.092376275
X.2   .          
X.3   .          
X.4   .          
X.5  -0.122673042
X.6   .          
X.7   .          
X.8   .          
X.9   .          
X.10  .          
      .          
X.1   0.611488715
X.2   0.138138708
X.3   .          
X.4   .          
X.5   .          
X.6   0.069049247
X.7   0.009731591
X.8   .          
X.9   0.195374716
X.10  0.869100614
[1] "beta_CATE: "
 [1] 0.000000000 0.611488715 0.138138708 0.000000000 0.000000000 0.000000000
 [7] 0.069049247 0.009731591 0.000000000 0.195374716 0.869100614
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0710366939781536; time_taken: 21.2112822532654"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2  -0.276082968
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.061989151
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.071651910
              0.008250809
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.6600498706
X.2           0.1485772315
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           0.0412239628
X.9           0.0320351953
X.10          0.8454164030
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.0774075400
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   1.1261906622
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2  -1.2819486397
X.9_spline3   0.5239488213
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
             -0.1153193199
              0.0583091482
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0877403054
              .           
              0.0339612456
              .           
              .           
              0.0002000517
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "head(CATE_est)"
               1
[1,]  0.96631931
[2,] -1.97973447
[3,] -0.90587196
[4,] -0.72972136
[5,] -0.03666799
[6,]  0.40229811
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] "config_name: T_lasso_mild-complex. MSE: 0.0744659266464626. time_taken: 141.219912528992"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.84913850 -0.75673326 -0.46932115 -0.54223652  0.07064178  0.52493875
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.108138
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.029306977
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.095155493
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2  -0.742582802
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.030189349
              .          
              .          
              .          
              .          
              .          
              .          
              0.009772936
              .          
              .          
              .          
              .          
              .          
              0.058935957
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.674548068
              0.902930591
[1] "beta_CATE: "
[1] 0.6745481 0.9029306
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.108137974783451; time_taken: 67.1275930404663"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.88254105 -0.85987844 -0.49006136 -0.54168083  0.05924393  0.49274181
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.0969011
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.032920855
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.022179667
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2  -0.554578023
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           0.034133410
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           0.009471768
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           0.044915681
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           0.001667327
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.610432849
X.2           0.083004417
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.095622421
X.10          0.824946259
[1] "beta_CATE: "
 [1] 0.00000000 0.61043285 0.08300442 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.09562242 0.82494626
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.096901097667223; time_taken: 72.145932674408"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.87478835 -1.18981222 -0.55651062 -0.57705948  0.03531504  0.42869240
[1] "head(CATE_true)"
[1]  1.0967649 -0.7328955 -0.2166316 -0.6547480  0.1247237  0.6961134
[1] 0.1133985
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.092907401
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.037081566
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2  -0.863922433
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.030776467
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.081008470
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.008961376
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.579820423
X.2           0.111729491
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.093262213
X.10          0.831791816
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
             -0.064606569
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.018997228
              .          
              .          
              0.011730570
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.00000000  0.57982042  0.11172949  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.09326221  0.83179182  0.00000000
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000 -0.06460657  0.00000000  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.01899723  0.00000000  0.00000000  0.01173057
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.113398458570646; time_taken: 120.435200929642"
Time to run lasso model: 495.718010425568 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1107622

$`S_lasso_correctly-specified_linear-only`
[1] 0.05361407

$`S_lasso_linear_linear-only`
[1] 0.0660678

$`S_lasso_flexible_linear-only`
[1] 0.07103669

$`T_lasso_mild-complex`
[1] 0.07446593

$`S_lasso_correctly-specified_mild-complex`
[1] 0.108138

$`S_lasso_linear_mild-complex`
[1] 0.0969011

$`S_lasso_flexible_mild-complex`
[1] 0.1133985

Results for iteration 78 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_78-seed_981.csv
There were 50 or more warnings (use warnings() to see the first 50)
