Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 95
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 95: 1168
Loaded dataset 95 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_95_n_500.rds 
Time to load dataset: 0.0311925411224365 seconds
Loaded dataset 195 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_195_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   1.06329609
X.2   .         
X.3   .         
X.4   0.11530964
X.5   .         
X.6   .         
X.7  -0.11036515
X.8  -0.08899804
X.9   .         
X.10  1.13496412
[1] "head(CATE_est)"
              1
[1,] -1.5857005
[2,]  1.2344005
[3,] -2.0898845
[4,]  2.8897330
[5,]  0.3798977
[6,] -0.0516553
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] "config_name: T_lasso_linear-only. MSE: 0.020794613058365. time_taken: 31.6147100925446"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.4897082  1.1245547 -2.0429009  2.6124279  0.2982715  0.0802139
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.001471923
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  .          
X.2  0.002129799
X.3  .          
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 .          
     1.030066956
     0.973439494
[1] "beta_CATE: "
[1] 1.0300670 0.9734395
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.00147192318869199; time_taken: 17.4796876907349"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.46537027  1.07591892 -2.03855506  2.61172711  0.28107212  0.02752167
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.002317401
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.99659467
X.2          .         
X.3          .         
X.4          0.03626723
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         0.95068104
[1] "beta_CATE: "
 [1] 0.00000000 0.99659467 0.00000000 0.00000000 0.03626723 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.95068104
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.00231740060241123; time_taken: 26.7306761741638"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.46537027  1.07591892 -2.03855506  2.61172711  0.28107212  0.02752167
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.002317401
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.99659467
X.2  .         
X.3  .         
X.4  0.03626723
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 0.95068104
[1] "beta_CATE: "
 [1] 0.00000000 0.99659467 0.00000000 0.00000000 0.03626723 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.95068104
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.00231740060241123; time_taken: 26.901763677597"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           1.177840097
X.2           .          
X.3           .          
X.4           0.049203463
X.5           .          
X.6           .          
X.7          -0.201849925
X.8          -0.003843482
X.9           .          
X.10          1.016667881
X.1_spline1   .          
X.1_spline2   1.062652461
X.1_spline3   .          
X.2_spline1   0.290732770
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.272711387
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.116859880
X.6_spline2  -0.848946468
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3  -0.372851291
X.9_spline1   0.079822588
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  1.197530268
             -0.093760000
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.012621110
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.208136660
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.082736711
             -0.047863709
              .          
             -0.023213229
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.071194243
              0.157435925
              .          
              .          
              .          
              .          
              .          
             -0.120284272
              .          
             -0.036740427
              .          
             -0.021195270
              .          
              .          
[1] "head(CATE_est)"
               1
[1,] -1.53580303
[2,]  1.43663857
[3,] -2.10541019
[4,]  2.75711169
[5,]  0.51621935
[6,]  0.03174073
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] "config_name: T_lasso_mild-complex. MSE: 0.0921065117722184. time_taken: 141.181318998337"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.3752387  1.0426295 -1.9017336  2.4430351  0.2724534  0.0659996
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.01252215
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.004545178
             0.040165675
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.963470202
             0.902529297
[1] "beta_CATE: "
[1] 0.9634702 0.9025293
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0125221525959816; time_taken: 62.2078275680542"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.39781896  1.05409760 -1.94081230  2.49553137  0.27405346  0.05559358
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.007790347
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  0.026176017
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
V41          .          
V42          .          
V43          .          
V44          .          
V45          0.004623057
V46          .          
V47          .          
V48          .          
V49          .          
V50          .          
V51          .          
V52          .          
V53          .          
V54          .          
V55          .          
V56          .          
V57          .          
V58          .          
V59          .          
V60          .          
V61          .          
V62          .          
V63          .          
V64          .          
V65          .          
V66          .          
V67          .          
V68          .          
V69          .          
V70          .          
V71          .          
V72          .          
V73          .          
V74          .          
V75          .          
V76          .          
V77          .          
V78          .          
V79          .          
V80          0.013086508
V81          0.043274799
V82          .          
V83          .          
V84          .          
V85          .          
V86          .          
V87          .          
V88          .          
V89          .          
V90          .          
V91          .          
V92          .          
V93          .          
V94          .          
V95          .          
train_data$W .          
X.1          0.977401994
X.2          .          
X.3          .          
X.4          0.007422428
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.916415630
[1] "beta_CATE: "
 [1] 0.000000000 0.977401994 0.000000000 0.000000000 0.007422428 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.916415630
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.00779034672730962; time_taken: 76.6578598022461"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.3229752  1.0499394 -1.7080019  2.5743311  0.3076116  0.1029147
[1] "head(CATE_true)"
[1] -1.5713847  1.1552867 -2.0459199  2.5395642  0.3346088  0.1401108
[1] 0.05789961
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
X.1          0.932410472
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.878307507
X.1_spline1  0.006892675
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             0.068955308
             .          
             .          
             .          
             .          
             0.006206544
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.012678287
             .          
             .          
             0.031792856
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.011935356
             .          
             .          
             0.006570845
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
[1] "beta_CATE: "
 [1] 0.000000000 0.932410472 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.878307507 0.006892675
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.068955308 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.006206544 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.012678287
[61] 0.000000000 0.000000000 0.031792856 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.011935356 0.000000000 0.000000000 0.006570845
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0578996093158542; time_taken: 109.507736444473"
Time to run lasso model: 494.278057336807 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.02079461

$`S_lasso_correctly-specified_linear-only`
[1] 0.001471923

$`S_lasso_linear_linear-only`
[1] 0.002317401

$`S_lasso_flexible_linear-only`
[1] 0.002317401

$`T_lasso_mild-complex`
[1] 0.09210651

$`S_lasso_correctly-specified_mild-complex`
[1] 0.01252215

$`S_lasso_linear_mild-complex`
[1] 0.007790347

$`S_lasso_flexible_mild-complex`
[1] 0.05789961

Results for iteration 95 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_95-seed_1168.csv
There were 50 or more warnings (use warnings() to see the first 50)
