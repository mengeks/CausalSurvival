Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 55
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 55: 728
Loaded dataset 55 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_55_n_500.rds 
Time to load dataset: 0.0364270210266113 seconds
Loaded dataset 155 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_155_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.08060981
X.2   0.29673330
X.3   .         
X.4   0.09700065
X.5   .         
X.6   .         
X.7   0.16364784
X.8  -0.09893678
X.9   .         
X.10 -0.09410086
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.79341225
X.2  .         
X.3  .         
X.4  .         
X.5  0.02145482
X.6  .         
X.7  0.11811820
X.8  .         
X.9  .         
X.10 0.89963661
[1] "head(CATE_est)"
               1
[1,] -0.07245383
[2,] -1.07177863
[3,] -1.11574192
[4,] -2.02742135
[5,]  1.81703407
[6,]  0.82889692
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] "config_name: T_lasso_linear-only. MSE: 0.408581593252511. time_taken: 32.8240659236908"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.2496239 -1.5353440 -1.0636827 -1.8121892  1.7471082  1.1512804
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.1999803
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.22199063
X.2  .         
X.3  .         
X.4  0.02694147
X.5  .         
X.6  .         
X.7  0.07566341
X.8  .         
X.9  .         
X.10 .         
     0.56701701
     0.93720443
[1] "beta_CATE: "
[1] 0.5670170 0.9372044
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.199980323675644; time_taken: 16.2470731735229"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.2158638 -1.5501028 -1.1287784 -1.8338592  1.8450890  1.1114038
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.2055635
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.24344522
X.2          .         
X.3          .         
X.4          0.01548864
X.5          .         
X.6          .         
X.7          0.03142278
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.52184418
X.2          .         
X.3          .         
X.4          .         
X.5          0.01681021
X.6          .         
X.7          0.08175651
X.8          .         
X.9          .         
X.10         0.89904622
[1] "beta_CATE: "
 [1] 0.00000000 0.52184418 0.00000000 0.00000000 0.00000000 0.01681021
 [7] 0.00000000 0.08175651 0.00000000 0.00000000 0.89904622
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.205563483718255; time_taken: 30.3932955265045"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.03465373 -1.60893089 -1.24423039 -1.98570318  1.76156533  0.94522307
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.244358
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.29279158
X.2   .         
X.3   .         
X.4   0.03707047
X.5   .         
X.6   .         
X.7   0.04540122
X.8   .         
X.9   .         
X.10  .         
     -0.11680535
X.1   0.51359780
X.2   .         
X.3  -0.02073105
X.4   .         
X.5   0.01388484
X.6   .         
X.7   0.06857734
X.8   .         
X.9   .         
X.10  0.93213361
[1] "beta_CATE: "
 [1] -0.11680535  0.51359780  0.00000000 -0.02073105  0.00000000  0.01388484
 [7]  0.00000000  0.06857734  0.00000000  0.00000000  0.93213361
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.24435800404798; time_taken: 29.1071515083313"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           .        
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           .        
X.10          .        
X.1_spline1   .        
X.1_spline2   .        
X.1_spline3   .        
X.2_spline1   .        
X.2_spline2   .        
X.2_spline3   .        
X.3_spline1   .        
X.3_spline2   .        
X.3_spline3   .        
X.4_spline1   .        
X.4_spline2   .        
X.4_spline3   .        
X.5_spline1   .        
X.5_spline2   .        
X.5_spline3   .        
X.6_spline1   .        
X.6_spline2   .        
X.6_spline3   .        
X.7_spline1   .        
X.7_spline2   .        
X.7_spline3   .        
X.8_spline1   .        
X.8_spline2   .        
X.8_spline3   .        
X.9_spline1   .        
X.9_spline2   .        
X.9_spline3   .        
X.10_spline1  .        
X.10_spline2  .        
X.10_spline3  .        
              .        
             -0.1209276
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.660757891
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.079602201
X.8           .          
X.9           .          
X.10          0.832305272
X.1_spline1   0.093644622
X.1_spline2  -0.544082720
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   0.167331409
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.007045238
              .          
              .          
              .          
              .          
              0.021225204
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.030458475
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.009169151
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,]  0.5782246
[2,] -1.4398073
[3,] -1.3377887
[4,] -1.9903989
[5,]  1.3524059
[6,]  1.4440995
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] "config_name: T_lasso_mild-complex. MSE: 0.170098034777546. time_taken: 139.720576286316"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.5626048 -1.8776614 -1.0585942 -1.7710056  1.6151271  1.5682837
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.06316327
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0491884399
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           0.0485370433
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   0.1092407535
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   0.3450518445
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
             -0.0922713115
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0066026266
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0008103803
              .           
              .           
              .           
              .           
              .           
              .           
              0.0221413602
              .           
              .           
              .           
              .           
              .           
              0.0106999207
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.7741102086
              0.9117265788
[1] "beta_CATE: "
[1] 0.7741102 0.9117266
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0631632714222043; time_taken: 86.3166780471802"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.5509713 -1.9063317 -1.1221625 -1.8159989  1.7145901  1.5594850
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.05680064
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.065386075
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.015552213
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.131048972
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   0.308201131
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
V41           .          
V42          -0.092375299
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           0.008262417
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           0.014800258
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           0.010068716
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.755398069
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.068767685
X.8           .          
X.9           .          
X.10          0.898078062
[1] "beta_CATE: "
 [1] 0.00000000 0.75539807 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.06876768 0.00000000 0.00000000 0.89807806
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0568006362180729; time_taken: 82.0392239093781"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.5144069 -1.6737765 -1.1088711 -1.8169786  1.7516130  1.5278495
[1] "head(CATE_true)"
[1]  0.8339935 -2.3199850 -1.1772511 -1.9479561  1.7141918  2.0242347
[1] 0.08532787
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.064685286
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.001554031
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
             -0.092561452
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.002285752
              .          
              .          
              .          
              .          
              .          
              0.008919786
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.735665702
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.089187706
X.8           .          
X.9           .          
X.10          0.883827441
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   0.094559267
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              0.032708269
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.038470113
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.020845064
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.00000000 0.73566570 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.08918771 0.00000000 0.00000000 0.88382744 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.09455927 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.03270827 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.03847011 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.02084506 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0853278748265514; time_taken: 111.618380069733"
Time to run lasso model: 530.245544433594 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.4085816

$`S_lasso_correctly-specified_linear-only`
[1] 0.1999803

$`S_lasso_linear_linear-only`
[1] 0.2055635

$`S_lasso_flexible_linear-only`
[1] 0.244358

$`T_lasso_mild-complex`
[1] 0.170098

$`S_lasso_correctly-specified_mild-complex`
[1] 0.06316327

$`S_lasso_linear_mild-complex`
[1] 0.05680064

$`S_lasso_flexible_mild-complex`
[1] 0.08532787

Results for iteration 55 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_55-seed_728.csv
There were 50 or more warnings (use warnings() to see the first 50)
