Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 33
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 33: 486
Loaded dataset 33 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_33_n_500.rds 
Time to load dataset: 0.00510430335998535 seconds
Loaded dataset 133 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_133_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.1625149
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.77920638
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.09260711
X.9  0.02714560
X.10 0.83831159
[1] "head(CATE_est)"
                 1
[1,]  1.3443666530
[2,] -1.5389134442
[3,] -0.0002683326
[4,]  0.2922459068
[5,]  1.2698146419
[6,]  0.1880012515
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] "config_name: T_lasso_linear-only. MSE: 0.125281866972748. time_taken: 25.582023859024"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.34779383 -1.45801519  0.14718348  0.21423705  1.36203403  0.07945725
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1779279
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.23664965
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.02554136
X.9  .         
X.10 .         
     0.56996892
     0.92472084
[1] "beta_CATE: "
[1] 0.5699689 0.9247208
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.177927900734933; time_taken: 13.5069646835327"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.27662620 -1.38478227  0.07815316  0.24632421  1.19006214  0.20618943
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1771676
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.23378380
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.54184323
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          0.09922018
X.9          0.03191114
X.10         0.82890811
[1] "beta_CATE: "
 [1] 0.00000000 0.54184323 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.09922018 0.03191114 0.82890811
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.177167556429589; time_taken: 18.0861756801605"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.27662620 -1.38478227  0.07815316  0.24632421  1.19006214  0.20618943
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1771676
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.23378380
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.54184323
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  0.09922018
X.9  0.03191114
X.10 0.82890811
[1] "beta_CATE: "
 [1] 0.00000000 0.54184323 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.09922018 0.03191114 0.82890811
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.177167556429589; time_taken: 18.2563302516937"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
             -0.01913914
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.73241426
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.75411707
X.1_spline1   0.38687248
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   0.54605028
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1  -0.62124341
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   0.34763901
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.96343103
X.10_spline3  0.02681399
              .         
              .         
              .         
              .         
              .         
             -0.01231343
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.09651874
              .         
              0.03554365
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.22218339
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  1.2336769
[2,] -2.3995801
[3,] -0.6721384
[4,]  0.2213275
[5,]  1.1763806
[6,] -0.1196906
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] "config_name: T_lasso_mild-complex. MSE: 0.190511584973285. time_taken: 115.861769199371"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.35480523 -1.66657555 -0.07405623  0.30964826  1.38290204  0.05386089
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1311416
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.125621329
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.340604620
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.339616027
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1  -0.449177711
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   0.192565079
X.8_spline2  -0.961628403
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.011223562
X.10_spline3  .          
             -0.005913111
             -0.002882438
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.003953992
             -0.015585321
              .          
              .          
              .          
              .          
             -0.132682488
              .          
              0.016646715
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.188619921
              0.009840442
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.687497721
              0.827057271
[1] "beta_CATE: "
[1] 0.6874977 0.8270573
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.131141572949821; time_taken: 66.1820507049561"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.33984571 -1.63697169 -0.06086455  0.30097335  1.36686408  0.05471587
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1412249
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.1222925407
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.3486436048
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.2898495077
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1  -0.3682324533
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   0.1702356517
X.8_spline2  -0.9396497779
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2 -0.0116079304
X.10_spline3  .           
V41          -0.0029074753
V42          -0.0037004010
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           .           
V49           .           
V50           0.0005398318
V51          -0.0166039743
V52           .           
V53           .           
V54           .           
V55           .           
V56          -0.1147453671
V57           .           
V58           0.0024574871
V59           .           
V60           .           
V61           .           
V62           .           
V63           .           
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           0.1682719825
V73           0.0295615972
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W  .           
X.1           0.6735210276
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.8236366684
[1] "beta_CATE: "
 [1] 0.0000000 0.6735210 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.8236367
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.141224894361126; time_taken: 74.5424678325653"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.3127740 -1.8523560 -0.0974712  0.3431377  1.4382687  0.0754497
[1] "head(CATE_true)"
[1]  1.77991136 -2.35928881 -0.28483990  0.48646899  1.82846754  0.04878859
[1] 0.1641706
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.104908904
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.308841766
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.104349154
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   0.021367601
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.887708122
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
             -0.009321997
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.011668658
             -0.012941618
              .          
              .          
              .          
              .          
             -0.043351873
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.060554500
              0.025364967
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.697612127
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.778494133
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.204458650
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1  -0.478436465
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   0.108857218
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.197550014
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
             -0.031413633
              .          
              .          
              .          
              0.006052307
              .          
              .          
              .          
              .          
              .          
             -0.101380254
              .          
              0.036357290
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.150481837
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1]  0.000000000  0.697612127  0.000000000  0.000000000  0.000000000
 [6]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[11]  0.778494133  0.000000000  0.000000000  0.000000000  0.204458650
[16]  0.000000000  0.000000000 -0.478436465  0.000000000  0.000000000
[21]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[26]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[31]  0.000000000  0.000000000  0.108857218  0.000000000  0.000000000
[36]  0.000000000  0.000000000  0.000000000  0.197550014  0.000000000
[41]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[46]  0.000000000 -0.031413633  0.000000000  0.000000000  0.000000000
[51]  0.006052307  0.000000000  0.000000000  0.000000000  0.000000000
[56]  0.000000000 -0.101380254  0.000000000  0.036357290  0.000000000
[61]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[66]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[71]  0.000000000  0.000000000  0.150481837  0.000000000  0.000000000
[76]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[81]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[86]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[91]  0.000000000  0.000000000  0.000000000  0.000000000  0.000000000
[96]  0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.164170635347907; time_taken: 116.908438920975"
Time to run lasso model: 450.684181690216 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1252819

$`S_lasso_correctly-specified_linear-only`
[1] 0.1779279

$`S_lasso_linear_linear-only`
[1] 0.1771676

$`S_lasso_flexible_linear-only`
[1] 0.1771676

$`T_lasso_mild-complex`
[1] 0.1905116

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1311416

$`S_lasso_linear_mild-complex`
[1] 0.1412249

$`S_lasso_flexible_mild-complex`
[1] 0.1641706

Results for iteration 33 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_33-seed_486.csv
There were 50 or more warnings (use warnings() to see the first 50)
