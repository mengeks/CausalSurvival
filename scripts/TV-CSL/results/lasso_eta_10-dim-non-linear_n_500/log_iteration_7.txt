Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 7
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 7: 200
Loaded dataset 7 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_7_n_500.rds 
Time to load dataset: 0.00628757476806641 seconds
Loaded dataset 107 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_107_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.41449786
X.2   .         
X.3   .         
X.4   .         
X.5  -0.07658149
X.6  -0.03350343
X.7   .         
X.8   .         
X.9  -0.03519412
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.86576713
X.2   .         
X.3  -0.05935298
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  0.97517746
[1] "head(CATE_est)"
              1
[1,] -0.8569180
[2,]  1.1487757
[3,]  1.5759595
[4,] -0.5815070
[5,] -0.7879449
[6,]  0.4801987
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] "config_name: T_lasso_linear-only. MSE: 0.278500780846062. time_taken: 25.8699071407318"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.8416140  1.1507339  1.6620612 -0.6821569 -0.6941061  0.6518540
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.2008668
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.364808006
X.2   .          
X.3  -0.076109549
X.4   .          
X.5  -0.004034851
X.6  -0.046132518
X.7   .          
X.8   .          
X.9   .          
X.10  .          
      0.544663138
      1.018770465
[1] "beta_CATE: "
[1] 0.5446631 1.0187705
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.200866791072312; time_taken: 13.2711896896362"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.8213150  1.0520283  1.5960448 -0.6325378 -0.6158507  0.7101173
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.2054542
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                     1
X.1          0.2256924
X.2          .        
X.3          .        
X.4          .        
X.5          .        
X.6          .        
X.7          .        
X.8          .        
X.9          .        
X.10         .        
train_data$W .        
X.1          0.5577639
X.2          .        
X.3          .        
X.4          .        
X.5          .        
X.6          .        
X.7          .        
X.8          .        
X.9          .        
X.10         0.9229239
[1] "beta_CATE: "
 [1] 0.0000000 0.5577639 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.9229239
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.205454185473927; time_taken: 20.1490993499756"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8252819  1.0591284  1.6044913 -0.6365366 -0.6205756  0.7114417
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.202029
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.2298133
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     .        
X.1  0.5597112
X.2  .        
X.3  .        
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 0.9294096
[1] "beta_CATE: "
 [1] 0.0000000 0.5597112 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.9294096
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.202029015509182; time_taken: 19.8053896427155"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2  -0.05957105
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
             -0.15174655
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.70469663
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.76593928
X.1_spline1   0.11165339
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2  -0.12076096
X.9_spline3   0.64361547
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06205099
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.03326657
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -0.9751974
[2,]  0.7970519
[3,]  1.9825868
[4,] -0.7804321
[5,] -0.6209653
[6,]  1.2996319
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] "config_name: T_lasso_mild-complex. MSE: 0.198146658911218. time_taken: 134.463115930557"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.8237547  0.9930245  1.5780809 -0.6053746 -0.5638146  0.7770126
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.204053
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.20950329
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
             -0.04231144
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.07013391
              0.01697961
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.58239577
              0.86325300
[1] "beta_CATE: "
[1] 0.5823958 0.8632530
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.20405298410999; time_taken: 67.9503109455109"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.8446252  1.0016299  1.6120134 -0.6129742 -0.5637473  0.8139606
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.1847627
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.205211938
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   0.008550142
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
V41          -0.052038485
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           0.075558293
V80           0.016967542
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.603272832
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.868494945
[1] "beta_CATE: "
 [1] 0.0000000 0.6032728 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.0000000 0.0000000 0.0000000 0.8684949
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.184762674155593; time_taken: 69.8167235851288"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8638445  0.9313179  1.6372990 -0.6481588 -0.5843516  0.7102584
[1] "head(CATE_true)"
[1] -1.2519720  1.1986490  2.2849211 -0.7748869 -0.5876293  1.5048005
[1] 0.2077996
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.21085386
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.03376356
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
             -0.05540288
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.05663324
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
X.1           0.60311630
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.82943205
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.22805590
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06572485
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.02523688
              .         
[1] "beta_CATE: "
 [1] 0.00000000 0.60311630 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.82943205 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.22805590 0.00000000 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.06572485
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.02523688 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.20779957356842; time_taken: 118.458478450775"
Time to run lasso model: 471.533302545547 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.2785008

$`S_lasso_correctly-specified_linear-only`
[1] 0.2008668

$`S_lasso_linear_linear-only`
[1] 0.2054542

$`S_lasso_flexible_linear-only`
[1] 0.202029

$`T_lasso_mild-complex`
[1] 0.1981467

$`S_lasso_correctly-specified_mild-complex`
[1] 0.204053

$`S_lasso_linear_mild-complex`
[1] 0.1847627

$`S_lasso_flexible_mild-complex`
[1] 0.2077996

Results for iteration 7 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_7-seed_200.csv
There were 50 or more warnings (use warnings() to see the first 50)
