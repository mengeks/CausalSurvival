Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 77
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 77: 970
Loaded dataset 77 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_77_n_500.rds 
Time to load dataset: 0.0160555839538574 seconds
Loaded dataset 177 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_177_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.40898107
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10 -0.08202598
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.84452498
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  0.07435521
X.7  .         
X.8  0.07070084
X.9  .         
X.10 0.91343815
[1] "head(CATE_est)"
              1
[1,] -0.7343223
[2,] -1.2036173
[3,] -0.1111503
[4,] -1.2357793
[5,]  0.4290507
[6,]  1.2251344
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] "config_name: T_lasso_linear-only. MSE: 0.252096626944783. time_taken: 32.1327188014984"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.68171869 -1.47332225 -0.08334304 -1.20582898  0.61365491  1.29379952
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.1487576
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.36349728
X.2   .         
X.3  -0.13782894
X.4   .         
X.5   .         
X.6   0.08223187
X.7   .         
X.8   .         
X.9   .         
X.10 -0.07537842
      0.60276561
      1.09605287
[1] "beta_CATE: "
[1] 0.6027656 1.0960529
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.148757638834249; time_taken: 16.9126708507538"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.8986091 -1.4837553 -0.1988083 -1.3487450  0.1681334  1.1526996
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.2028253
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.39875064
X.2           .         
X.3          -0.06435621
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W -0.15264513
X.1           0.50390513
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           0.10652026
X.7           .         
X.8           0.06959299
X.9           .         
X.10          0.94842478
[1] "beta_CATE: "
 [1] -0.15264513  0.50390513  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.10652026  0.00000000  0.06959299  0.00000000  0.94842478
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.202825293444872; time_taken: 25.5970299243927"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8986091 -1.4837553 -0.1988083 -1.3487450  0.1681334  1.1526996
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.2028253
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.39875064
X.2   .         
X.3  -0.06435621
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.15264513
X.1   0.50390513
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   0.10652026
X.7   .         
X.8   0.06959299
X.9   .         
X.10  0.94842478
[1] "beta_CATE: "
 [1] -0.15264513  0.50390513  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.10652026  0.00000000  0.06959299  0.00000000  0.94842478
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.202825293444872; time_taken: 25.6058187484741"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   0.11875146
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2  -0.02005897
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.03449688
             -0.20095851
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.08092604
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.792251824
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           0.065179634
X.7           0.002072819
X.8           0.044725893
X.9           .          
X.10          0.788325278
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   0.001024922
X.2_spline1   .          
X.2_spline2  -0.084232488
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.567675105
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.028335694
              0.006753773
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
               1
[1,] -0.89648622
[2,] -1.61293368
[3,] -0.08583659
[4,] -1.33006760
[5,]  0.19442640
[6,]  1.44817900
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] "config_name: T_lasso_mild-complex. MSE: 0.13545294234209. time_taken: 137.687984704971"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.59333990 -1.36756444 -0.05211778 -1.03934917  0.51358589  1.17478773
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.1668885
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.263194323
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  0.010457130
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  0.025788319
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.036013947
             .          
             .          
             .          
             .          
             .          
             .          
             0.015298766
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.006819946
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.570748438
             0.951703718
[1] "beta_CATE: "
[1] 0.5707484 0.9517037
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.166888542280857; time_taken: 54.4655501842499"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.67056916 -1.36784511 -0.01059219 -1.07474433  0.33174877  1.26090474
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.153927
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.254999523
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
V41          .          
V42          .          
V43          .          
V44          .          
V45          .          
V46          .          
V47          .          
V48          .          
V49          .          
V50          0.039768849
V51          .          
V52          .          
V53          .          
V54          .          
V55          .          
V56          .          
V57          0.008150383
V58          .          
V59          .          
V60          .          
V61          .          
V62          .          
V63          .          
V64          .          
V65          .          
V66          .          
V67          .          
V68          .          
V69          .          
V70          .          
V71          .          
V72          .          
V73          .          
V74          .          
V75          .          
V76          .          
V77          .          
V78          .          
V79          .          
V80          .          
V81          .          
V82          .          
V83          .          
V84          .          
V85          .          
V86          .          
V87          .          
V88          .          
V89          .          
V90          .          
V91          .          
V92          .          
V93          .          
V94          .          
V95          .          
train_data$W .          
X.1          0.549210917
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          0.066922651
X.7          0.018914539
X.8          0.042340045
X.9          .          
X.10         0.888323307
[1] "beta_CATE: "
 [1] 0.00000000 0.54921092 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.06692265 0.01891454 0.04234005 0.00000000 0.88832331
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.153927020929632; time_taken: 61.5152812004089"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.8140567 -1.4165596 -0.1942277 -1.1439628  0.2205478  1.0579487
[1] "head(CATE_true)"
[1] -0.6353062 -2.1829842  0.1163594 -1.0272477  0.3769595  1.6686136
[1] 0.2138952
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.297957192
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.005379649
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.002931022
             .          
             .          
             .          
X.1          0.492938321
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          0.065719409
X.7          0.021537075
X.8          0.036592993
X.9          .          
X.10         0.802458877
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  0.048282555
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 0.537929200
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.008974325
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
[1] "beta_CATE: "
 [1] 0.000000000 0.492938321 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.065719409 0.021537075 0.036592993 0.000000000 0.802458877 0.000000000
[13] 0.000000000 0.048282555 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.537929200 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.008974325 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.213895174638736; time_taken: 107.945861816406"
Time to run lasso model: 463.864248275757 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.2520966

$`S_lasso_correctly-specified_linear-only`
[1] 0.1487576

$`S_lasso_linear_linear-only`
[1] 0.2028253

$`S_lasso_flexible_linear-only`
[1] 0.2028253

$`T_lasso_mild-complex`
[1] 0.1354529

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1668885

$`S_lasso_linear_mild-complex`
[1] 0.153927

$`S_lasso_flexible_mild-complex`
[1] 0.2138952

Results for iteration 77 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_77-seed_970.csv
There were 50 or more warnings (use warnings() to see the first 50)
