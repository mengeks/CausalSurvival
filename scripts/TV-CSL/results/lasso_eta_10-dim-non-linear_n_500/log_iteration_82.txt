Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 82
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 82: 1025
Loaded dataset 82 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_82_n_500.rds 
Time to load dataset: 0.0335547924041748 seconds
Loaded dataset 182 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_182_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   .        
X.2   0.2287254
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7  -0.1555229
X.8   .        
X.9   .        
X.10  .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.759242065
X.2  .          
X.3  .          
X.4  0.025016102
X.5  .          
X.6  .          
X.7  .          
X.8  0.003307541
X.9  0.029525945
X.10 0.837647781
[1] "head(CATE_est)"
              1
[1,] -1.3411732
[2,]  0.1333260
[3,]  0.4056981
[4,] -0.4222209
[5,]  0.9569425
[6,] -2.1702443
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] "config_name: T_lasso_linear-only. MSE: 0.149441405462309. time_taken: 31.420622587204"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.42247236 -0.06116658  0.50049385 -0.27960384  0.87280177 -2.09219533
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.158911
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.1107985
X.2   0.2046171
X.3  -0.1778763
X.4   0.3026084
X.5  -0.2492414
X.6   .        
X.7   .        
X.8   .        
X.9   .        
X.10  .        
      0.5967607
      0.9552216
[1] "beta_CATE: "
[1] 0.5967607 0.9552216
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.158911039020732; time_taken: 15.8787224292755"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.36521065  0.02639396  0.26853196 -0.37739022  0.84933244 -2.22151346
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.1795409
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           0.213093250
X.3           .          
X.4           0.263141640
X.5          -0.218768553
X.6           .          
X.7          -0.083509917
X.8           .          
X.9           .          
X.10          .          
train_data$W  0.001180607
X.1           0.748024464
X.2          -0.032614148
X.3          -0.227366837
X.4           .          
X.5           .          
X.6           .          
X.7           0.103487841
X.8           0.014454117
X.9           0.048352937
X.10          0.901377230
[1] "beta_CATE: "
 [1]  0.001180607  0.748024464 -0.032614148 -0.227366837  0.000000000
 [6]  0.000000000  0.000000000  0.103487841  0.014454117  0.048352937
[11]  0.901377230
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.17954085587498; time_taken: 22.1491456031799"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.39920615  0.01063726  0.48557479 -0.20339179  0.82106034 -1.83199067
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.20449
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.08064286
X.2  0.11894617
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.58076613
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  0.03701643
X.10 0.80469617
[1] "beta_CATE: "
 [1] 0.00000000 0.58076613 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.03701643 0.80469617
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.204489962598781; time_taken: 20.71200299263"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.715976565
X.2           .          
X.3           .          
X.4           0.111195512
X.5           .          
X.6           .          
X.7           .          
X.8           0.003945893
X.9           .          
X.10          0.741675577
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   0.076082889
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1  -0.458360514
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.097394860
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.271099104
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.301839559
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.003631143
              .          
              .          
              .          
              0.022425869
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.018641421
              .          
              .          
              .          
[1] "head(CATE_est)"
               1
[1,] -2.03504575
[2,] -0.09432985
[3,]  0.49594561
[4,] -0.14207315
[5,]  0.69631386
[6,] -1.61318504
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] "config_name: T_lasso_mild-complex. MSE: 0.142434085481661. time_taken: 144.219944238663"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.260816570  0.002308485  0.441539083 -0.165896484  0.719947411
[6] -1.628961422
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.3081169
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.088493094
X.2          0.112832826
X.3          .          
X.4          0.006884394
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  0.082413816
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  0.158387007
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             0.022404453
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.019537540
             .          
             .          
             0.021823838
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.008247734
             .          
             .          
             .          
             .          
             .          
             .          
             0.028879239
             .          
             .          
             0.019190316
             0.522843633
             0.746391159
[1] "beta_CATE: "
[1] 0.5228436 0.7463912
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.308116883907144; time_taken: 67.4693696498871"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -1.46002087  0.05630491  0.50461332 -0.14974896  0.81674885 -1.73683776
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.206927
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.05227071
X.2           0.13281629
X.3           .         
X.4           0.06532833
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   0.18937056
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   0.65820758
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1  -0.25152987
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2 -0.20074305
X.10_spline3  .         
V41           .         
V42           .         
V43           .         
V44           .         
V45           0.04261579
V46           .         
V47           .         
V48           .         
V49           .         
V50           .         
V51           .         
V52           .         
V53           .         
V54           .         
V55           .         
V56           0.03008936
V57           .         
V58           .         
V59           0.04031097
V60           .         
V61           .         
V62           .         
V63           .         
V64           .         
V65           .         
V66           .         
V67           .         
V68           .         
V69           .         
V70           .         
V71           .         
V72           .         
V73           .         
V74           .         
V75           .         
V76           .         
V77           .         
V78           .         
V79           .         
V80           .         
V81           .         
V82           .         
V83           .         
V84           .         
V85           .         
V86           .         
V87           .         
V88           .         
V89           .         
V90           .         
V91           .         
V92           0.01145034
V93           .         
V94           .         
V95           0.05476445
train_data$W  .         
X.1           0.60126895
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           0.04225947
X.10          0.75856318
[1] "beta_CATE: "
 [1] 0.00000000 0.60126895 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.04225947 0.75856318
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.206926991309336; time_taken: 74.5076887607574"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.27848317 -0.02935046  0.45514626 -0.08230065  0.82890969 -1.16045847
[1] "head(CATE_true)"
[1] -2.48012975  0.26846695  0.85884776  0.05623191  1.16561629 -2.15152649
[1] 0.3001328
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          0.046935383
X.2          0.092706277
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             0.006042697
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
X.1          0.547214729
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          0.004647958
X.10         0.728109516
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.003843312
             .          
             .          
             .          
             0.039836787
             .          
             .          
             .          
             0.029679188
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.097638981
             .          
             .          
             0.005775056
[1] "beta_CATE: "
 [1] 0.000000000 0.547214729 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.004647958 0.728109516 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.003843312 0.000000000 0.000000000
[55] 0.000000000 0.039836787 0.000000000 0.000000000 0.000000000 0.029679188
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.097638981 0.000000000 0.000000000 0.005775056
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.300132819949071; time_taken: 125.74237203598"
Time to run lasso model: 504.072920084 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1494414

$`S_lasso_correctly-specified_linear-only`
[1] 0.158911

$`S_lasso_linear_linear-only`
[1] 0.1795409

$`S_lasso_flexible_linear-only`
[1] 0.20449

$`T_lasso_mild-complex`
[1] 0.1424341

$`S_lasso_correctly-specified_mild-complex`
[1] 0.3081169

$`S_lasso_linear_mild-complex`
[1] 0.206927

$`S_lasso_flexible_mild-complex`
[1] 0.3001328

Results for iteration 82 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_82-seed_1025.csv
There were 50 or more warnings (use warnings() to see the first 50)
