Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 67
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 67: 860
Loaded dataset 67 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_67_n_500.rds 
Time to load dataset: 0.0288321971893311 seconds
Loaded dataset 167 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_167_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.788054278
X.2  .          
X.3  0.025435440
X.4  0.001913599
X.5  0.050734628
X.6  .          
X.7  0.016712874
X.8  .          
X.9  .          
X.10 0.872880350
[1] "head(CATE_est)"
              1
[1,]  0.1052833
[2,]  0.6946474
[3,] -2.0560472
[4,] -1.8621587
[5,]  0.0861686
[6,] -1.0623857
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] "config_name: T_lasso_linear-only. MSE: 0.0368582393548284. time_taken: 25.7593970298767"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.2328847  0.6629893 -1.7939881 -1.5318289  0.1162618 -0.8086431
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.1532107
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.08510154
X.2  .         
X.3  0.05029515
X.4  .         
X.5  0.08023345
X.6  .         
X.7  .         
X.8  0.03138629
X.9  .         
X.10 .         
     0.65945197
     0.83233169
[1] "beta_CATE: "
[1] 0.6594520 0.8323317
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.153210695640022; time_taken: 10.8251271247864"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.2609926  0.7513877 -1.7579108 -1.0449462  0.2724287 -0.7366894
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.2339269
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           0.13133731
X.3           0.04799316
X.4           .         
X.5           0.07969991
X.6           .         
X.7           .         
X.8           0.07887985
X.9           .         
X.10          .         
train_data$W  .         
X.1           0.90915454
X.2          -0.34100666
X.3           0.05166364
X.4           .         
X.5           .         
X.6          -0.05235254
X.7           0.07108550
X.8           .         
X.9          -0.23228680
X.10          1.01517722
[1] "beta_CATE: "
 [1]  0.00000000  0.90915454 -0.34100666  0.05166364  0.00000000  0.00000000
 [7] -0.05235254  0.07108550  0.00000000 -0.23228680  1.01517722
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.233926910118373; time_taken: 22.8401596546173"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.2273554  0.6535217 -1.7550513 -1.5063334  0.1204164 -0.8004121
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.1639004
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.069737810
X.2  .          
X.3  0.053845247
X.4  .          
X.5  0.076365329
X.6  .          
X.7  .          
X.8  0.023215062
X.9  .          
X.10 .          
     0.005515042
X.1  0.654397145
X.2  .          
X.3  .          
X.4  .          
X.5  .          
X.6  .          
X.7  .          
X.8  .          
X.9  .          
X.10 0.815007793
[1] "beta_CATE: "
 [1] 0.005515042 0.654397145 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.815007793
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.163900431194408; time_taken: 22.7298324108124"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           0.14489740
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   1.02903792
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   0.34141014
X.5_spline2  -0.83813233
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2  -0.87719534
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   0.98361561
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.33290005
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.13181786
              .         
              .         
              .         
              .         
              .         
              0.05185113
              .         
              .         
              0.01911420
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.736749215
X.2           .          
X.3           0.007194389
X.4           .          
X.5           0.057460367
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.678831140
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.140783888
X.10_spline2 -1.471229533
X.10_spline3  0.052078535
              .          
              .          
              .          
              0.005437783
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.006783359
              0.007966303
              .          
              .          
              .          
              .          
              .          
              0.019345655
              .          
              .          
              .          
              .          
              .          
              0.048993032
              .          
              .          
              .          
              .          
              0.032400421
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,]  0.1427483
[2,]  0.3180774
[3,] -1.9047813
[4,] -1.0790929
[5,]  0.4564030
[6,] -0.8454877
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] "config_name: T_lasso_mild-complex. MSE: 0.588591798255728. time_taken: 137.285527467728"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.000304658  0.461734485 -1.449515413 -1.478208214  0.116576912
[6] -1.000451661
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.2290992
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           0.064335653
X.4           .          
X.5           0.004831374
X.6           .          
X.7           .          
X.8           0.039351258
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.549682662
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   0.194393417
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.811525890
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.712200172
X.10_spline3  0.785951331
              .          
             -0.007357583
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.038105574
              .          
              .          
              .          
              .          
              0.039415525
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.736053595
              0.621424570
[1] "beta_CATE: "
[1] 0.7360536 0.6214246
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.229099176295539; time_taken: 61.2400465011597"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.02364651  0.49479447 -1.42148262 -1.46465634  0.15369144 -0.99089447
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.2202482
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           0.051116810
X.4           .          
X.5           0.007098092
X.6           .          
X.7           .          
X.8           0.042161382
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.632433876
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   0.180418236
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.869734331
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.767381470
X.10_spline3  0.795723249
V41           .          
V42          -0.008191821
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           0.044411845
V81           .          
V82           .          
V83           .          
V84           .          
V85           0.033004932
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  0.035189244
X.1           0.751803809
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.621446856
[1] "beta_CATE: "
 [1] 0.03518924 0.75180381 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.62144686
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.220248198226258; time_taken: 66.328456401825"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.2713174  0.7132283 -1.2063672 -1.2450515  0.3993150 -0.6720956
[1] "head(CATE_true)"
[1]  0.1313475  0.7681991 -2.2492236 -2.1255274  0.1650591 -1.3096547
[1] 0.3334104
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           0.0102198522
X.4           .           
X.5           0.0292675190
X.6           .           
X.7           .           
X.8           0.0214286248
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   0.4472683064
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   0.0658247057
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2  -0.8898161067
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.0104686786
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  1.3211687774
              .           
             -0.0003758924
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0599612786
              .           
              .           
              .           
              .           
              0.0057393091
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.7287768522
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.4404663086
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  0.7432150394
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0147009077
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1] 0.00000000 0.72877685 0.00000000 0.00000000 0.00000000 0.00000000
 [7] 0.00000000 0.00000000 0.00000000 0.00000000 0.44046631 0.00000000
[13] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[19] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[25] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[31] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[37] 0.00000000 0.00000000 0.74321504 0.00000000 0.00000000 0.00000000
[43] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[49] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[55] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[61] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[67] 0.01470091 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[73] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[79] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[85] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[91] 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000 0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.333410364268346; time_taken: 130.082669496536"
Time to run lasso model: 478.845937013626 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.03685824

$`S_lasso_correctly-specified_linear-only`
[1] 0.1532107

$`S_lasso_linear_linear-only`
[1] 0.2339269

$`S_lasso_flexible_linear-only`
[1] 0.1639004

$`T_lasso_mild-complex`
[1] 0.5885918

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2290992

$`S_lasso_linear_mild-complex`
[1] 0.2202482

$`S_lasso_flexible_mild-complex`
[1] 0.3334104

Results for iteration 67 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_67-seed_860.csv
There were 50 or more warnings (use warnings() to see the first 50)
