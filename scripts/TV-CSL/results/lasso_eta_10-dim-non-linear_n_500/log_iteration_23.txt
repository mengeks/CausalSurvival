Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 23
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 23: 376
Loaded dataset 23 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_23_n_500.rds 
Time to load dataset: 0.016136646270752 seconds
Loaded dataset 123 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_123_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  0.25528418
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.08339265
X.8  .         
X.9  .         
X.10 .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1  0.702077211
X.2  0.015665202
X.3  .          
X.4  .          
X.5  .          
X.6  0.091307665
X.7  0.009424877
X.8  .          
X.9  .          
X.10 0.947836801
[1] "head(CATE_est)"
               1
[1,] -0.17027068
[2,] -0.51156229
[3,] -0.64822082
[4,]  3.09509315
[5,] -0.02154676
[6,]  1.17824577
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] "config_name: T_lasso_linear-only. MSE: 0.241181085194138. time_taken: 29.9019074440002"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.4593213 -0.4664420 -0.8664342  3.3476923  0.1843178  1.0557210
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.08954486
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  0.02453131
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.08557462
X.8  .         
X.9  .         
X.10 .         
     0.69602602
     0.93729238
[1] "beta_CATE: "
[1] 0.6960260 0.9372924
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0895448560095682; time_taken: 15.0321786403656"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.4451024 -0.4653180 -0.9180319  3.3161411  0.1709734  1.1223593
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.08587739
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          0.02633948
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          0.06330672
X.8          .         
X.9          .         
X.10         .         
train_data$W .         
X.1          0.68092016
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          0.04496180
X.7          .         
X.8          .         
X.9          .         
X.10         0.91978986
[1] "beta_CATE: "
 [1] 0.0000000 0.6809202 0.0000000 0.0000000 0.0000000 0.0000000 0.0449618
 [8] 0.0000000 0.0000000 0.0000000 0.9197899
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0858773905250366; time_taken: 27.8230838775635"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.4451024 -0.4653180 -0.9180319  3.3161411  0.1709734  1.1223593
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.08587739
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  0.02633948
X.3  .         
X.4  .         
X.5  .         
X.6  .         
X.7  0.06330672
X.8  .         
X.9  .         
X.10 .         
     .         
X.1  0.68092016
X.2  .         
X.3  .         
X.4  .         
X.5  .         
X.6  0.04496180
X.7  .         
X.8  .         
X.9  .         
X.10 0.91978986
[1] "beta_CATE: "
 [1] 0.0000000 0.6809202 0.0000000 0.0000000 0.0000000 0.0000000 0.0449618
 [8] 0.0000000 0.0000000 0.0000000 0.9197899
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0858773905250366; time_taken: 27.97310090065"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   1.2269463491
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2  -0.0981366848
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2  -0.9721341576
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              0.0651102804
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.3511929273
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0007482209
              .           
              .           
              .           
              0.0508360688
              .           
              0.0455983251
              0.0090568836
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          0.47063506
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          0.02708201
X.7          .         
X.8          .         
X.9          .         
X.10         0.73114429
X.1_spline1  0.47079756
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  0.58794809
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  0.02582143
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 1.31294485
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.03412974
             .         
             .         
             0.00595827
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.05209289
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
[1] "head(CATE_est)"
               1
[1,] -0.33138121
[2,] -0.33178304
[3,] -0.06142849
[4,]  3.29750043
[5,]  0.07425130
[6,]  0.92611384
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] "config_name: T_lasso_mild-complex. MSE: 0.429582837809314. time_taken: 133.710317850113"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.3877370 -0.3781418 -0.7236545  2.7817629  0.1584406  0.8632273
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.2161743
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1          .         
X.2          .         
X.3          .         
X.4          .         
X.5          .         
X.6          .         
X.7          .         
X.8          .         
X.9          .         
X.10         .         
X.1_spline1  0.25785476
X.1_spline2  .         
X.1_spline3  .         
X.2_spline1  0.34345317
X.2_spline2  .         
X.2_spline3  .         
X.3_spline1  .         
X.3_spline2  .         
X.3_spline3  .         
X.4_spline1  .         
X.4_spline2  .         
X.4_spline3  .         
X.5_spline1  .         
X.5_spline2  .         
X.5_spline3  .         
X.6_spline1  .         
X.6_spline2  .         
X.6_spline3  .         
X.7_spline1  0.25526330
X.7_spline2  .         
X.7_spline3  .         
X.8_spline1  .         
X.8_spline2  .         
X.8_spline3  .         
X.9_spline1  .         
X.9_spline2  .         
X.9_spline3  .         
X.10_spline1 .         
X.10_spline2 .         
X.10_spline3 1.05700061
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.03655195
             .         
             .         
             .         
             0.02362136
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             .         
             0.58462599
             0.77255809
[1] "beta_CATE: "
[1] 0.5846260 0.7725581
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.216174305980376; time_taken: 65.2527379989624"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.52690029 -0.55976260 -0.86946788  2.62746336 -0.01152849  0.74642846
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.2498069
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.339307238
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.556070790
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3  -0.091582388
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   0.333807625
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  1.103612847
V41           .          
V42           .          
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51          -0.002937602
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           0.053262461
V77           .          
V78           .          
V79           .          
V80           0.021852494
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W -0.155584203
X.1           0.567750450
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.790117483
[1] "beta_CATE: "
 [1] -0.1555842  0.5677505  0.0000000  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.0000000  0.7901175
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.249806908043526; time_taken: 74.8733868598938"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.6381965 -0.7267436 -0.9206297  3.1485953 -0.1979089  0.9972610
[1] "head(CATE_true)"
[1] -0.7053902 -0.3488041 -1.1481456  4.1002591  0.3501382  0.9628005
[1] 0.2889716
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  0.282985579
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  0.591667951
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  0.299297575
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 0.323184228
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
X.1          0.529622162
X.2          .          
X.3          .          
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         0.721452597
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 1.064100933
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.008346164
             .          
             .          
             0.039700113
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.044618581
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
[1] "beta_CATE: "
 [1] 0.000000000 0.529622162 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.721452597 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 1.064100933 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.008346164 0.000000000 0.000000000 0.039700113
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.044618581 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.288971550352257; time_taken: 106.20734834671"
Time to run lasso model: 482.515444040298 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.2411811

$`S_lasso_correctly-specified_linear-only`
[1] 0.08954486

$`S_lasso_linear_linear-only`
[1] 0.08587739

$`S_lasso_flexible_linear-only`
[1] 0.08587739

$`T_lasso_mild-complex`
[1] 0.4295828

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2161743

$`S_lasso_linear_mild-complex`
[1] 0.2498069

$`S_lasso_flexible_mild-complex`
[1] 0.2889716

Results for iteration 23 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_23-seed_376.csv
There were 50 or more warnings (use warnings() to see the first 50)
