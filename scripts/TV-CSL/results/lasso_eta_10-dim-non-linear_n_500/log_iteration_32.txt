Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 32
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 32: 475
Loaded dataset 32 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_32_n_500.rds 
Time to load dataset: 0.00400447845458984 seconds
Loaded dataset 132 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_132_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.1223920
X.2   .        
X.3   .        
X.4   .        
X.5   .        
X.6  -0.3008846
X.7   .        
X.8   .        
X.9   0.2762832
X.10  .        
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   1.0426770
X.2  -0.2797736
X.3   .        
X.4   .        
X.5   .        
X.6   .        
X.7   .        
X.8   .        
X.9   0.1902854
X.10  0.7499306
[1] "head(CATE_est)"
              1
[1,]  1.8000239
[2,] -0.6135190
[3,] -1.3968007
[4,] -2.5530927
[5,]  2.9590974
[6,] -0.1725509
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] "config_name: T_lasso_linear-only. MSE: 0.113742300280137. time_taken: 30.2908804416656"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.8005346 -0.6263389 -1.2199961 -2.6493891  3.1536815 -0.3864063
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.07421861
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1   0.2260531
X.2  -0.1600749
X.3   .        
X.4   .        
X.5   .        
X.6  -0.1232947
X.7   .        
X.8   .        
X.9   0.2228012
X.10  .        
      0.8160509
      0.8128866
[1] "beta_CATE: "
[1] 0.8160509 0.8128866
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0742186131070709; time_taken: 14.7318179607391"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.8676894 -0.8416718 -1.5439794 -2.7721265  3.1070351 -0.3343559
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.07515695
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.131252020
X.2           .          
X.3           .          
X.4           .          
X.5          -0.068868694
X.6          -0.155251581
X.7           .          
X.8           .          
X.9           0.228609747
X.10          0.003976220
train_data$W  .          
X.1           1.059370255
X.2          -0.454633709
X.3           0.100530241
X.4           0.117069110
X.5           .          
X.6           .          
X.7           0.007173355
X.8           0.052329329
X.9           .          
X.10          0.808279539
[1] "beta_CATE: "
 [1]  0.000000000  1.059370255 -0.454633709  0.100530241  0.117069110
 [6]  0.000000000  0.000000000  0.007173355  0.052329329  0.000000000
[11]  0.808279539
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0751569536122413; time_taken: 22.2695436477661"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.8616462 -0.8415339 -1.4908861 -2.7539769  3.0805192 -0.3612078
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.07442247
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.110250809
X.2   .          
X.3   .          
X.4   .          
X.5  -0.041380614
X.6  -0.136488320
X.7   .          
X.8   .          
X.9   0.203473194
X.10  .          
      .          
X.1   1.037394526
X.2  -0.381555870
X.3   0.059890023
X.4   0.088732724
X.5   .          
X.6   .          
X.7   .          
X.8   0.054643165
X.9   0.007537151
X.10  0.805757785
[1] "beta_CATE: "
 [1]  0.000000000  1.037394526 -0.381555870  0.059890023  0.088732724
 [6]  0.000000000  0.000000000  0.000000000  0.054643165  0.007537151
[11]  0.805757785
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0744224738757347; time_taken: 21.642899274826"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                      1
X.1           .        
X.2           .        
X.3           .        
X.4           .        
X.5           .        
X.6           .        
X.7           .        
X.8           .        
X.9           .        
X.10          .        
X.1_spline1   .        
X.1_spline2   .        
X.1_spline3   .        
X.2_spline1   .        
X.2_spline2   .        
X.2_spline3   .        
X.3_spline1   .        
X.3_spline2   .        
X.3_spline3   .        
X.4_spline1   .        
X.4_spline2   .        
X.4_spline3   .        
X.5_spline1   .        
X.5_spline2   .        
X.5_spline3   .        
X.6_spline1   .        
X.6_spline2   .        
X.6_spline3   .        
X.7_spline1   .        
X.7_spline2   .        
X.7_spline3   .        
X.8_spline1   .        
X.8_spline2   .        
X.8_spline3   .        
X.9_spline1   .        
X.9_spline2   .        
X.9_spline3   .        
X.10_spline1  .        
X.10_spline2 -0.1641471
X.10_spline3  .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
              .        
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.72270199
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          0.63187879
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.74721529
X.10_spline1  .         
X.10_spline2 -0.04409948
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,]  1.6148185
[2,] -0.6683702
[3,] -1.1955709
[4,] -2.3138745
[5,]  2.6798908
[6,] -0.3586584
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] "config_name: T_lasso_mild-complex. MSE: 0.177703602227688. time_taken: 134.298786640167"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  1.7458281 -0.5612903 -1.2659714 -2.5840279  3.5511474 -0.5584376
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.1027229
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.1031748163
X.2           .           
X.3           .           
X.4           .           
X.5          -0.0302210123
X.6          -0.0005433748
X.7           .           
X.8           .           
X.9           0.1200855994
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   0.0542959194
X.2_spline1   .           
X.2_spline2   1.6168405205
X.2_spline3  -0.7318157471
X.3_spline1   .           
X.3_spline2  -1.0998685652
X.3_spline3   .           
X.4_spline1   0.1329855065
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3  -0.2263726076
X.6_spline1  -0.4926739552
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1  -0.0088303523
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.5775625202
X.10_spline1  .           
X.10_spline2 -1.3493876239
X.10_spline3  .           
              .           
              .           
              0.0455473119
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0058770962
              .           
              .           
              0.0918250010
              .           
              0.1363908685
              .           
             -0.0216681631
              .           
              .           
              .           
              .           
             -0.1598575479
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0023331240
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.9731458204
              0.6867282061
[1] "beta_CATE: "
[1] 0.9731458 0.6867282
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.102722856628787; time_taken: 71.1924982070923"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  1.7513261 -0.6705369 -1.3262869 -2.5569865  3.2552539 -0.4338273
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.1049214
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0521653692
X.2           .           
X.3           .           
X.4           .           
X.5          -0.0005020907
X.6          -0.0092227050
X.7           .           
X.8           .           
X.9           0.0323002896
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   0.7775453055
X.2_spline3  -0.0966688716
X.3_spline1   .           
X.3_spline2  -0.2658924550
X.3_spline3   .           
X.4_spline1   0.0150735277
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3  -0.0140157298
X.6_spline1  -0.2648144948
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   0.4148723113
X.10_spline1  .           
X.10_spline2 -1.1229929624
X.10_spline3  0.2087494648
V41           .           
V42           .           
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           .           
V49           .           
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57           0.0508726591
V58           .           
V59           0.1243646557
V60           .           
V61          -0.0043031099
V62           .           
V63           .           
V64           .           
V65           .           
V66          -0.1232392175
V67           .           
V68           .           
V69           .           
V70           .           
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           .           
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           .           
V95           .           
train_data$W  .           
X.1           0.9749024452
X.2          -0.1071769088
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           0.1259636255
X.10          0.6092019413
[1] "beta_CATE: "
 [1]  0.0000000  0.9749024 -0.1071769  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.0000000  0.0000000  0.1259636  0.6092019
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.104921399155096; time_taken: 74.5312757492065"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  1.6006416 -0.5535356 -1.1292065 -2.3277243  2.8359981 -0.2913870
[1] "head(CATE_true)"
[1]  2.2119055 -0.7700708 -1.4975913 -3.2544915  3.8674409 -0.4721680
[1] 0.1697734
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.008569099
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   0.301965324
X.10_spline1  .          
X.10_spline2 -0.624160264
X.10_spline3  0.012885563
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.739002194
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           0.105201602
X.10          0.599038795
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.002422538
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.000000000 0.739002194 0.000000000 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.105201602 0.599038795 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.002422538 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.169773428128372; time_taken: 112.376118659973"
Time to run lasso model: 483.661416530609 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1137423

$`S_lasso_correctly-specified_linear-only`
[1] 0.07421861

$`S_lasso_linear_linear-only`
[1] 0.07515695

$`S_lasso_flexible_linear-only`
[1] 0.07442247

$`T_lasso_mild-complex`
[1] 0.1777036

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1027229

$`S_lasso_linear_mild-complex`
[1] 0.1049214

$`S_lasso_flexible_mild-complex`
[1] 0.1697734

Results for iteration 32 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_32-seed_475.csv
There were 50 or more warnings (use warnings() to see the first 50)
