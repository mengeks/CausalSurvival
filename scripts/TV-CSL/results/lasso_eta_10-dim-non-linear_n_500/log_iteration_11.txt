Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 11
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 11: 244
Loaded dataset 11 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_11_n_500.rds 
Time to load dataset: 0.00306224822998047 seconds
Loaded dataset 111 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_111_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  .         
X.2  0.15423298
X.3  0.04361842
X.4  .         
X.5  .         
X.6  .         
X.7  .         
X.8  .         
X.9  .         
X.10 .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.802981074
X.2   .          
X.3   0.188462198
X.4   .          
X.5  -0.070466882
X.6  -0.008694922
X.7  -0.105205544
X.8   .          
X.9   0.145215947
X.10  1.052186789
[1] "head(CATE_est)"
               1
[1,] -2.33223545
[2,] -0.04517122
[3,]  0.60526272
[4,] -1.04478489
[5,]  1.89762122
[6,]  1.08294901
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] "config_name: T_lasso_linear-only. MSE: 0.0881314311174374. time_taken: 26.9415338039398"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.6988579 -0.1393995  0.9030165 -0.9601959  2.0870274  1.1968215
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.03753908
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   .         
X.2   0.04597100
X.3   0.20854137
X.4   .         
X.5  -0.15321245
X.6  -0.02588672
X.7  -0.06902827
X.8   .         
X.9   0.15850947
X.10  .         
      0.82352603
      1.10694473
[1] "beta_CATE: "
[1] 0.823526 1.106945
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0375390810680646; time_taken: 14.58185338974"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.6524417 -0.1477387  0.8233618 -1.0487021  2.0640475  1.1130874
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.03876641
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           0.047374586
X.3           0.175628153
X.4           .          
X.5          -0.151640456
X.6          -0.002922714
X.7           .          
X.8           .          
X.9           0.071051395
X.10          0.025650375
train_data$W  .          
X.1           0.815779147
X.2           .          
X.3           0.041374548
X.4           .          
X.5           .          
X.6           .          
X.7          -0.114046160
X.8           0.018687057
X.9           0.094662918
X.10          1.072206762
[1] "beta_CATE: "
 [1]  0.00000000  0.81577915  0.00000000  0.04137455  0.00000000  0.00000000
 [7]  0.00000000 -0.11404616  0.01868706  0.09466292  1.07220676
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.0387664121815292; time_taken: 26.2440099716187"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.6682367 -0.1768081  0.7517146 -1.0686394  2.0097670  1.0477406
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.043497
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   .          
X.2   0.056139100
X.3   0.215272370
X.4   .          
X.5  -0.177249709
X.6  -0.007562302
X.7  -0.003015352
X.8   .          
X.9   0.090923724
X.10  0.026610899
     -0.048814249
X.1   0.826938928
X.2   .          
X.3   0.019724055
X.4   .          
X.5   .          
X.6   .          
X.7  -0.139673822
X.8   0.059554994
X.9   0.062025973
X.10  1.090951046
[1] "beta_CATE: "
 [1] -0.04881425  0.82693893  0.00000000  0.01972405  0.00000000  0.00000000
 [7]  0.00000000 -0.13967382  0.05955499  0.06202597  1.09095105
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.0434970007946506; time_taken: 25.4319636821747"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2  -0.214927692
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.069223750
              .          
             -0.059524363
              .          
              .          
              .          
              0.078685238
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.005662975
              .          
              .          
             -0.025887067
              .          
              .          
              .          
              .          
             -0.198825827
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.014719149
              .          
              .          
              .          
              0.062493011
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.036023456
              .          
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.67119847
X.2           .         
X.3           0.06203997
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           0.09864788
X.10          0.98842165
X.1_spline1   .         
X.1_spline2   .         
X.1_spline3   0.40813733
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   0.51275600
X.3_spline1   0.37762778
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1  -0.16813697
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1  -0.08251726
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1  -0.19350681
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1  -0.21931781
X.7_spline2   0.62374625
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   0.51361323
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.09211605
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06998374
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "head(CATE_est)"
              1
[1,] -2.1116613
[2,] -0.1740791
[3,]  0.7817238
[4,] -0.8835240
[5,]  2.1927659
[6,]  0.8507986
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] "config_name: T_lasso_mild-complex. MSE: 0.118199914799209. time_taken: 130.817197561264"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.2992967 -0.1207568  0.7865543 -0.8311984  1.7862137  1.0289624
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.08941046
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          0.064853485
X.3          0.060125497
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  0.403840024
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 0.304764871
             .          
             .          
             .          
             .          
             .          
             0.003753006
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.057331040
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.714953348
             0.934378462
[1] "beta_CATE: "
[1] 0.7149533 0.9343785
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0894104621880368; time_taken: 69.1148202419281"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.3016763 -0.1302890  0.7961233 -0.8318401  1.7872601  1.0307629
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.09031633
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1          .           
X.2          0.0640991122
X.3          0.0515756857
X.4          .           
X.5          .           
X.6          .           
X.7          .           
X.8          .           
X.9          .           
X.10         .           
X.1_spline1  .           
X.1_spline2  .           
X.1_spline3  .           
X.2_spline1  .           
X.2_spline2  .           
X.2_spline3  .           
X.3_spline1  .           
X.3_spline2  .           
X.3_spline3  .           
X.4_spline1  .           
X.4_spline2  .           
X.4_spline3  .           
X.5_spline1  .           
X.5_spline2  .           
X.5_spline3  .           
X.6_spline1  .           
X.6_spline2  .           
X.6_spline3  .           
X.7_spline1  .           
X.7_spline2  .           
X.7_spline3  .           
X.8_spline1  .           
X.8_spline2  .           
X.8_spline3  .           
X.9_spline1  .           
X.9_spline2  .           
X.9_spline3  0.3952897903
X.10_spline1 .           
X.10_spline2 .           
X.10_spline3 0.2907226643
V41          .           
V42          .           
V43          .           
V44          .           
V45          .           
V46          0.0005998501
V47          .           
V48          .           
V49          .           
V50          .           
V51          .           
V52          .           
V53          .           
V54          .           
V55          .           
V56          .           
V57          .           
V58          .           
V59          .           
V60          .           
V61          .           
V62          .           
V63          .           
V64          .           
V65          .           
V66          .           
V67          .           
V68          .           
V69          .           
V70          .           
V71          .           
V72          .           
V73          .           
V74          .           
V75          .           
V76          .           
V77          .           
V78          .           
V79          .           
V80          .           
V81          0.0540523553
V82          .           
V83          .           
V84          .           
V85          .           
V86          .           
V87          .           
V88          .           
V89          .           
V90          .           
V91          .           
V92          .           
V93          .           
V94          .           
V95          .           
train_data$W .           
X.1          0.7049513195
X.2          .           
X.3          0.0118622101
X.4          .           
X.5          .           
X.6          .           
X.7          .           
X.8          .           
X.9          0.0041078981
X.10         0.9260877515
[1] "beta_CATE: "
 [1] 0.000000000 0.704951319 0.000000000 0.011862210 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.004107898 0.926087751
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.090316332796896; time_taken: 71.3014054298401"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.2872925 -0.1332309  0.8255493 -0.8127685  1.8141611  1.0459688
[1] "head(CATE_true)"
[1] -2.7117920 -0.1658536  1.1300042 -1.1348547  2.2025838  1.3231198
[1] 0.09078479
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1          .          
X.2          0.064549465
X.3          0.042398870
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          .          
X.10         .          
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  0.390238874
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 0.307681537
             .          
             .          
             .          
             .          
             .          
             0.006840763
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             0.044370081
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
X.1          0.698593252
X.2          .          
X.3          0.019089067
X.4          .          
X.5          .          
X.6          .          
X.7          .          
X.8          .          
X.9          0.002919233
X.10         0.925682982
X.1_spline1  .          
X.1_spline2  .          
X.1_spline3  .          
X.2_spline1  .          
X.2_spline2  .          
X.2_spline3  .          
X.3_spline1  .          
X.3_spline2  .          
X.3_spline3  .          
X.4_spline1  .          
X.4_spline2  .          
X.4_spline3  .          
X.5_spline1  .          
X.5_spline2  .          
X.5_spline3  .          
X.6_spline1  .          
X.6_spline2  .          
X.6_spline3  .          
X.7_spline1  .          
X.7_spline2  .          
X.7_spline3  .          
X.8_spline1  .          
X.8_spline2  .          
X.8_spline3  .          
X.9_spline1  .          
X.9_spline2  .          
X.9_spline3  .          
X.10_spline1 .          
X.10_spline2 .          
X.10_spline3 .          
             0.015739371
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
             .          
[1] "beta_CATE: "
 [1] 0.000000000 0.698593252 0.000000000 0.019089067 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.002919233 0.925682982 0.000000000
[13] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[19] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[25] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[31] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[37] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.015739371
[43] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[49] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[55] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[61] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[67] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[73] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[79] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[85] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[91] 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000 0.000000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0907847929309099; time_taken: 102.823996305466"
Time to run lasso model: 469.005040407181 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.08813143

$`S_lasso_correctly-specified_linear-only`
[1] 0.03753908

$`S_lasso_linear_linear-only`
[1] 0.03876641

$`S_lasso_flexible_linear-only`
[1] 0.043497

$`T_lasso_mild-complex`
[1] 0.1181999

$`S_lasso_correctly-specified_mild-complex`
[1] 0.08941046

$`S_lasso_linear_mild-complex`
[1] 0.09031633

$`S_lasso_flexible_mild-complex`
[1] 0.09078479

Results for iteration 11 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_11-seed_244.csv
There were 50 or more warnings (use warnings() to see the first 50)
