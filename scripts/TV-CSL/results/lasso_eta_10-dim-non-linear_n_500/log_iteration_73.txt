Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 73
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 73: 926
Loaded dataset 73 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_73_n_500.rds 
Time to load dataset: 0.01786208152771 seconds
Loaded dataset 173 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_173_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.13876296
X.2   .         
X.3   0.10348410
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9  -0.07157601
X.10  .         
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.860109551
X.2   .          
X.3   .          
X.4  -0.007403537
X.5  -0.048084124
X.6  -0.249679389
X.7   0.496011592
X.8   .          
X.9   .          
X.10  0.887501932
[1] "head(CATE_est)"
              1
[1,] -1.2193955
[2,]  2.0852838
[3,] -1.7021420
[4,] -1.4650245
[5,]  0.8160428
[6,]  0.9619924
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] "config_name: T_lasso_linear-only. MSE: 0.162337248442629. time_taken: 29.4510443210602"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.9627558  1.8475878 -1.6757534 -1.3410877  0.8552392  0.8203236
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.1780752
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
                1
X.1   0.278367915
X.2   .          
X.3   0.005205836
X.4   .          
X.5  -0.062183301
X.6  -0.295524115
X.7   0.365312850
X.8   0.160598305
X.9  -0.269793846
X.10  .          
      0.572005820
      1.078877695
[1] "beta_CATE: "
[1] 0.5720058 1.0788777
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.178075228906211; time_taken: 15.6442039012909"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.9994192  1.8614087 -1.9803709 -1.3594096  0.8667727  0.6237284
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.2346696
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.281682971
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6          -0.120466844
X.7           .          
X.8           .          
X.9           .          
X.10          .          
train_data$W -0.033962996
X.1           0.476146884
X.2           .          
X.3           .          
X.4           .          
X.5          -0.032554365
X.6          -0.008850955
X.7           0.370317137
X.8           .          
X.9           .          
X.10          0.823026592
[1] "beta_CATE: "
 [1] -0.033962996  0.476146884  0.000000000  0.000000000  0.000000000
 [6] -0.032554365 -0.008850955  0.370317137  0.000000000  0.000000000
[11]  0.823026592
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.234669602512441; time_taken: 32.7376446723938"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.9764427  1.8602982 -1.9369709 -1.3012602  0.8933490  0.6449866
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.2247329
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.26451409
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6  -0.11316983
X.7   .         
X.8   .         
X.9   .         
X.10  .         
     -0.01415256
X.1   0.48012297
X.2   .         
X.3   .         
X.4   .         
X.5  -0.02150449
X.6   .         
X.7   0.34979226
X.8   .         
X.9   .         
X.10  0.81596029
[1] "beta_CATE: "
 [1] -0.01415256  0.48012297  0.00000000  0.00000000  0.00000000 -0.02150449
 [7]  0.00000000  0.34979226  0.00000000  0.00000000  0.81596029
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.224732871311622; time_taken: 31.8054225444794"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   .         
X.1_spline2   0.22217259
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.14270834
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.04449556
              .         
              .         
              .         
              0.03580020
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.703675167
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.261476679
X.8           .          
X.9           .          
X.10          0.569548982
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.013008147
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  1.314017196
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.009437224
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -1.3615375
[2,]  1.5807916
[3,] -1.9494933
[4,] -0.8419715
[5,]  0.6016597
[6,]  0.5730918
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] "config_name: T_lasso_mild-complex. MSE: 0.203905912170981. time_taken: 125.153608560562"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.9608388  1.4509241 -1.1734094 -0.8361408  0.7405374  0.7890133
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.2050192
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.148044146
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.433162564
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.159863060
X.7_spline3   0.543377199
X.8_spline1   .          
X.8_spline2  -0.325666874
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  .          
              .          
              .          
             -0.003020501
              .          
              .          
              .          
              .          
              .          
              .          
              0.030442539
             -0.007949753
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.055671264
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.597910264
              0.810390095
[1] "beta_CATE: "
[1] 0.5979103 0.8103901
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.205019179658205; time_taken: 68.8877077102661"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.9641621  1.5900042 -1.4973214 -0.9264882  0.8297652  0.6882461
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.2116718
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.162671708
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.306392011
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.055355654
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.209896178
X.10_spline3  .          
V41           .          
V42           .          
V43          -0.007240081
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           0.052883773
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           0.043437245
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  .          
X.1           0.530036281
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.243005670
X.8           .          
X.9           .          
X.10          0.700249105
[1] "beta_CATE: "
 [1] 0.0000000 0.5300363 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.2430057 0.0000000 0.0000000 0.7002491
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.211671811158004; time_taken: 69.1703917980194"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.9885778  1.5813784 -1.5432524 -1.0004789  0.7226544  0.5486026
[1] "head(CATE_true)"
[1] -1.5560240  1.8887700 -1.3150006 -0.7649789  1.0667255  1.2429551
[1] 0.2578583
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.201956676
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.167732232
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2  -0.080710284
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.046128709
X.10_spline3  .          
              .          
              .          
             -0.004296087
              .          
              .          
              .          
              .          
              .          
              .          
              0.035587765
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.035539524
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
X.1           0.480640275
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.243247693
X.8           .          
X.9           .          
X.10          0.663403657
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.339605483
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "beta_CATE: "
 [1] 0.0000000 0.4806403 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.2432477 0.0000000 0.0000000 0.6634037 0.0000000 0.0000000 0.0000000
[15] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[22] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[29] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[36] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.3396055 0.0000000
[43] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[50] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[57] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[64] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[71] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[78] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[85] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[92] 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.257858257370398; time_taken: 108.397870540619"
Time to run lasso model: 483.027701616287 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1623372

$`S_lasso_correctly-specified_linear-only`
[1] 0.1780752

$`S_lasso_linear_linear-only`
[1] 0.2346696

$`S_lasso_flexible_linear-only`
[1] 0.2247329

$`T_lasso_mild-complex`
[1] 0.2039059

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2050192

$`S_lasso_linear_mild-complex`
[1] 0.2116718

$`S_lasso_flexible_mild-complex`
[1] 0.2578583

Results for iteration 73 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_73-seed_926.csv
There were 50 or more warnings (use warnings() to see the first 50)
