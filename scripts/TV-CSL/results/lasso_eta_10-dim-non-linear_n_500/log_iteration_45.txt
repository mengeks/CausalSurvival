Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 45
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 45: 618
Loaded dataset 45 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_45_n_500.rds 
Time to load dataset: 0.0044398307800293 seconds
Loaded dataset 145 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_145_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.91180687
X.2  -0.22623643
X.3   0.05272241
X.4   0.06835274
X.5   .         
X.6  -0.13378567
X.7   0.55323451
X.8  -0.41219931
X.9   .         
X.10  0.92330043
[1] "head(CATE_est)"
               1
[1,] -2.51874019
[2,] -0.06214981
[3,] -1.07856225
[4,]  1.37746296
[5,] -2.13783490
[6,]  1.36298607
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] "config_name: T_lasso_linear-only. MSE: 0.0783874367075802. time_taken: 29.3658604621887"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.6072752 -0.1682523 -0.8288618  1.8658256 -2.7064622  1.0935329
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.07885188
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.20077829
X.2  -0.22496329
X.3   0.13511994
X.4   0.22780864
X.5  -0.15359334
X.6  -0.23853903
X.7   0.51534130
X.8  -0.35431675
X.9   0.06433655
X.10 -0.13365531
      0.71038928
      1.07830531
[1] "beta_CATE: "
[1] 0.7103893 1.0783053
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.0788518799450742; time_taken: 16.1316468715668"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.26198214 -0.09204623 -0.88182366  1.28463166 -2.12718396  1.29137293
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.1381109
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.14534128
X.2           .         
X.3           0.06605611
X.4           0.10463659
X.5          -0.02802371
X.6          -0.17224635
X.7           .         
X.8           .         
X.9           .         
X.10          .         
train_data$W  .         
X.1           0.72855549
X.2          -0.16096303
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           0.53300611
X.8          -0.34980063
X.9           .         
X.10          0.92232395
[1] "beta_CATE: "
 [1]  0.0000000  0.7285555 -0.1609630  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.5330061 -0.3498006  0.0000000  0.9223240
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.138110856641626; time_taken: 22.3062090873718"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -2.26198214 -0.09204623 -0.88182366  1.28463166 -2.12718396  1.29137293
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.1381109
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.14534128
X.2   .         
X.3   0.06605611
X.4   0.10463659
X.5  -0.02802371
X.6  -0.17224635
X.7   .         
X.8   .         
X.9   .         
X.10  .         
      .         
X.1   0.72855549
X.2  -0.16096303
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   0.53300611
X.8  -0.34980063
X.9   .         
X.10  0.92232395
[1] "beta_CATE: "
 [1]  0.0000000  0.7285555 -0.1609630  0.0000000  0.0000000  0.0000000
 [7]  0.0000000  0.5330061 -0.3498006  0.0000000  0.9223240
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.138110856641626; time_taken: 21.3366451263428"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.575415075
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.110211182
X.8           .          
X.9           .          
X.10          0.630385104
X.1_spline1   0.314138380
X.1_spline2  -0.022036115
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   0.355350092
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   0.096053842
X.8_spline1  -0.318555286
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1  -0.056131812
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.951598161
              .          
              .          
              .          
              0.027117422
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.002804381
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -2.4413210
[2,] -0.4749475
[3,] -1.1735427
[4,]  1.2477782
[5,] -1.9528888
[6,]  0.8352975
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] "config_name: T_lasso_mild-complex. MSE: 0.233210980708124. time_taken: 138.158480644226"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -2.0000753 -0.1174389 -0.6459565  1.4084435 -2.0203184  0.8340298
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.2461266
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.12350029
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   0.10087515
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   .         
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   0.24317693
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   0.09613036
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   0.32309242
X.8_spline1  -0.03342072
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1  -0.01656997
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1  .         
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
              .         
              .         
              0.00120671
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              0.06435874
              0.55067091
              0.79836656
[1] "beta_CATE: "
[1] 0.5506709 0.7983666
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.246126610653702; time_taken: 66.2343249320984"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -2.60127727 -0.05509117 -0.90826699  1.66306070 -2.34574202  1.09414294
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.09085066
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.143306710
X.2           .          
X.3           .          
X.4           0.015495083
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   0.212406708
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   0.745623936
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   0.329304845
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1  -0.276940328
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2  -0.938531584
X.7_spline3   .          
X.8_spline1  -0.319577996
X.8_spline2   0.763542088
X.8_spline3   .          
X.9_spline1  -0.196548999
X.9_spline2   .          
X.9_spline3   0.421628693
X.10_spline1 -0.135924978
X.10_spline2  .          
X.10_spline3  .          
V41           .          
V42          -0.018072059
V43           .          
V44           .          
V45           .          
V46           .          
V47           .          
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58          -0.122176936
V59           .          
V60           .          
V61           .          
V62           0.056558821
V63           0.003450496
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           .          
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           0.033385004
train_data$W  .          
X.1           0.653274022
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           0.144280937
X.8           .          
X.9           .          
X.10          0.892957926
[1] "beta_CATE: "
 [1] 0.0000000 0.6532740 0.0000000 0.0000000 0.0000000 0.0000000 0.0000000
 [8] 0.1442809 0.0000000 0.0000000 0.8929579
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0908506569083597; time_taken: 69.2076301574707"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.76705919  0.01128878 -0.53675576  1.71596726 -1.99561130  1.35482642
[1] "head(CATE_true)"
[1] -3.38017894 -0.05751842 -1.21441095  2.10327989 -2.73752767  1.35094534
[1] 0.1807917
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0919342735
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   0.1110451122
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1  -0.1067395743
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1  -0.1741906208
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
             -0.0008876766
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0501663494
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0495365875
              .           
X.1           0.5540610347
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           0.1369284464
X.8           .           
X.9           .           
X.10          0.8265199672
X.1_spline1   0.3707649646
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1  -0.1367955868
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              0.1072954325
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0214881794
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0197754779
[1] "beta_CATE: "
 [1]  0.00000000  0.55406103  0.00000000  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.13692845  0.00000000  0.00000000  0.82651997  0.37076496
[13]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000 -0.13679559  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.10729543  0.00000000  0.00000000  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.02148818  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.01977548
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.180791743127251; time_taken: 114.014206171036"
Time to run lasso model: 478.716557979584 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.07838744

$`S_lasso_correctly-specified_linear-only`
[1] 0.07885188

$`S_lasso_linear_linear-only`
[1] 0.1381109

$`S_lasso_flexible_linear-only`
[1] 0.1381109

$`T_lasso_mild-complex`
[1] 0.233211

$`S_lasso_correctly-specified_mild-complex`
[1] 0.2461266

$`S_lasso_linear_mild-complex`
[1] 0.09085066

$`S_lasso_flexible_mild-complex`
[1] 0.1807917

Results for iteration 45 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_45-seed_618.csv
There were 50 or more warnings (use warnings() to see the first 50)
