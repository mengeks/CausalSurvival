Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 36
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 36: 519
Loaded dataset 36 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_36_n_500.rds 
Time to load dataset: 0.00374698638916016 seconds
Loaded dataset 136 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_136_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
              1
X.1  0.74402184
X.2  .         
X.3  0.03022136
X.4  .         
X.5  .         
X.6  0.06934487
X.7  .         
X.8  .         
X.9  .         
X.10 0.90066630
[1] "head(CATE_est)"
               1
[1,]  0.07283836
[2,] -0.27348441
[3,]  0.91321887
[4,]  1.13527966
[5,] -1.26207619
[6,]  0.96860921
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] "config_name: T_lasso_linear-only. MSE: 0.0499509524587517. time_taken: 29.966450214386"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.02372450  0.09736308  1.03431134  0.94915393 -1.26058734  0.59111666
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.2512591
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1  0.2462877
X.2  .        
X.3  0.0259757
X.4  .        
X.5  .        
X.6  .        
X.7  .        
X.8  .        
X.9  .        
X.10 .        
     0.5181515
     0.9160920
[1] "beta_CATE: "
[1] 0.5181515 0.9160920
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.251259052812411; time_taken: 15.506915807724"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.02929759  0.21832119  1.19941352  1.13856164 -1.14122003  0.83029748
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.2120747
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.23172941
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9          -0.06259503
X.10          .         
train_data$W  0.12593861
X.1           0.51616826
X.2           .         
X.3           0.03524484
X.4           .         
X.5           .         
X.6           0.08081357
X.7           .         
X.8           .         
X.9           .         
X.10          0.94414962
[1] "beta_CATE: "
 [1] 0.12593861 0.51616826 0.00000000 0.03524484 0.00000000 0.00000000
 [7] 0.08081357 0.00000000 0.00000000 0.00000000 0.94414962
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.212074724875042; time_taken: 28.3676793575287"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.03572531  0.25407396  1.25008871  1.18006559 -1.15331618  0.86070014
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.211958
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.23250143
X.2   .         
X.3   .         
X.4   .         
X.5   .         
X.6   .         
X.7   .         
X.8   .         
X.9  -0.08731547
X.10  .         
      0.14496578
X.1   0.52081318
X.2   .         
X.3   0.03567906
X.4   .         
X.5   .         
X.6   0.08759417
X.7   .         
X.8   .         
X.9   .         
X.10  0.96905894
[1] "beta_CATE: "
 [1] 0.14496578 0.52081318 0.00000000 0.03567906 0.00000000 0.00000000
 [7] 0.08759417 0.00000000 0.00000000 0.00000000 0.96905894
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.211958038885064; time_taken: 27.5686662197113"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
             1
X.1          .
X.2          .
X.3          .
X.4          .
X.5          .
X.6          .
X.7          .
X.8          .
X.9          .
X.10         .
X.1_spline1  .
X.1_spline2  .
X.1_spline3  .
X.2_spline1  .
X.2_spline2  .
X.2_spline3  .
X.3_spline1  .
X.3_spline2  .
X.3_spline3  .
X.4_spline1  .
X.4_spline2  .
X.4_spline3  .
X.5_spline1  .
X.5_spline2  .
X.5_spline3  .
X.6_spline1  .
X.6_spline2  .
X.6_spline3  .
X.7_spline1  .
X.7_spline2  .
X.7_spline3  .
X.8_spline1  .
X.8_spline2  .
X.8_spline3  .
X.9_spline1  .
X.9_spline2  .
X.9_spline3  .
X.10_spline1 .
X.10_spline2 .
X.10_spline3 .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
             .
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.897977125
X.2           .          
X.3           0.035696787
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.761516821
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   0.321097978
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  0.099513502
X.10_spline2 -0.124843605
X.10_spline3  1.125093408
             -0.178131137
              .          
              .          
              .          
              .          
              .          
              0.055060744
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.081239144
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
             -0.021181656
              .          
              .          
              .          
              .          
              .          
              .          
             -0.089498767
              .          
              0.048645225
              .          
              .          
              0.003054088
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
[1] "head(CATE_est)"
              1
[1,] -0.1736701
[2,] -0.9303765
[3,]  0.6464804
[4,]  1.0017263
[5,] -1.3931905
[6,]  0.8530858
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] "config_name: T_lasso_mild-complex. MSE: 0.194240309539791. time_taken: 142.723259687424"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1]  0.1145169 -0.2209222  0.9040915  1.0675185 -1.2621564  0.8372526
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.09798348
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.139718408
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          .          
X.1_spline1   .          
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   0.155265513
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.423373925
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   0.116183373
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.238300399
X.10_spline3  0.009723507
             -0.135850545
              .          
              .          
              .          
              0.034580670
              .          
              0.021685113
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.718110638
              0.885521476
[1] "beta_CATE: "
[1] 0.7181106 0.8855215
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.0979834784775378; time_taken: 64.5930333137512"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1]  0.4121274 -0.2483342  1.0537301  1.3918461 -1.1172990  1.2387408
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.06422346
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.046445982
X.2           .          
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9          -0.009124632
X.10          .          
X.1_spline1   .          
X.1_spline2   0.038582151
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1   .          
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2  -0.039739528
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2  -0.398437061
X.5_spline3   .          
X.6_spline1   0.056158452
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   .          
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2 -0.412500712
X.10_spline3  0.083500737
V41          -0.183253907
V42           .          
V43           .          
V44           .          
V45           0.035647275
V46           .          
V47           0.034970552
V48           .          
V49           .          
V50           .          
V51           .          
V52           .          
V53           .          
V54           .          
V55           .          
V56           .          
V57           .          
V58           .          
V59           .          
V60           .          
V61           .          
V62           .          
V63           .          
V64           .          
V65           .          
V66           .          
V67           .          
V68           .          
V69           .          
V70           .          
V71           .          
V72           .          
V73           .          
V74           .          
V75           0.012194885
V76           .          
V77           .          
V78           .          
V79           .          
V80           .          
V81           .          
V82           .          
V83           .          
V84           .          
V85           .          
V86           .          
V87           .          
V88           .          
V89           .          
V90           .          
V91           .          
V92           .          
V93           .          
V94           .          
V95           .          
train_data$W  0.199154372
X.1           0.882268642
X.2           0.002893727
X.3           .          
X.4           .          
X.5           .          
X.6           .          
X.7           .          
X.8           .          
X.9           .          
X.10          0.902339925
[1] "beta_CATE: "
 [1] 0.199154372 0.882268642 0.002893727 0.000000000 0.000000000 0.000000000
 [7] 0.000000000 0.000000000 0.000000000 0.000000000 0.902339925
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.0642234601011312; time_taken: 76.0646414756775"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1]  0.3942019 -0.1381914  0.9866882  1.4268928 -0.9935933  1.3631875
[1] "head(CATE_true)"
[1]  0.2489317 -0.5236305  0.9376878  1.3360902 -1.4632978  1.1768468
[1] 0.08315299
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0256500771
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2  -0.0181066390
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2 -0.2243888961
X.10_spline3  .           
             -0.1551935514
              .           
              .           
              .           
              0.0638665617
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0009690612
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.8280944739
X.2           0.0109285902
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          0.8206785367
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   0.0766613804
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   0.3854622156
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  0.1285988945
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0700026055
              .           
              .           
              0.0425233145
              .           
              .           
              .           
              .           
              .           
              0.0294158910
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0635821734
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
[1] "beta_CATE: "
 [1]  0.00000000  0.82809447  0.01092859  0.00000000  0.00000000  0.00000000
 [7]  0.00000000  0.00000000  0.00000000  0.00000000  0.82067854  0.00000000
[13]  0.00000000  0.00000000  0.07666138  0.00000000  0.00000000  0.00000000
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.38546222  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[37]  0.00000000  0.00000000  0.12859889  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.07000261
[49]  0.00000000  0.00000000  0.04252331  0.00000000  0.00000000  0.00000000
[55]  0.00000000  0.00000000  0.02941589  0.00000000  0.00000000  0.00000000
[61]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000 -0.06358217  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.0831529922456924; time_taken: 122.810340642929"
Time to run lasso model: 509.564739942551 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.04995095

$`S_lasso_correctly-specified_linear-only`
[1] 0.2512591

$`S_lasso_linear_linear-only`
[1] 0.2120747

$`S_lasso_flexible_linear-only`
[1] 0.211958

$`T_lasso_mild-complex`
[1] 0.1942403

$`S_lasso_correctly-specified_mild-complex`
[1] 0.09798348

$`S_lasso_linear_mild-complex`
[1] 0.06422346

$`S_lasso_flexible_mild-complex`
[1] 0.08315299

Results for iteration 36 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_36-seed_519.csv
There were 50 or more warnings (use warnings() to see the first 50)
