Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loaded glmnet 4.1-8
Running iteration 13
Configuration Parameters:
n: 500
R: 100
eta_type: 10-dim-non-linear
CATE_type: linear
Seed value for iteration 13: 266
Loaded dataset 13 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_13_n_500.rds 
Time to load dataset: 0.00605440139770508 seconds
Loaded dataset 113 from /n/holylabs/LABS/pillai_lab/Users/xmeng1/CausalSurvival/data//10-dim-non-linear_linear/sim_data_113_n_500.rds 
[1] "eta_0 coefficient: "
10 x 1 sparse Matrix of class "dgCMatrix"
     1
X.1  .
X.2  .
X.3  .
X.4  .
X.5  .
X.6  .
X.7  .
X.8  .
X.9  .
X.10 .
[1] "eta_1 coefficient "
10 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.91468143
X.2  -0.16077930
X.3   .         
X.4   0.01648147
X.5  -0.23434837
X.6  -0.01087900
X.7   .         
X.8   0.16530194
X.9   .         
X.10  1.09169348
[1] "head(CATE_est)"
              1
[1,] -0.7256321
[2,]  1.8457291
[3,]  2.3052399
[4,]  0.5301667
[5,]  0.8864380
[6,]  0.6402057
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] "config_name: T_lasso_linear-only. MSE: 0.12026614687063. time_taken: 30.8265914916992"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -0.9223044  1.6747025  2.0165683  0.7304879  1.0736145  0.5206272
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.2550283
[1] "m_beta: "
12 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.31169103
X.2  -0.06223440
X.3   .         
X.4   .         
X.5  -0.11975718
X.6  -0.01335142
X.7   .         
X.8   0.02632677
X.9   .         
X.10  .         
      0.49512934
      1.12534559
[1] "beta_CATE: "
[1] 0.4951293 1.1253456
[1] "config_name: S_lasso_correctly-specified_linear-only; MSE: 0.25502827677263; time_taken: 16.6685101985931"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.7223728  1.2497498  1.7338658  0.4885018  0.9155266  0.2823134
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.4765241
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           0.31975173
X.2           .         
X.3           0.04438201
X.4           .         
X.5           .         
X.6           .         
X.7          -0.04956204
X.8           .         
X.9           .         
X.10         -0.03878943
train_data$W -0.22430780
X.1           0.71039548
X.2          -0.31095462
X.3           .         
X.4           0.13413807
X.5          -0.34074432
X.6          -0.01525503
X.7           .         
X.8           0.22603649
X.9           0.01098528
X.10          1.17305528
[1] "beta_CATE: "
 [1] -0.22430780  0.71039548 -0.31095462  0.00000000  0.13413807 -0.34074432
 [7] -0.01525503  0.00000000  0.22603649  0.01098528  1.17305528
[1] "config_name: S_lasso_linear_linear-only; MSE: 0.47652412208542; time_taken: 26.3660879135132"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -0.7278517  1.2200880  1.7026075  0.4569911  0.9088511  0.2221661
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.5240984
[1] "m_beta: "
21 x 1 sparse Matrix of class "dgCMatrix"
               1
X.1   0.31779268
X.2   .         
X.3   0.07223440
X.4   .         
X.5   .         
X.6   .         
X.7  -0.04568252
X.8   .         
X.9   .         
X.10 -0.06209249
     -0.25734337
X.1   0.74066079
X.2  -0.35545718
X.3   .         
X.4   0.15616266
X.5  -0.36767234
X.6  -0.01752143
X.7  -0.01995241
X.8   0.23968748
X.9   0.02243511
X.10  1.20084727
[1] "beta_CATE: "
 [1] -0.25734337  0.74066079 -0.35545718  0.00000000  0.15616266 -0.36767234
 [7] -0.01752143 -0.01995241  0.23968748  0.02243511  1.20084727
[1] "config_name: S_lasso_flexible_linear-only; MSE: 0.524098378623198; time_taken: 25.9831001758575"
[1] "eta_0 coefficient: "
95 x 1 sparse Matrix of class "dgCMatrix"
                       1
X.1           .         
X.2           .         
X.3           .         
X.4           .         
X.5           .         
X.6           .         
X.7           .         
X.8           .         
X.9           .         
X.10          .         
X.1_spline1   0.07047429
X.1_spline2   .         
X.1_spline3   .         
X.2_spline1   .         
X.2_spline2   .         
X.2_spline3   .         
X.3_spline1   .         
X.3_spline2   0.26992376
X.3_spline3   .         
X.4_spline1   .         
X.4_spline2   .         
X.4_spline3   .         
X.5_spline1   .         
X.5_spline2   .         
X.5_spline3   .         
X.6_spline1   .         
X.6_spline2   .         
X.6_spline3   .         
X.7_spline1   .         
X.7_spline2   .         
X.7_spline3   .         
X.8_spline1   .         
X.8_spline2   .         
X.8_spline3   .         
X.9_spline1   .         
X.9_spline2   .         
X.9_spline3   .         
X.10_spline1 -0.37507824
X.10_spline2  .         
X.10_spline3  .         
              .         
              .         
             -0.02551827
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
             -0.07550417
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
              .         
[1] "eta_1 coefficient "
95 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           0.538195329
X.2           .          
X.3           .          
X.4           .          
X.5          -0.055889359
X.6           .          
X.7           .          
X.8           0.151825658
X.9           .          
X.10          0.926113820
X.1_spline1   0.676138251
X.1_spline2  -0.883174432
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1  -0.226668735
X.3_spline2   .          
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3   .          
X.7_spline1   0.008818912
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   .          
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1  .          
X.10_spline2  .          
X.10_spline3  0.209430224
              .          
              .          
              .          
              .          
              .          
             -0.062357927
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.045465541
              .          
              .          
              .          
             -0.114220393
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.060785572
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.063233328
              .          
              .          
[1] "head(CATE_est)"
               1
[1,] -1.42947408
[2,]  1.93119214
[3,]  1.92458968
[4,]  0.09884429
[5,]  0.62923764
[6,]  0.34953410
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] "config_name: T_lasso_mild-complex. MSE: 0.277563283047793. time_taken: 129.903660535812"
[1] "CATE_spec: correctly-specified"
[1] "head(CATE_est)"
[1] -1.0524540  1.9893441  2.3203249  0.6410574  1.0111177  0.5941812
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.1089391
[1] "m_beta: "
97 x 1 sparse Matrix of class "dgCMatrix"
                        1
X.1           .          
X.2           .          
X.3           .          
X.4           .          
X.5          -0.006697042
X.6           .          
X.7           .          
X.8           0.020905178
X.9           .          
X.10          .          
X.1_spline1   0.691411951
X.1_spline2   .          
X.1_spline3   .          
X.2_spline1   .          
X.2_spline2   .          
X.2_spline3   .          
X.3_spline1  -0.288698859
X.3_spline2   0.237804502
X.3_spline3   .          
X.4_spline1   .          
X.4_spline2   .          
X.4_spline3   .          
X.5_spline1   .          
X.5_spline2   .          
X.5_spline3   .          
X.6_spline1   .          
X.6_spline2   .          
X.6_spline3  -0.391372275
X.7_spline1   0.037158384
X.7_spline2   .          
X.7_spline3   .          
X.8_spline1   .          
X.8_spline2   .          
X.8_spline3   0.251206418
X.9_spline1   .          
X.9_spline2   .          
X.9_spline3   .          
X.10_spline1 -0.313906766
X.10_spline2  .          
X.10_spline3  .          
              .          
             -0.032871574
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.015169170
              .          
              .          
              .          
             -0.036529228
              .          
              .          
              .          
              .          
              .          
              .          
             -0.082578994
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.093362610
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              .          
              0.003224305
              .          
              0.690766353
              1.151215367
[1] "beta_CATE: "
[1] 0.6907664 1.1512154
[1] "config_name: S_lasso_correctly-specified_mild-complex; MSE: 0.108939114944101; time_taken: 55.8272004127502"
[1] "CATE_spec: linear"
[1] "head(CATE_est)"
[1] -0.8003961  1.8547886  2.3150140  0.7293067  1.1225955  0.6765068
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.143296
[1] "m_beta: "
106 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           .           
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   7.150077e-01
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1  -2.336806e-01
X.3_spline2   1.904738e-01
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3  -2.425314e-01
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1 -2.598319e-01
X.10_spline2  .           
X.10_spline3  .           
V41           .           
V42          -2.165707e-02
V43           .           
V44           .           
V45           .           
V46           .           
V47           .           
V48           .           
V49           .           
V50           .           
V51           .           
V52           .           
V53           .           
V54           .           
V55           .           
V56           .           
V57           .           
V58           .           
V59           2.481318e-02
V60           .           
V61           .           
V62           .           
V63          -5.397827e-02
V64           .           
V65           .           
V66           .           
V67           .           
V68           .           
V69           .           
V70          -5.921603e-02
V71           .           
V72           .           
V73           .           
V74           .           
V75           .           
V76           .           
V77           .           
V78           6.491204e-02
V79           .           
V80           .           
V81           .           
V82           .           
V83           .           
V84           .           
V85           .           
V86           .           
V87           .           
V88           .           
V89           .           
V90           .           
V91           .           
V92           .           
V93           .           
V94           1.652804e-02
V95           .           
train_data$W -7.117296e-06
X.1           6.653788e-01
X.2           .           
X.3           .           
X.4           .           
X.5          -9.696830e-02
X.6           .           
X.7           .           
X.8           1.988143e-01
X.9           .           
X.10          1.065384e+00
[1] "beta_CATE: "
 [1] -7.117296e-06  6.653788e-01  0.000000e+00  0.000000e+00  0.000000e+00
 [6] -9.696830e-02  0.000000e+00  0.000000e+00  1.988143e-01  0.000000e+00
[11]  1.065384e+00
[1] "config_name: S_lasso_linear_mild-complex; MSE: 0.143296025728864; time_taken: 63.4397792816162"
[1] "CATE_spec: flexible"
[1] "head(CATE_est)"
[1] -1.0091181  1.6750974  2.0128342  0.5267536  1.0724741  0.4257315
[1] "head(CATE_true)"
[1] -1.1507067  2.3274706  2.5742882  0.3262708  0.6890658  0.6498197
[1] 0.2525091
[1] "m_beta: "
191 x 1 sparse Matrix of class "dgCMatrix"
                         1
X.1           0.0343882242
X.2           .           
X.3           .           
X.4           .           
X.5           .           
X.6           .           
X.7           .           
X.8           .           
X.9           .           
X.10          .           
X.1_spline1   0.8561805281
X.1_spline2   .           
X.1_spline3   .           
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1   .           
X.3_spline2   0.3114794777
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   .           
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1 -0.2239397129
X.10_spline2  .           
X.10_spline3  .           
              .           
             -0.0251258585
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0003037394
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0122904414
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
X.1           0.5141942047
X.2           .           
X.3           .           
X.4           .           
X.5          -0.0800882266
X.6           .           
X.7           .           
X.8           0.1519309531
X.9           .           
X.10          1.0522689131
X.1_spline1   .           
X.1_spline2   .           
X.1_spline3   0.4236867288
X.2_spline1   .           
X.2_spline2   .           
X.2_spline3   .           
X.3_spline1  -0.1057871548
X.3_spline2   .           
X.3_spline3   .           
X.4_spline1   .           
X.4_spline2   .           
X.4_spline3   .           
X.5_spline1   .           
X.5_spline2   .           
X.5_spline3   .           
X.6_spline1   .           
X.6_spline2   .           
X.6_spline3   .           
X.7_spline1   .           
X.7_spline2   .           
X.7_spline3   .           
X.8_spline1   .           
X.8_spline2   .           
X.8_spline3   0.0995731425
X.9_spline1   .           
X.9_spline2   .           
X.9_spline3   .           
X.10_spline1  .           
X.10_spline2  .           
X.10_spline3  .           
              .           
              .           
              .           
              .           
              .           
             -0.0772194991
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
             -0.0239423469
              .           
              .           
              .           
              0.0329737975
              .           
              .           
              .           
             -0.0749781861
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0938573654
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              .           
              0.0366510444
              .           
              .           
[1] "beta_CATE: "
 [1]  0.00000000  0.51419420  0.00000000  0.00000000  0.00000000 -0.08008823
 [7]  0.00000000  0.00000000  0.15193095  0.00000000  1.05226891  0.00000000
[13]  0.00000000  0.42368673  0.00000000  0.00000000  0.00000000 -0.10578715
[19]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[25]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[31]  0.00000000  0.00000000  0.00000000  0.00000000  0.09957314  0.00000000
[37]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[43]  0.00000000  0.00000000  0.00000000  0.00000000 -0.07721950  0.00000000
[49]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[55]  0.00000000 -0.02394235  0.00000000  0.00000000  0.00000000  0.03297380
[61]  0.00000000  0.00000000  0.00000000 -0.07497819  0.00000000  0.00000000
[67]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[73]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[79]  0.09385737  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[85]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
[91]  0.00000000  0.00000000  0.00000000  0.03665104  0.00000000  0.00000000
[1] "config_name: S_lasso_flexible_mild-complex; MSE: 0.252509146677444; time_taken: 106.255834102631"
Time to run lasso model: 457.219620466232 seconds
Lasso Results:
$`T_lasso_linear-only`
[1] 0.1202661

$`S_lasso_correctly-specified_linear-only`
[1] 0.2550283

$`S_lasso_linear_linear-only`
[1] 0.4765241

$`S_lasso_flexible_linear-only`
[1] 0.5240984

$`T_lasso_mild-complex`
[1] 0.2775633

$`S_lasso_correctly-specified_mild-complex`
[1] 0.1089391

$`S_lasso_linear_mild-complex`
[1] 0.143296

$`S_lasso_flexible_mild-complex`
[1] 0.2525091

Results for iteration 13 saved to scripts/TV-CSL/results/10-dim-non-linear_linear-n_500-iteration_13-seed_266.csv
There were 50 or more warnings (use warnings() to see the first 50)
